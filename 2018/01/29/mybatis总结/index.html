<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Java,mybatis," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="一、mybatis简介MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。     MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注 SQL 本身，而不需要花费精力去处理例">
<meta name="keywords" content="Java,mybatis">
<meta property="og:type" content="article">
<meta property="og:title" content="mybatis总结">
<meta property="og:url" content="http://yoursite.com/2018/01/29/mybatis总结/index.html">
<meta property="og:site_name" content="小黄">
<meta property="og:description" content="一、mybatis简介MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。     MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注 SQL 本身，而不需要花费精力去处理例">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/img/mybatis-1.jpg">
<meta property="og:image" content="http://yoursite.com/img/mybatis-2.jpg">
<meta property="og:image" content="http://yoursite.com/img/mybatis-3.jpg">
<meta property="og:image" content="http://yoursite.com/img/mybatis-4.jpg">
<meta property="og:image" content="http://yoursite.com/img/mybatis-5.jpg">
<meta property="og:image" content="http://yoursite.com/img/mybatis-6.jpg">
<meta property="og:updated_time" content="2018-01-29T12:23:35.019Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mybatis总结">
<meta name="twitter:description" content="一、mybatis简介MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。     MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注 SQL 本身，而不需要花费精力去处理例">
<meta name="twitter:image" content="http://yoursite.com/img/mybatis-1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/01/29/mybatis总结/"/>





  <title>mybatis总结 | 小黄</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小黄</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">黄小黄的幸福生活！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-java">
          <a href="/Java/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Java
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/29/mybatis总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">mybatis总结</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-29T10:48:09+08:00">
                2018-01-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="一、mybatis简介"><a href="#一、mybatis简介" class="headerlink" title="一、mybatis简介"></a>一、mybatis简介</h1><p>MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。     MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注 SQL 本身，而不需要花费精力去处理例如注册驱动、创建connection、创建statement、手动设置参数、结果集检索等jdbc繁杂的过程代码。<br>Mybatis通过xml或注解的方式将要执行的各种statement（statement、preparedStatement、CallableStatement）配置起来，并通过java对象和statement中的sql进行映射生成最终执行的sql语句，最后由mybatis框架执行sql并将结果映射成java对象并返回。</p>
<h1 id="二、mybatis入门"><a href="#二、mybatis入门" class="headerlink" title="二、mybatis入门"></a>二、mybatis入门</h1><h2 id="1、使用jdbc操作数据库存在的问题"><a href="#1、使用jdbc操作数据库存在的问题" class="headerlink" title="1、使用jdbc操作数据库存在的问题"></a>1、使用jdbc操作数据库存在的问题</h2><ul>
<li><p>JDBC编程步骤：</p>
<ol>
<li><p>加载数据库驱动</p>
</li>
<li><p>创建并获取数据库连接</p>
</li>
<li><p>创建jdbc statement对象</p>
</li>
<li><p>设置SQL语句</p>
</li>
<li><p>传递SQL语句参数</p>
</li>
<li><p>执行statement获取结果</p>
</li>
<li><p>解析SQL执行结果</p>
</li>
<li><p>释放资源</p>
</li>
</ol>
</li>
<li><p>jdbc程序</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.jdbc;</div><div class="line"></div><div class="line">import java.sql.*;</div><div class="line"></div><div class="line">public class JDBCTest &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        Connection connection = null;</div><div class="line">        PreparedStatement preparedStatement = null;</div><div class="line">        ResultSet resultSet = null;</div><div class="line"></div><div class="line">        try &#123;</div><div class="line">            //加载数据库驱动</div><div class="line">            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</div><div class="line"></div><div class="line">            //通过驱动管理类获取数据库链接</div><div class="line">            connection =  DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8&quot;, &quot;root&quot;, &quot;linux&quot;);</div><div class="line">            //定义sql语句 ?表示占位符</div><div class="line">            String sql = &quot;select * from user where username = ?&quot;;</div><div class="line">            //获取预处理statement</div><div class="line">            preparedStatement = connection.prepareStatement(sql);</div><div class="line">            //设置参数，第一个参数为sql语句中参数的序号（从1开始），第二个参数为设置的参数值</div><div class="line">            preparedStatement.setString(1, &quot;王五&quot;);</div><div class="line">            //向数据库发出sql执行查询，查询出结果集</div><div class="line">            resultSet =  preparedStatement.executeQuery();</div><div class="line">            //遍历查询结果集</div><div class="line">            while(resultSet.next())&#123;</div><div class="line">                System.out.println(resultSet.getString(&quot;id&quot;)+&quot;  &quot;+resultSet.getString(&quot;username&quot;));</div><div class="line">            &#125;</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;finally&#123;</div><div class="line">            //释放资源</div><div class="line">            if(resultSet!=null)&#123;</div><div class="line">                try &#123;</div><div class="line">                    resultSet.close();</div><div class="line">                &#125; catch (SQLException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            if(preparedStatement!=null)&#123;</div><div class="line">                try &#123;</div><div class="line">                    preparedStatement.close();</div><div class="line">                &#125; catch (SQLException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            if(connection!=null)&#123;</div><div class="line">                try &#123;</div><div class="line">                    connection.close();</div><div class="line">                &#125; catch (SQLException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>jdbc存在的问题</p>
<ol>
<li><p>数据库连接创建，释放频繁造成系统资源浪费从而影响系统性能，可以使用数据库连接池技术来解决这个问题。</p>
</li>
<li><p>SQL语句在代码中硬编码，不便于维护，实际应用中修改SQL语句需要修改java代码，不便于修改。</p>
</li>
<li><p>使用preparedStatement语句向占位符传参存在硬编码，实际上SQL语句的where条件不固定，修改困难</p>
</li>
<li><p>对结果集存在硬编码（查询列名），SQL变化导致解析代码变化，系统不易维护，将数据库记录封装成pojo对象解析比较方便。</p>
</li>
</ol>
</li>
</ul>
<h2 id="2、mybatis架构"><a href="#2、mybatis架构" class="headerlink" title="2、mybatis架构"></a>2、mybatis架构</h2><p><img src="/img/mybatis-1.jpg" alt="Alt text"></p>
<ol>
<li><p>mybatis配置</p>
<ul>
<li>SqlMapConfig.xml为mybatis的全局配置文件，配置了mybatis的运行环境等信息。</li>
<li>mapper.xml为SQL映射文件，文件中配置了操作数据库的SQL语句，需要加载在SQLMapConfig.xml文件中。</li>
</ul>
</li>
<li><p>通过mybatis环境等配置信息构造SqlSessioNFactory，也就是会话工厂。</p>
</li>
<li><p>由会话工厂创建SqlSession，操作数据库需要通过会话来实现。</p>
</li>
<li><p>mybatis低层自定义了Executor执行器操作数据库，Execotor接口有两个实现，一个是基本执行器，一个是缓存执行器。</p>
</li>
<li><p>MappedStatement也是mybatis的一个低层封装对象，它包装了mybatis配置信息及SQL映射信息等。mapper.xml文件中一个SQL对应一个MappedStatement对象，SQL的id即MappedStatement的id。</p>
</li>
<li><p>MappedStatement对sql执行输入参数进行定义，包括HashMap、基本类型、pojo，Executor通过Mapped Statement在执行sql前将输入的java对象映射至sql中，输入参数映射就是jdbc编程中对preparedStatement设置参数。</p>
</li>
<li><p>MappedStatement对sql执行输出结果进行定义，包括HashMap、基本类型、pojo，Executor通过Mapped Statement在执行sql后将输出结果映射至java对象中，输出结果映射过程相当于jdbc编程中对结果的解析处理过程。</p>
</li>
</ol>
<h2 id="3、mybatis的入门程序"><a href="#3、mybatis的入门程序" class="headerlink" title="3、mybatis的入门程序"></a>3、mybatis的入门程序</h2><h3 id="1、mybatis下载"><a href="#1、mybatis下载" class="headerlink" title="1、mybatis下载"></a>1、mybatis下载</h3><p>mybatis的代码由GitHub管理，地址为：<a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="external">https://github.com/mybatis/mybatis-3/releases</a></p>
<p>文件结构为：</p>
<p><img src="/img/mybatis-2.jpg" alt="Alt text"></p>
<h3 id="2、实现的功能"><a href="#2、实现的功能" class="headerlink" title="2、实现的功能"></a>2、实现的功能</h3><ul>
<li><p>根据用户id查询一个用户信息</p>
</li>
<li><p>根据用户名称模糊查询用户信息列表</p>
</li>
<li><p>添加用户</p>
</li>
<li><p>更新用户</p>
</li>
<li><p>删除用户</p>
</li>
</ul>
<h3 id="3、工程搭建"><a href="#3、工程搭建" class="headerlink" title="3、工程搭建"></a>3、工程搭建</h3><ol>
<li><p>使用IDEA 2017.2 创建Java工程，jdk为1.8.0_141</p>
</li>
<li><p>添加jar包，包括mybatis核心包，依赖包，数据库驱动包</p>
<p> <img src="/img/mybatis-3.jpg" alt="Alt text"></p>
</li>
<li><p>日志的打印：mybatis默认使用log4j输出日志信息，在classpath下创建log4j.properties：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Global logging configuration</div><div class="line">log4j.rootLogger=DEBUG, stdout</div><div class="line"># Console output...</div><div class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</div></pre></td></tr></table></figure>
</li>
<li><p>SqlMapConfig.xml文件：配置了数据源，事务管理</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE configuration</div><div class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</div><div class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">    &lt;!-- 和spring整合后 environments配置将废除--&gt;</div><div class="line">    &lt;environments default=&quot;development&quot;&gt;</div><div class="line">        &lt;environment id=&quot;development&quot;&gt;</div><div class="line">            &lt;!-- 使用jdbc事务管理--&gt;</div><div class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</div><div class="line">            &lt;!-- 数据库连接池--&gt;</div><div class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</div><div class="line">                &lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driver&#125;&quot; /&gt;</div><div class="line">                &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</div><div class="line">                &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</div><div class="line">                &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</div><div class="line">            &lt;/dataSource&gt;</div><div class="line">        &lt;/environment&gt;</div><div class="line">    &lt;/environments&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>po类的编写：po类作为mybatis进行SQL映射使用，po类通常与数据表对应，User.java如下：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.pojo;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class User &#123;</div><div class="line">	private int id;</div><div class="line">	private String username;// 用户姓名</div><div class="line">	private String sex;// 性别</div><div class="line">	private Date birthday;// 生日</div><div class="line">	private String address;// 地址</div><div class="line">  //omit the getter and setter...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>编写SQL映射文件：User.xml, namespace用于隔离SQL语句</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE mapper</div><div class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</div><div class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</div><div class="line">&lt;!--命名空间的作用为SQL隔离--&gt;</div><div class="line">&lt;mapper namespace=&quot;test&quot;&gt;</div><div class="line"></div><div class="line">&lt;/mapper&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>加载映射文件，将User.xml添加在SQLMapConfig.xml中：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;mappers&gt;</div><div class="line">  &lt;mapper resource=&quot;User.xml&quot;/&gt;</div><div class="line">&lt;/mappers&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4、根据id查询用户信息"><a href="#4、根据id查询用户信息" class="headerlink" title="4、根据id查询用户信息"></a>4、根据id查询用户信息</h3><ol>
<li><p>在user.xml中添加SQL语句：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;!--根据id获取用户信息--&gt;</div><div class="line">&lt;!--parameterType指定传入参数类型，</div><div class="line">    resultMap指定结果集类型</div><div class="line">    #&#123;&#125;为占位符，如果传入的是基本类型，#&#123;&#125;中的变量名称可以随意指定</div><div class="line"> --&gt;</div><div class="line">&lt;select id=&quot;findUserById&quot; parameterType=&quot;java.lang.Integer&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">    select * from user where id = #&#123;id&#125;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试程序：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">private SqlSessionFactory sqlSessionFactory;</div><div class="line"></div><div class="line">@Before</div><div class="line">public void createSqlSessionFactory() throws IOException &#123;</div><div class="line">    //配置文件</div><div class="line">    String resource = &quot;SqlMapConfig.xml&quot;;</div><div class="line">    InputStream inputStream = Resources.getResourceAsStream(resource);</div><div class="line">    //使用SqlSessionFactoryBuilder从XML配置文件中创建</div><div class="line">    sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@Test</div><div class="line">public void testFindUserById() &#123;</div><div class="line">    SqlSession sqlSession = null;</div><div class="line"></div><div class="line">    try &#123;</div><div class="line">        //创建会话</div><div class="line">        sqlSession = sqlSessionFactory.openSession();</div><div class="line">        //第一个参数，namespace+id</div><div class="line">        User user = sqlSession.selectOne(&quot;test.findUserById&quot;, 1);</div><div class="line"></div><div class="line">        System.out.println(user);</div><div class="line">    &#125; catch (Exception e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125; finally &#123;</div><div class="line">        if (sqlSession != null) &#123;</div><div class="line">            sqlSession.close();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="5、根据用户名查询用户信息"><a href="#5、根据用户名查询用户信息" class="headerlink" title="5、根据用户名查询用户信息"></a>5、根据用户名查询用户信息</h3><ol>
<li><p>在url.xml中添加SQL语句：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!--如果返回结果为集合，则可以调用session中的selectList方法，resultType仍然为--&gt;</div><div class="line">&lt;!--$&#123;&#125;拼接符，如果传入的是基本类型，其内部的变量名称必须为value--&gt;</div><div class="line">&lt;!--拼接符有SQL注入的风险，慎重使用，--&gt;</div><div class="line">&lt;select id=&quot;findUserByUserName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">  select * from user where username like &apos;%$&#123;value&#125;%&apos;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试程序:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">private SqlSessionFactory sqlSessionFactory;</div><div class="line"></div><div class="line">@Before</div><div class="line">public void createSqlSessionFactory() throws IOException &#123;</div><div class="line">    //配置文件</div><div class="line">    String resource = &quot;SqlMapConfig.xml&quot;;</div><div class="line">    InputStream inputStream = Resources.getResourceAsStream(resource);</div><div class="line">    //使用SqlSessionFactoryBuilder从XML配置文件中创建</div><div class="line">    sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@Test</div><div class="line">public void testFindUserByUserName() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    List&lt;User&gt; users = sqlSession.selectList(&quot;test.findUserByUserName&quot;, &quot;王&quot;);</div><div class="line">    for (User user : users) &#123;</div><div class="line">        System.out.println(user);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="6、概念比较"><a href="#6、概念比较" class="headerlink" title="6、概念比较"></a>6、概念比较</h3><ol>
<li><p>#{}和${}</p>
<ul>
<li><p>#{}表示一个占位符号，通过#{}可以实现preparedStatement向占位符中设置值，自动进行java类型和jdbc类型转换，#{}可以有效防止SQL注入。#{}可以接收简单类型值或pojo属性值。如果parameterType传输单个简单类型值，#{}括号中可以是value或其他属性。</p>
</li>
<li><p>${}表示拼接字符串，通过${}可以将parameterType 传入的内容拼接在sql中且不进行jdbc类型转换， ${}可以接收简单类型值或pojo属性值，如果parameterType传输单个简单类型值，${}括号中只能是value。</p>
</li>
</ul>
</li>
<li><p>parameterType和resultType</p>
<ul>
<li><p>parameterType：指定输入参数类型，mybatis通过OGNL表达式从对象中获取参数值拼接在SQL中。</p>
</li>
<li><p>resultType：指定输出结果类型，mybatis将SQL查询结果的一行记录数据映射为resultType指定类型的对象。</p>
</li>
</ul>
</li>
<li><p>selectOne和selectList</p>
<ul>
<li><p>selectOne：查询一条记录，使用其查询多条记录会抛出异常</p>
</li>
<li><p>selectList：查询一条或者多条记录</p>
</li>
</ul>
</li>
</ol>
<h3 id="7、添加用户"><a href="#7、添加用户" class="headerlink" title="7、添加用户"></a>7、添加用户</h3><ol>
<li><p>在SQLMapConfig.xml中添加：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;!--如果从传入的是pojo类型，name#&#123;&#125;中对应的属.属性--&gt;</div><div class="line">&lt;!--如果要返回数据库自增组件，可以使用select last_insert_id()函数--&gt;</div><div class="line">&lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">    &lt;!--执行数据库函数，返回最近增加的自增主键id</div><div class="line">    keyProperty：将返回的主键放入传入的参数的ID中保存</div><div class="line">    order:当前函数相对于insert语句的执行顺序</div><div class="line">    resultType：keyProperty中的数据的类型</div><div class="line">    --&gt;</div><div class="line">    &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</div><div class="line">      select last_insert_id()</div><div class="line">    &lt;/selectKey&gt;</div><div class="line">    insert into user (username, birthday, sex, address) values (#&#123;username&#125;, #&#123;birthday&#125;, #&#123;sex&#125;, #&#123;address&#125;)</div><div class="line">&lt;/insert&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试程序</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">//omit the before</div><div class="line">@Test</div><div class="line">public void testInsertUser() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    //创建插入数据库的用户对象</div><div class="line">    User user = new User();</div><div class="line">    user.setUsername(&quot;aaa&quot;);</div><div class="line">    user.setBirthday(new Date());</div><div class="line">    user.setSex(&quot;1&quot;);</div><div class="line">    user.setAddress(&quot;北京&quot;);</div><div class="line">    System.out.println(user);</div><div class="line">    //执行SQL语句插入对象</div><div class="line">    sqlSession.insert(&quot;test.insertUser&quot;, user);</div><div class="line">    //提交事务,mybatis会自动开启事务，需要手动提交事务</div><div class="line">    sqlSession.commit();</div><div class="line"></div><div class="line">    System.out.println(user);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>uuid实现主键：AFTER改为BEFORE,则在插入之前生成UUID并保存到数据库中</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;insert  id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;</div><div class="line">&lt;selectKey resultType=&quot;java.lang.String&quot; order=&quot;BEFORE&quot;</div><div class="line">keyProperty=&quot;id&quot;&gt;</div><div class="line">select uuid()</div><div class="line">&lt;/selectKey&gt;</div><div class="line">insert into user(id,username,birthday,sex,address)</div><div class="line">		 values(#&#123;id&#125;,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</div><div class="line">&lt;/insert&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="8、删除用户"><a href="#8、删除用户" class="headerlink" title="8、删除用户"></a>8、删除用户</h3><ol>
<li><p>在SQLMapConfig.xml中添加：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;delete id=&quot;deleteUserById&quot; parameterType=&quot;java.lang.Integer&quot;&gt;</div><div class="line">  delete from user where id=#&#123;id&#125;</div><div class="line">&lt;/delete&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试程序</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//omit the before</div><div class="line">@Test</div><div class="line">public void testDeleteUserById() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    //删除</div><div class="line">    sqlSession.delete(&quot;test.deleteUserById&quot;, 28);</div><div class="line">    //提交</div><div class="line">    sqlSession.commit();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="9、修改用户"><a href="#9、修改用户" class="headerlink" title="9、修改用户"></a>9、修改用户</h3><ol>
<li><p>在SQLMapConfig.xml中添加：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;update id=&quot;updateUserById&quot; parameterType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">  update user set username = #&#123;username&#125; where id = #&#123;id&#125;</div><div class="line">&lt;/update&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试程序</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testUpdateUserById() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line"></div><div class="line">    User user = new User();</div><div class="line">    user.setId(29);</div><div class="line">    user.setUsername(&quot;王麻子&quot;);</div><div class="line"></div><div class="line">    sqlSession.update(&quot;test.updateUserById&quot;, user);</div><div class="line"></div><div class="line">    sqlSession.commit();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="10、mybatis解决jdbc编程的问题"><a href="#10、mybatis解决jdbc编程的问题" class="headerlink" title="10、mybatis解决jdbc编程的问题"></a>10、mybatis解决jdbc编程的问题</h3><ol>
<li><p>数据库连接创建，释放频繁造成系统资源浪费从而影响系统性能，可以使用数据库连接池技术来解决这个问题。</p>
<p> 解决：<em>在SQLMapConfig.xml中配置数据连接池，使用连接池管理数据库连接</em></p>
</li>
<li><p>SQL语句在代码中硬编码，不便于维护，实际应用中修改SQL语句需要修改java代码，不便于修改。</p>
<p> 解决：<em>将SQL语句配置在XXmapper.xml文件中与java程序分离</em></p>
</li>
<li><p>使用preparedStatement语句向占位符传参存在硬编码，实际上SQL语句的where条件不固定，修改困难</p>
<p> 解决：<em>mybatis自动将java对象映射至SQL语句，通过statement中的parameterType定义输入参数的类型</em></p>
</li>
<li><p>对结果集存在硬编码（查询列名），SQL变化导致解析代码变化，系统不易维护，将数据库记录封装成pojo对象解析比较方便。</p>
<p> 解决：<em>mybatis自动将SQL执行结果映射至java对象，通过statement的resultType定义输出结果的类型</em></p>
</li>
</ol>
<h3 id="11、mybatis和hibernate的区别"><a href="#11、mybatis和hibernate的区别" class="headerlink" title="11、mybatis和hibernate的区别"></a>11、mybatis和hibernate的区别</h3><ol>
<li><p>Mybatis和hibernate不同，它不完全是一个ORM框架，因为MyBatis需要程序员自己编写Sql语句，不过mybatis可以通过XML或注解方式灵活配置要运行的sql语句，并将java对象和sql语句映射生成最终执行的sql，最后将sql执行的结果再映射生成java对象。</p>
</li>
<li><p>Mybatis学习门槛低，简单易学，程序员直接编写原生态sql，可严格控制sql执行性能，灵活度高，非常适合对关系数据模型要求不高的软件开发，例如互联网软件、企业运营类软件等，因为这类软件需求变化频繁，一但需求变化要求成果输出迅速。但是灵活的前提是mybatis无法做到数据库无关性，如果需要实现支持多种数据库的软件则需要自定义多套sql映射文件，工作量大。</p>
</li>
<li><p>Hibernate对象/关系映射能力强，数据库无关性好，对于关系模型要求高的软件（例如需求固定的定制化软件）如果用hibernate开发可以节省很多代码，提高效率。但是Hibernate的学习门槛高，要精通门槛更高，而且怎么设计O/R映射，在性能和对象模型之间如何权衡，以及怎样用好Hibernate需要具有很强的经验和能力才行。</p>
</li>
</ol>
<h1 id="三、DAO的开发方法"><a href="#三、DAO的开发方法" class="headerlink" title="三、DAO的开发方法"></a>三、DAO的开发方法</h1><p>使用mybatis开发DAO，有两种方法，原始DAO方法和Mapper接口开发方法</p>
<h2 id="1、需求"><a href="#1、需求" class="headerlink" title="1、需求"></a>1、需求</h2><ul>
<li><p>根据用户id查询一个用户信息</p>
</li>
<li><p>根据用户名称模糊查询用户信息列表</p>
</li>
<li><p>添加用户信息</p>
</li>
</ul>
<h2 id="2、SqlSession的使用范围"><a href="#2、SqlSession的使用范围" class="headerlink" title="2、SqlSession的使用范围"></a>2、SqlSession的使用范围</h2><p>SqlSession中封装了对数据库的操作，如：查询、插入、更新、删除等。通过SqlSessionFactory创建SqlSession，而SqlSessionFactory是通过SqlSessionFactoryBuilder进行创建。</p>
<ol>
<li><p>SqlSessionFactoryBuilder：用于创建SqlSessionFacoty，SqlSessionFacoty一旦创建完成就不需要SqlSessionFactoryBuilder了，因为SqlSession是通过SqlSessionFactory生产，所以可以将SqlSessionFactoryBuilder当成一个工具类使用，最佳使用范围是方法范围即方法体内局部变量。</p>
</li>
<li><p>SqlSessionFactory：SQLSessionFactory是一个接口，接口中定义了openSession的不同重载方法，SqlSessionFactory的最佳使用范围是整个运行期间，一旦创建之后可以重复使用，通常以单例模式管理SqlSessionFactory。</p>
</li>
<li><p>SqlSession: SqlSession是一个面向用户的接口,sqlSession中定义了数据库操作方法。每个线程都应该有它自己的SqlSession实例。SqlSession的实例不能共享使用，它也是线程不安全的。因此最佳的范围是请求或方法范围。绝对不能将SqlSession实例的引用放在一个类的静态字段或实例字段中。打开一个 SqlSession；使用完毕就要关闭它。通常把这个关闭操作放到 finally 块中以确保每次都能执行关闭。</p>
</li>
</ol>
<h2 id="3、原始DAO开发方式（需要编写接口和实现类）"><a href="#3、原始DAO开发方式（需要编写接口和实现类）" class="headerlink" title="3、原始DAO开发方式（需要编写接口和实现类）"></a>3、原始DAO开发方式（需要编写接口和实现类）</h2><ul>
<li><p>映射文件：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE mapper</div><div class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</div><div class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</div><div class="line">&lt;!--命名空间的作用为SQL隔离--&gt;</div><div class="line">&lt;mapper namespace=&quot;test&quot;&gt;</div><div class="line">    &lt;!--根据id获取用户信息--&gt;</div><div class="line">    &lt;select id=&quot;findUserById&quot; parameterType=&quot;java.lang.Integer&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">        select * from user where id = #&#123;id&#125;</div><div class="line">    &lt;/select&gt;</div><div class="line"></div><div class="line">    &lt;select id=&quot;findUserByUserName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">      select * from user where username like &apos;%$&#123;value&#125;%&apos;</div><div class="line">    &lt;/select&gt;</div><div class="line"></div><div class="line">    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">        &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</div><div class="line">          select last_insert_id()</div><div class="line">        &lt;/selectKey&gt;</div><div class="line">        insert into user (username, birthday, sex, address) values (#&#123;username&#125;, #&#123;birthday&#125;, #&#123;sex&#125;, #&#123;address&#125;)</div><div class="line">    &lt;/insert&gt;</div><div class="line">&lt;/mapper&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>Dao接口:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.dao;</div><div class="line"></div><div class="line">import cn.itheima.pojo.User;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public interface UserDao &#123;</div><div class="line">    public User findUserById(Integer id);</div><div class="line"></div><div class="line">    public List&lt;User&gt; findUserByUserName(String username);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>实现类：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.dao;</div><div class="line"></div><div class="line">import cn.itheima.pojo.User;</div><div class="line">import org.apache.ibatis.session.SqlSession;</div><div class="line">import org.apache.ibatis.session.SqlSessionFactory;</div><div class="line">import org.junit.Test;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class UserDaoImpl implements UserDao&#123;</div><div class="line"></div><div class="line">    private SqlSessionFactory sqlSessionFactory;</div><div class="line">    //通过构造方法注入</div><div class="line">    public UserDaoImpl(SqlSessionFactory sqlSessionFactory) &#123;</div><div class="line">        this.sqlSessionFactory = sqlSessionFactory;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    @Override</div><div class="line">    public User findUserById(Integer id) &#123;</div><div class="line">        //sqlSession是县城不安全的，所以他是最佳使用范围在方法体内</div><div class="line">        SqlSession openSession = sqlSessionFactory.openSession();</div><div class="line">        User user = openSession.selectOne(&quot;test.findUserById&quot;, id);</div><div class="line">        return user;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public List&lt;User&gt; findUserByUserName(String username) &#123;</div><div class="line"></div><div class="line">        SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line"></div><div class="line">        List&lt;User&gt; users = sqlSession.selectList(&quot;test.findUserByUserName&quot;, username);</div><div class="line"></div><div class="line">        return users;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>测试：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">package test.cn.itheima.dao;</div><div class="line"></div><div class="line">import cn.itheima.dao.UserDao;</div><div class="line">import cn.itheima.dao.UserDaoImpl;</div><div class="line">import cn.itheima.pojo.User;</div><div class="line">import org.apache.ibatis.io.Resources;</div><div class="line">import org.apache.ibatis.session.SqlSessionFactory;</div><div class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</div><div class="line">import org.junit.Test;</div><div class="line">import org.junit.Before;</div><div class="line">import org.junit.After;</div><div class="line"></div><div class="line">import java.io.InputStream;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line">* UserDaoImpl Tester.</div><div class="line">*</div><div class="line">* @author &lt;Authors name&gt;</div><div class="line">* @since &lt;pre&gt;一月 24, 2018&lt;/pre&gt;</div><div class="line">* @version 1.0</div><div class="line">*/</div><div class="line">public class UserDaoImplTest &#123;</div><div class="line">    private SqlSessionFactory sqlSessionFactory;</div><div class="line">    private UserDao userDao;</div><div class="line">@Before</div><div class="line">public void before() throws Exception &#123;</div><div class="line">    String resource = &quot;SqlMapConfig.xml&quot;;</div><div class="line">    InputStream inputStream = Resources.getResourceAsStream(resource);</div><div class="line">    sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">    userDao = new UserDaoImpl(sqlSessionFactory);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@After</div><div class="line">public void after() throws Exception &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line">*</div><div class="line">* Method: findUserById(Integer id)</div><div class="line">*</div><div class="line">*/</div><div class="line">@Test</div><div class="line">public void testFindUserById() throws Exception &#123;</div><div class="line"></div><div class="line">    User user = userDao.findUserById(1);</div><div class="line">    System.out.println(user);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line">*</div><div class="line">* Method: findUserByUserName(String username)</div><div class="line">*</div><div class="line">*/</div><div class="line">@Test</div><div class="line">public void testFindUserByUserName() throws Exception &#123;</div><div class="line"></div><div class="line">    List&lt;User&gt; users = userDao.findUserByUserName(&quot;王&quot;);</div><div class="line">    for (User user : users) &#123;</div><div class="line">        System.out.println(user);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="4、动态代理方法"><a href="#4、动态代理方法" class="headerlink" title="4、动态代理方法"></a>4、动态代理方法</h2><h3 id="1、开发规范"><a href="#1、开发规范" class="headerlink" title="1、开发规范"></a>1、开发规范</h3><p>  Mapper接口开发方法只需要程序员编写Mapper接口，由mybatis框架根据接口定义创建接口的动态代理对象，代理对象的方法体同上班DAO接口实现类方法。Mapper接口需要遵守以下规范：</p>
<ol>
<li><p>Mapper.xml文件中的namespace与mapper接口的类路径相同</p>
</li>
<li><p>Mapper接口方法名和Mapper.xml中定义的每个statement的id相同</p>
</li>
<li><p>Mapper接口方法的输入参数类型和mapper.xml中定义的每个sql的parameterType的类型相同</p>
</li>
<li><p>Mapper接口方法的输出参数类型和mapper.xml中定义的每个sql的resultType类型相同。</p>
</li>
</ol>
<h3 id="2、Mapper-xml（映射文件）"><a href="#2、Mapper-xml（映射文件）" class="headerlink" title="2、Mapper.xml（映射文件）"></a>2、Mapper.xml（映射文件）</h3><p>定义mapper映射文件UserMapper.xml，需要修改namespace的值为UserMapper接口路径，经UserMapper.xml放在mapper路径下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE mapper</div><div class="line">PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</div><div class="line">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</div><div class="line">&lt;mapper namespace=&quot;cn.itcast.mybatis.mapper.UserMapper&quot;&gt;</div><div class="line">&lt;!-- 根据id获取用户信息 --&gt;</div><div class="line">	&lt;select id=&quot;findUserById&quot; parameterType=&quot;int&quot; resultType=&quot;cn.itcast.mybatis.po.User&quot;&gt;</div><div class="line">		select * from user where id = #&#123;id&#125;</div><div class="line">	&lt;/select&gt;</div><div class="line">&lt;!-- 自定义条件查询用户列表 --&gt;</div><div class="line">	&lt;select id=&quot;findUserByUsername&quot; parameterType=&quot;java.lang.String&quot;</div><div class="line">			resultType=&quot;cn.itcast.mybatis.po.User&quot;&gt;</div><div class="line">	   select * from user where username like &apos;%$&#123;value&#125;%&apos;</div><div class="line">	&lt;/select&gt;</div><div class="line">&lt;!-- 添加用户 --&gt;</div><div class="line">	&lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;</div><div class="line">	&lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;java.lang.Integer&quot;&gt;</div><div class="line">		select LAST_INSERT_ID()</div><div class="line">	&lt;/selectKey&gt;</div><div class="line">	  insert into user(username,birthday,sex,address)</div><div class="line">	  values(#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</div><div class="line">	&lt;/insert&gt;</div><div class="line"></div><div class="line">&lt;/mapper&gt;</div></pre></td></tr></table></figure>
<h3 id="3、Mapper-java（接口文件）"><a href="#3、Mapper-java（接口文件）" class="headerlink" title="3、Mapper.java（接口文件）"></a>3、Mapper.java（接口文件）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Public interface UserMapper &#123;</div><div class="line">	//根据用户id查询用户信息</div><div class="line">	public User findUserById(int id) throws Exception;</div><div class="line">	//查询用户列表</div><div class="line">	public List&lt;User&gt; findUserByUsername(String username) throws Exception;</div><div class="line">	//添加用户信息</div><div class="line">	public void insertUser(User user)throws Exception;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>接口定义有如下特点：</p>
<ol>
<li><p>Mapper接口名和Mapper.xml中定义的statement的id相同</p>
</li>
<li><p>Mapper接口方法的输入参数类型和mapper.xml中定义的statement的parameterType的类型相同。</p>
</li>
<li><p>Mapper接口方法的输出参数类型和mapper.xml中定义的statement的resultType的类型相同</p>
</li>
</ol>
<h3 id="4、在SQLMapConfig-xml中配置映射文件"><a href="#4、在SQLMapConfig-xml中配置映射文件" class="headerlink" title="4、在SQLMapConfig.xml中配置映射文件"></a>4、在SQLMapConfig.xml中配置映射文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 加载映射文件 --&gt;</div><div class="line">&lt;mappers&gt;</div><div class="line">  &lt;mapper resource=&quot;mapper/UserMapper.xml&quot;/&gt;</div><div class="line">&lt;/mappers&gt;</div></pre></td></tr></table></figure>
<h3 id="5、测试"><a href="#5、测试" class="headerlink" title="5、测试"></a>5、测试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">Public class UserMapperTest extends TestCase &#123;</div><div class="line"></div><div class="line">	private SqlSessionFactory sqlSessionFactory;</div><div class="line"></div><div class="line">	protected void setUp() throws Exception &#123;</div><div class="line">		//mybatis配置文件</div><div class="line">		String resource = &quot;sqlMapConfig.xml&quot;;</div><div class="line">		InputStream inputStream = Resources.getResourceAsStream(resource);</div><div class="line">		//使用SqlSessionFactoryBuilder创建sessionFactory</div><div class="line">		sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	Public void testFindUserById() throws Exception &#123;</div><div class="line">		//获取session</div><div class="line">		SqlSession session = sqlSessionFactory.openSession();</div><div class="line">		//获取mapper接口的代理对象</div><div class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</div><div class="line">		//调用代理对象方法</div><div class="line">		User user = userMapper.findUserById(1);</div><div class="line">		System.out.println(user);</div><div class="line">		//关闭session</div><div class="line">		session.close();</div><div class="line"></div><div class="line">	&#125;</div><div class="line">	@Test</div><div class="line">	public void testFindUserByUsername() throws Exception &#123;</div><div class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">		UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">		List&lt;User&gt; list = userMapper.findUserByUsername(&quot;张&quot;);</div><div class="line">		System.out.println(list.size());</div><div class="line"></div><div class="line">	&#125;</div><div class="line">Public void testInsertUser() throws Exception &#123;</div><div class="line">		//获取session</div><div class="line">		SqlSession session = sqlSessionFactory.openSession();</div><div class="line">		//获取mapper接口的代理对象</div><div class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</div><div class="line">		//要添加的数据</div><div class="line">		User user = new User();</div><div class="line">		user.setUsername(&quot;张三&quot;);</div><div class="line">		user.setBirthday(new Date());</div><div class="line">		user.setSex(&quot;1&quot;);</div><div class="line">		user.setAddress(&quot;北京市&quot;);</div><div class="line">		//通过mapper接口添加用户</div><div class="line">		userMapper.insertUser(user);</div><div class="line">		//提交</div><div class="line">		session.commit();</div><div class="line">		//关闭session</div><div class="line">		session.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="6、小结"><a href="#6、小结" class="headerlink" title="6、小结"></a>6、小结</h3><ol>
<li><p>selectOne和selectList:动态代理对象调用sqlSession.selectOne()和sqlSession.selectList()是根据mapper接口的返回值决定，如果返回list则调用selectList方法，如果返回单个对象则调用selectOne方法。</p>
</li>
<li><p>namespace：mybatis官方推荐使用mapper代理方法开发mapper接口，程序员不用编写mapper接口实现类，使用mapper代理方法时，输入参数可以使用pojo包装对象或map对象，保证dao的通用性。</p>
</li>
</ol>
<h1 id="四、SqlMapConfig-xml文件说明"><a href="#四、SqlMapConfig-xml文件说明" class="headerlink" title="四、SqlMapConfig.xml文件说明"></a>四、SqlMapConfig.xml文件说明</h1><h2 id="1、配置内容："><a href="#1、配置内容：" class="headerlink" title="1、配置内容："></a>1、配置内容：</h2><ul>
<li><p>properties（属性）</p>
</li>
<li><p>settings（全局配置参数）</p>
</li>
<li><p>typeAliases（类型别名）</p>
</li>
<li><p>typeHandlers（类型处理器）</p>
</li>
<li><p>objectFactory（对象工厂）</p>
</li>
<li><p>plugins（插件）</p>
</li>
<li><p>environments（环境集合属性对象）</p>
</li>
<li><p>environment（环境子属性对象）</p>
</li>
<li><p>transactionManager（事务管理）</p>
</li>
<li><p>dataSource（数据源）</p>
</li>
<li><p>mappers（映射器）</p>
</li>
</ul>
<h2 id="2、properties-属性"><a href="#2、properties-属性" class="headerlink" title="2、properties(属性)"></a>2、properties(属性)</h2><p>SqlMapConfig.xml可以引用java属性文件中的配置信息，创建db.properties保存数据库属性：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">jdbc.driver=com.mysql.jdbc.Driver</div><div class="line">jdbc.url=jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8</div><div class="line">jdbc.username=root</div><div class="line">jdbc.password=linux</div></pre></td></tr></table></figure></p>
<p>修改SqlMapConfig.xml中引用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;configuration&gt;</div><div class="line">    &lt;!--加载db.properties中的参数--&gt;</div><div class="line">    &lt;properties resource=&quot;db.properties&quot;/&gt;</div><div class="line"></div><div class="line">    &lt;!-- 和spring整合后 environments配置将废除--&gt;</div><div class="line">    &lt;environments default=&quot;development&quot;&gt;</div><div class="line">        &lt;environment id=&quot;development&quot;&gt;</div><div class="line">            &lt;!-- 使用jdbc事务管理--&gt;</div><div class="line">            &lt;transactionManager type=&quot;JDBC&quot; /&gt;</div><div class="line">            &lt;!-- 数据库连接池--&gt;</div><div class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</div><div class="line">                &lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc.driver&#125;&quot; /&gt;</div><div class="line">                &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</div><div class="line">                &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</div><div class="line">                &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</div><div class="line">            &lt;/dataSource&gt;</div><div class="line">        &lt;/environment&gt;</div><div class="line">    &lt;/environments&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
<p><em>其属性读取顺序为：</em></p>
<ol>
<li>在properties元素体内定义的属性会首先被读取</li>
<li>然后会读取properties元素中的resource或url加载的属性，它会覆盖已经读取的同名属性。</li>
</ol>
<h2 id="3、typeAliases-类型别名"><a href="#3、typeAliases-类型别名" class="headerlink" title="3、typeAliases(类型别名)"></a>3、typeAliases(类型别名)</h2><h3 id="1、mybatis支持别名："><a href="#1、mybatis支持别名：" class="headerlink" title="1、mybatis支持别名："></a>1、mybatis支持别名：</h3><table>
<thead>
<tr>
<th>别名</th>
<th>映射的类型</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_byte</code></td>
<td>byte</td>
</tr>
<tr>
<td><code>_long</code></td>
<td>long</td>
</tr>
<tr>
<td><code>_short</code></td>
<td>short</td>
</tr>
<tr>
<td><code>_int</code></td>
<td>int</td>
</tr>
<tr>
<td><code>_integer</code></td>
<td>int</td>
</tr>
<tr>
<td><code>_double</code></td>
<td>double</td>
</tr>
<tr>
<td><code>_float</code></td>
<td>float</td>
</tr>
<tr>
<td><code>_boolean</code></td>
<td>boolean</td>
</tr>
<tr>
<td><code>string</code></td>
<td>String</td>
</tr>
<tr>
<td><code>byte</code></td>
<td>Byte</td>
</tr>
<tr>
<td><code>long</code></td>
<td>Long</td>
</tr>
<tr>
<td><code>short</code></td>
<td>Short</td>
</tr>
<tr>
<td><code>int</code></td>
<td>Integer</td>
</tr>
<tr>
<td><code>integer</code></td>
<td>Integer</td>
</tr>
<tr>
<td><code>double</code></td>
<td>Double</td>
</tr>
<tr>
<td><code>float</code></td>
<td>Float</td>
</tr>
<tr>
<td><code>boolean</code></td>
<td>Boolean</td>
</tr>
<tr>
<td><code>date</code></td>
<td>Date</td>
</tr>
<tr>
<td><code>decimal</code></td>
<td>BigDecimal</td>
</tr>
<tr>
<td><code>bigdecimal</code></td>
<td>BigDecimal</td>
</tr>
<tr>
<td><code>map</code></td>
<td>Map</td>
</tr>
</tbody>
</table>
<h3 id="2、自定义别名：在SqlMapConfig-xml中配置："><a href="#2、自定义别名：在SqlMapConfig-xml中配置：" class="headerlink" title="2、自定义别名：在SqlMapConfig.xml中配置："></a>2、自定义别名：在SqlMapConfig.xml中配置：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;!--别名--&gt;</div><div class="line">    &lt;typeAliases&gt;</div><div class="line">        &lt;!--定义单个pojo类别名 type 类的全路径名， alias别名--&gt;</div><div class="line">        &lt;typeAlias type=&quot;cn.itheima.pojo.User&quot; alias=&quot;user&quot;/&gt;</div><div class="line">        &lt;!--使用包扫描的方式数量定义别名，定以后别名等于类名，不区分大小写，建议按照Java命名规则来--&gt;</div><div class="line">        &lt;package name=&quot;cn.itheima.pojo&quot;/&gt;</div><div class="line">    &lt;/typeAliases&gt;</div></pre></td></tr></table></figure>
<h2 id="4、Mappers-映射器"><a href="#4、Mappers-映射器" class="headerlink" title="4、Mappers(映射器)"></a>4、Mappers(映射器)</h2><ol>
<li><p><mapper resource=" ">: 使用相对于类路径的资源,如：<mapper resource="sqlmap/User.xml"></mapper></mapper></p>
</li>
<li><p><mapper class=" ">:使用mapper接口类路径,如：<mapper class="cn.itcast.mybatis.mapper.UserMapper"></mapper></mapper></p>
</li>
</ol>
<p><em>注意：此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中。</em></p>
<ol>
<li><package name="">:注册指定包下的所有mapper接口,如：<package name="cn.itcast.mybatis.mapper"></package></package></li>
</ol>
<p><em>注意：此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中。</em></p>
<h2 id="5、传递pojo包装类内容-输入类型的一种"><a href="#5、传递pojo包装类内容-输入类型的一种" class="headerlink" title="5、传递pojo包装类内容(输入类型的一种)"></a>5、传递pojo包装类内容(输入类型的一种)</h2><p>开发中通过pojo传递查询条件，查询条件是综合的查询条件，不仅包括用户查询条件，还包括其它的查询条件（比如将用户购买商品信息也作为查询条件），这时可以使用包装对象传递输入参数。Pojo类中包含pojo。</p>
<p>需求：根据用户名查询用户信息，查询条件放到QueryVo的user属性中。</p>
<ol>
<li><p>QueryVo:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.pojo;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class QueryVo &#123;</div><div class="line">    private User user;</div><div class="line"></div><div class="line">    private List&lt;Integer&gt; ids;</div><div class="line"></div><div class="line">    public List&lt;Integer&gt; getIds() &#123;</div><div class="line">        return ids;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setIds(List&lt;Integer&gt; ids) &#123;</div><div class="line">        this.ids = ids;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public User getUser() &#123;</div><div class="line">        return user;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setUser(User user) &#123;</div><div class="line">        this.user = user;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>sql语句</p>
<p> <code>select * from user where username like &#39;%王%&#39;</code></p>
</li>
<li><p>Mapper文件</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findUserByVo&quot; parameterType=&quot;cn.itheima.pojo.QueryVo&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">    select * from user where username LIKE &apos;%$&#123;user.username&#125;%&apos; AND sex=#&#123;user.sex&#125;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>接口</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public List&lt;User&gt; findUserByVo(QueryVo queryVo);</div></pre></td></tr></table></figure>
</li>
<li><p>测试：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void findUserByVo() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line">    QueryVo queryVo = new QueryVo();</div><div class="line">    User user = new User();</div><div class="line">    user.setUsername(&quot;王&quot;);</div><div class="line">    user.setSex(&quot;1&quot;);</div><div class="line">    queryVo.setUser(user);</div><div class="line"></div><div class="line"></div><div class="line">    List&lt;User&gt; users = userMapper.findUserByVo(queryVo);</div><div class="line"></div><div class="line">    System.out.println(users);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="6、resultType-输出类型"><a href="#6、resultType-输出类型" class="headerlink" title="6、resultType(输出类型)"></a>6、resultType(输出类型)</h2><h3 id="1、输出简单类型"><a href="#1、输出简单类型" class="headerlink" title="1、输出简单类型"></a>1、输出简单类型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findUserCount&quot; resultType=&quot;java.lang.Long&quot;&gt;</div><div class="line">    select count(*) from user</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public Long findUserCount();</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testFindUserCount() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">    System.out.println(userMapper.findUserCount());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2、输出pojo对象或者pojo对象列表"><a href="#2、输出pojo对象或者pojo对象列表" class="headerlink" title="2、输出pojo对象或者pojo对象列表"></a>2、输出pojo对象或者pojo对象列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findUserById&quot; parameterType=&quot;java.lang.Integer&quot; resultType=&quot;user&quot;&gt;</div><div class="line">    select * from user where id = #&#123;id&#125;</div><div class="line">&lt;/select&gt;</div><div class="line"></div><div class="line">&lt;select id=&quot;findUserByUserName&quot; parameterType=&quot;java.lang.String&quot; resultType=&quot;User&quot;&gt;</div><div class="line">    select * from user where username like &apos;%$&#123;value&#125;%&apos;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public User findUserById(Integer id);</div><div class="line">//    动态代理模式中，如果返回结果集WieList，mybatis会在生成实现类的时候自动调用selectList方法</div><div class="line">public List&lt;User&gt; findUserByUserName(String username);</div></pre></td></tr></table></figure>
<h2 id="7、resultMap"><a href="#7、resultMap" class="headerlink" title="7、resultMap"></a>7、resultMap</h2><p>  resultType可以指定pojo将查询结果映射为pojo，但需要pojo的属性名和sql查询的列名一致方可映射成功。如果sql查询字段名和pojo的属性名不一致，可以通过resultMap将字段名和属性名作一个对应关系 ，resultMap实质上还需要将查询结果映射到pojo对象中。resultMap可以实现将查询结果映射为复杂类型的pojo，比如在查询结果映射对象中包括pojo和list实现一对一查询和一对多查询。</p>
<ol>
<li><p>Mapper.xml的定义:使用resultMap来指定输出内容映射</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findOrdersAndUser2&quot; resultMap=&quot;orderAndUserResultMap&quot;&gt;</div><div class="line">    select a.*, b.id uid, username, birthday, sex, address</div><div class="line">    from orders a, user b</div><div class="line">    where a.user_id = b.id</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>定义resultMap</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;!--一对一，手动映射--&gt;</div><div class="line">&lt;!--id resultMap的唯一标识，type为将查询出的数据放入这个指定的对象</div><div class="line">    手动映射需要制定数据库中表的字段名与java中Pojo类的属性名称的对应关系</div><div class="line">--&gt;</div><div class="line">&lt;resultMap id=&quot;orderAndUserResultMap&quot; type=&quot;cn.itheima.pojo.Orders&quot;&gt;</div><div class="line">    &lt;!--id标签制定主键字段对应关系， column为数据库中的字段名，property为pojo类的属性名--&gt;</div><div class="line">    &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;</div><div class="line">    &lt;!--result标签制定非主键列的对应关系--&gt;</div><div class="line">    &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;/&gt;</div><div class="line">    &lt;result column=&quot;number&quot; property=&quot;number&quot;/&gt;</div><div class="line">    &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;/&gt;</div><div class="line">    &lt;result column=&quot;note&quot; property=&quot;note&quot;/&gt;</div><div class="line">    &lt;!--user对象的映射关系的指定</div><div class="line">    property：指定将数据放入Orders中的user属性中，</div><div class="line">    type为user的类型</div><div class="line">    --&gt;</div><div class="line">    &lt;association property=&quot;user&quot; javaType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">        &lt;id column=&quot;uid&quot; property=&quot;id&quot;/&gt;</div><div class="line">        &lt;result column=&quot;username&quot; property=&quot;username&quot;/&gt;</div><div class="line">        &lt;result column=&quot;birthday&quot; property=&quot;birthday&quot;/&gt;</div><div class="line">        &lt;result column=&quot;sex&quot; property=&quot;sex&quot;/&gt;</div><div class="line">        &lt;result column=&quot;address&quot; property=&quot;address&quot;/&gt;</div><div class="line">    &lt;/association&gt;</div><div class="line">&lt;/resultMap&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>Mapper接口定义</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public List&lt;Orders&gt; findOrdersAndUser2();</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="五-动态sql"><a href="#五-动态sql" class="headerlink" title="五 动态sql"></a>五 动态sql</h1><p>通过mybatis提供的各种标签方法实现动态拼接SQL。</p>
<h2 id="1、if"><a href="#1、if" class="headerlink" title="1、if"></a>1、if</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findUserByUserNameAndSex&quot; parameterType=&quot;cn.itheima.pojo.User&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">    select * from user</div><div class="line">    where 1=1</div><div class="line">    &lt;if test=&quot;id!=null&quot;&gt;</div><div class="line">    and id=#&#123;id&#125;</div><div class="line">    &lt;/if&gt;</div><div class="line">    &lt;if test=&quot;username!=null and username!=&apos;&apos;&quot;&gt;</div><div class="line">    and username like &apos;%$&#123;username&#125;%&apos;</div><div class="line">    &lt;/if&gt;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<p><em>空字符串校验</em></p>
<h2 id="2、where"><a href="#2、where" class="headerlink" title="2、where"></a>2、where</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findUserByUserNameAndSex&quot; parameterType=&quot;cn.itheima.pojo.User&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">    select * from user</div><div class="line">    &lt;where&gt;</div><div class="line">    &lt;if test=&quot;id!=null and id!=&apos;&apos;&quot;&gt;</div><div class="line">    and id=#&#123;id&#125;</div><div class="line">    &lt;/if&gt;</div><div class="line">    &lt;if test=&quot;username!=null and username!=&apos;&apos;&quot;&gt;</div><div class="line">    and username like &apos;%$&#123;username&#125;%&apos;</div><div class="line">    &lt;/if&gt;</div><div class="line">    &lt;/where&gt;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<p><em>会自动向SQL语句中添加where关键字，会去掉第一个条件的and关键字</em></p>
<h2 id="3、foreach"><a href="#3、foreach" class="headerlink" title="3、foreach"></a>3、foreach</h2><p>向SQL传递数组或List，mybatis使用foreach解析，需求在传入多个id查询用户信息时需要。</p>
<ul>
<li><p>需要在Vo中定义list属性ids存储多个用户id，并添加getter、setter方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">private List&lt;Integer&gt; ids;</div><div class="line"></div><div class="line">    public List&lt;Integer&gt; getIds() &#123;</div><div class="line">        return ids;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setIds(List&lt;Integer&gt; ids) &#123;</div><div class="line">        this.ids = ids;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>mapper.xml中的编写：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;select id=&quot;findUserByIds&quot; parameterType=&quot;cn.itheima.pojo.QueryVo&quot; resultType=&quot;user&quot;&gt;</div><div class="line">  select * from user</div><div class="line">  &lt;where&gt;</div><div class="line">      &lt;if test=&quot;ids != null and ids.size &gt; 0&quot;&gt;</div><div class="line">          &lt;!--foreach：循环传入的集合参数</div><div class="line">              collection:传入的集合的变量名称</div><div class="line">              item:每次循环将循环出的数据放入这个变量中</div><div class="line">              open:循环开始拼接的字符串</div><div class="line">              close:循环结束拼接的字符串</div><div class="line">              seperator:循环中拼接的字符串</div><div class="line">          --&gt;</div><div class="line">          &lt;foreach collection=&quot;ids&quot; item=&quot;id&quot; open=&quot;and id in (&quot; close=&quot;)&quot; separator=&quot;,&quot;&gt;</div><div class="line">              #&#123;id&#125;</div><div class="line">          &lt;/foreach&gt;</div><div class="line">      &lt;/if&gt;</div><div class="line">  &lt;/where&gt;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testFindUserByIds() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line">    QueryVo vo = new QueryVo();</div><div class="line">    List&lt;Integer&gt; ids = new ArrayList&lt;&gt;();</div><div class="line">    ids.add(1);</div><div class="line">    ids.add(10);</div><div class="line">    ids.add(16);</div><div class="line">    ids.add(28);</div><div class="line">    ids.add(22);</div><div class="line"></div><div class="line">    vo.setIds(ids);</div><div class="line"></div><div class="line">    List&lt;User&gt; users = userMapper.findUserByIds(vo);</div><div class="line"></div><div class="line">    for (User user : users) &#123;</div><div class="line">        System.out.println(&quot;===============&quot; + user + &quot;===============&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="4、sql片段"><a href="#4、sql片段" class="headerlink" title="4、sql片段"></a>4、sql片段</h2><p>sql中可将重复的SQL提取出来，使用时用include引用即可，从而达到SQL重用的目的：<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;!--封装SQL条件，封装后可以重用，id为SQL的唯一标示--&gt;</div><div class="line">&lt;sql id=&quot;user_Where&quot;&gt;</div><div class="line">    &lt;!--会自动向SQL语句中添加where关键字，</div><div class="line">        会去掉第一个条件的and关键字--&gt;</div><div class="line">    &lt;where&gt;</div><div class="line">        &lt;if test=&quot;username != null and username != &apos;&apos;&quot;&gt;</div><div class="line">            and username like &apos;%$&#123;username&#125;%&apos;</div><div class="line">        &lt;/if&gt;</div><div class="line">        &lt;if test=&quot;sex != null and sex != &apos;&apos;&quot;&gt;</div><div class="line">            and sex=#&#123;sex&#125;</div><div class="line">        &lt;/if&gt;</div><div class="line">    &lt;/where&gt;</div><div class="line">&lt;/sql&gt;</div><div class="line">......</div><div class="line">&lt;select id=&quot;findUserByUserNameAndSex&quot; parameterType=&quot;cn.itheima.pojo.User&quot; resultType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">     select * from user</div><div class="line">    &lt;!--调用SQL条件--&gt;</div><div class="line">     &lt;include refid=&quot;user_Where&quot;/&gt;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure></p>
<h1 id="六-关联查询"><a href="#六-关联查询" class="headerlink" title="六 关联查询"></a>六 关联查询</h1><h2 id="1、商品订单数据模型"><a href="#1、商品订单数据模型" class="headerlink" title="1、商品订单数据模型"></a>1、商品订单数据模型</h2><p><img src="/img/mybatis-4.jpg" alt="Alt text"></p>
<h2 id="2、一对一关联"><a href="#2、一对一关联" class="headerlink" title="2、一对一关联"></a>2、一对一关联</h2><p>需求：查询所有订单信息，关联查询下单用户信息。由于一个订单信息只能由一个用户下单，所以从查询订单信息出发关联查询用户信息为一对一查询。如果从用户信息出发查询用户下的订单为一对多查询。</p>
<h3 id="方法一：使用resultType，定义订单信息po类，此po类中包括了订单信息和用户信息。"><a href="#方法一：使用resultType，定义订单信息po类，此po类中包括了订单信息和用户信息。" class="headerlink" title="方法一：使用resultType，定义订单信息po类，此po类中包括了订单信息和用户信息。"></a>方法一：使用resultType，定义订单信息po类，此po类中包括了订单信息和用户信息。</h3><ol>
<li><p>SQL语句</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">select a.*, b.id uid, username, birthday, sex, address</div><div class="line">from orders a, user b</div><div class="line">where a.user_id = b.id</div></pre></td></tr></table></figure>
</li>
<li><p>定义po类：po类应该包含sql查询的所有字段</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.pojo;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line"></div><div class="line">public class CustomOrders extends Orders&#123;</div><div class="line">    private int uid;</div><div class="line">    private String username;// 用户姓名</div><div class="line">    private String sex;// 性别</div><div class="line">    private Date birthday;// 生日</div><div class="line">    private String address;// 地址</div><div class="line"></div><div class="line">    //omit...</div></pre></td></tr></table></figure>
<p>   OrdersCustomer类继承Orders类后包括了Orders类的所有字段，只需要定义用户的信息字段即可。</p>
</li>
<li><p>Mapper.xml中</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!--一对一，自动映射 --&gt;</div><div class="line">&lt;select id=&quot;findOrdersAndUser1&quot; resultType=&quot;cn.itheima.pojo.CustomOrders&quot;&gt;</div><div class="line">    select a.*, b.id uid, username, birthday, sex, address</div><div class="line">    from orders a, user b</div><div class="line">    where a.user_id = b.id</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>Mapper接口</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public List&lt;CustomOrders&gt; findOrdersAndUser1();</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testFindOrdersAndUser1() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line">    List&lt;CustomOrders&gt; customOrders = userMapper.findOrdersAndUser1();</div><div class="line"></div><div class="line">    for (CustomOrders customOrders1 : customOrders) &#123;</div><div class="line">        System.out.println(&quot;===============&quot; + customOrders1 + &quot;===============&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>小结：<br>定义专门的po类作为输出类型，其中定义了SQL查询结果集的所有字段，此方法比较简单，企业中使用普遍。</p>
</li>
</ol>
<h3 id="方法二：使用resultMap，定义专门的resultMap用于映射一对一查询"><a href="#方法二：使用resultMap，定义专门的resultMap用于映射一对一查询" class="headerlink" title="方法二：使用resultMap，定义专门的resultMap用于映射一对一查询"></a>方法二：使用resultMap，定义专门的resultMap用于映射一对一查询</h3><ol>
<li><p>SQL语句</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">select a.*, b.id uid, username, birthday, sex, address</div><div class="line">from orders a, user b</div><div class="line">where a.user_id = b.id</div></pre></td></tr></table></figure>
</li>
<li><p>定义po类：在Orders类中加入User属性，User属性中用于存储关联查询的用户信息，因为订单关联查询是一对一关系，所以这里使用单个User对象存储关联查询的用户信息。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.pojo;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class Orders &#123;</div><div class="line">  private Integer id;</div><div class="line"></div><div class="line">  private Integer userId;</div><div class="line"></div><div class="line">  private String number;</div><div class="line"></div><div class="line">  private Date createtime;</div><div class="line"></div><div class="line">  private String note;</div><div class="line"></div><div class="line">  private User user;</div><div class="line">  //omit...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Mapper.xml中</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;resultMap id=&quot;orderAndUserResultMap&quot; type=&quot;cn.itheima.pojo.Orders&quot;&gt;</div><div class="line">    &lt;!--id标签制定主键字段对应关系， column为数据库中的字段名，property为pojo类的属性名--&gt;</div><div class="line">    &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;</div><div class="line">    &lt;!--result标签制定非主键列的对应关系--&gt;</div><div class="line">    &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;/&gt;</div><div class="line">    &lt;result column=&quot;number&quot; property=&quot;number&quot;/&gt;</div><div class="line">    &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;/&gt;</div><div class="line">    &lt;result column=&quot;note&quot; property=&quot;note&quot;/&gt;</div><div class="line">    &lt;!--user对象的映射关系的指定</div><div class="line">    property：指定将数据放入Orders中的user属性中，</div><div class="line">    type为user的类型</div><div class="line">    --&gt;</div><div class="line">    &lt;association property=&quot;user&quot; javaType=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">        &lt;id column=&quot;uid&quot; property=&quot;id&quot;/&gt;</div><div class="line">        &lt;result column=&quot;username&quot; property=&quot;username&quot;/&gt;</div><div class="line">        &lt;result column=&quot;birthday&quot; property=&quot;birthday&quot;/&gt;</div><div class="line">        &lt;result column=&quot;sex&quot; property=&quot;sex&quot;/&gt;</div><div class="line">        &lt;result column=&quot;address&quot; property=&quot;address&quot;/&gt;</div><div class="line">    &lt;/association&gt;</div><div class="line">&lt;/resultMap&gt;</div><div class="line"></div><div class="line">&lt;select id=&quot;findOrdersAndUser2&quot; resultMap=&quot;orderAndUserResultMap&quot;&gt;</div><div class="line">    select a.*, b.id uid, username, birthday, sex, address</div><div class="line">    from orders a, user b</div><div class="line">    where a.user_id = b.id</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
<ul>
<li>association：表示进行关联查询单条记录</li>
<li>property：表示关联查询的结果存储在cn.itcast.mybatis.po.Orders的user属性中</li>
<li>javaType：表示关联查询的结果类型</li>
<li><id property="id" column="user_id">：查询结果的user_id列对应关联对象的id属性，这里是<id>表示user_id是关联查询对象的唯一标识。</id></id></li>
<li><result property="username" column="username">：查询结果的username列对应关联对象的username属性</result></li>
</ul>
</li>
</ol>
<ol>
<li><p>Mapper接口</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public List&lt;Orders&gt; findOrdersAndUser2();</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testFindOrdersAndUser2() throws Exception &#123;</div><div class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line">    List&lt;Orders&gt; orders = userMapper.findOrdersAndUser2();</div><div class="line"></div><div class="line">    System.out.println(orders);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>小结：使用association完成关联查询，将关联查询信息映射到pojo对象中。</p>
</li>
</ol>
<h2 id="3、一对多查询"><a href="#3、一对多查询" class="headerlink" title="3、一对多查询"></a>3、一对多查询</h2><p>需求：查询所有用户信息及用户关联的订单信息，用户信息和订单信息为一对多关系。使用resultMap实现：</p>
<ol>
<li><p>SQL语句</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">select a.*, b.id oid, user_id, number, createtime</div><div class="line">from user a, orders b where a.id = b.user_id</div></pre></td></tr></table></figure>
</li>
<li><p>定义po类：在User类中加入List<orders> orders属性。</orders></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.pojo;</div><div class="line"></div><div class="line">import java.util.Date;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class User &#123;</div><div class="line">  private int id;</div><div class="line">  private String username;// 用户姓名</div><div class="line">  private String sex;// 性别</div><div class="line">  private Date birthday;// 生日</div><div class="line">  private String address;// 地址</div><div class="line"></div><div class="line">  private List&lt;Orders&gt; ordersList;</div><div class="line">   //omit....</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Mapper.xml中</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;resultMap id=&quot;userAndOrdersResultMap&quot; type=&quot;cn.itheima.pojo.User&quot;&gt;</div><div class="line">       &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;</div><div class="line">       &lt;result column=&quot;username&quot; property=&quot;username&quot;/&gt;</div><div class="line">       &lt;result column=&quot;sex&quot; property=&quot;sex&quot;/&gt;</div><div class="line">       &lt;result column=&quot;birthday&quot; property=&quot;birthday&quot;/&gt;</div><div class="line">       &lt;result column=&quot;address&quot; property=&quot;address&quot;/&gt;</div><div class="line">       &lt;!--订单集合--&gt;</div><div class="line">       &lt;!--collection指定对应的集合关系映射</div><div class="line">           property：将数据放入指定的User对象的OrdersList集合属性中</div><div class="line">           ofType: 指定OrderList中的泛型类型</div><div class="line">       --&gt;</div><div class="line">       &lt;collection property=&quot;ordersList&quot; ofType=&quot;cn.itheima.pojo.Orders&quot;&gt;</div><div class="line">           &lt;id column=&quot;oid&quot; property=&quot;id&quot;/&gt;</div><div class="line">           &lt;result column=&quot;user_id&quot; property=&quot;userId&quot;/&gt;</div><div class="line">           &lt;result column=&quot;number&quot; property=&quot;number&quot;/&gt;</div><div class="line">           &lt;result column=&quot;createtime&quot; property=&quot;createtime&quot;/&gt;</div><div class="line">       &lt;/collection&gt;</div><div class="line">   &lt;/resultMap&gt;</div><div class="line"></div><div class="line">   &lt;select id=&quot;findUserAndOrders&quot; resultMap=&quot;userAndOrdersResultMap&quot;&gt;</div><div class="line">       select a.*, b.id oid, user_id, number, createtime</div><div class="line">       from user a, orders b where a.id = b.user_id</div><div class="line">   &lt;/select&gt;</div></pre></td></tr></table></figure>
<ul>
<li>collections:定义了用户关联的订单信息，表示关联查询结果集</li>
<li>property：关联查询的结果集存储在User对象上的那个属性</li>
<li>ofType：指定关联查询的结果集中的对象类型及List中的对象类型。此处可以使用别名也可以使用全限定名</li>
<li><id property="id" column="oid">：查询结果的oid列对应关联对象的id属性，这里是<id>表示oid是关联查询对象的唯一标识。</id></id></li>
<li><result property="userId" column="user_id">：查询结果的userId列对应关联对象的user_id属性</result></li>
</ul>
</li>
</ol>
<ol>
<li><p>Mapper接口</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public List&lt;User&gt; findUserAndOrders();</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testFindUserAndOrders() throws Exception &#123;</div><div class="line">  SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line">  List&lt;User&gt; users = userMapper.findUserAndOrders();</div><div class="line"></div><div class="line">  System.out.println(users);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="七、Spring整合mybatis"><a href="#七、Spring整合mybatis" class="headerlink" title="七、Spring整合mybatis"></a>七、Spring整合mybatis</h1><h2 id="1、整合思路"><a href="#1、整合思路" class="headerlink" title="1、整合思路"></a>1、整合思路</h2><ol>
<li><p>SqlSessionFactory对象应该放入Spring容器中作为单例存在。</p>
</li>
<li><p>传统dao的开发方式中，应该从Spring容器中获取SqlSession对象。</p>
</li>
<li><p>Mapper代理形式中，应该从Spring容器中直接获得mapper对象。</p>
</li>
<li><p>数据库的链接记忆数据库连接池事务都交给spring容器来完成。</p>
</li>
</ol>
<h2 id="2、整合需要的jar包"><a href="#2、整合需要的jar包" class="headerlink" title="2、整合需要的jar包"></a>2、整合需要的jar包</h2><ol>
<li><p>Spring的jar包</p>
</li>
<li><p>mybatis的jar包</p>
</li>
<li><p>spring+mybatis的整合包</p>
</li>
<li><p>MySQL数据库驱动包</p>
</li>
<li><p>数据库连接池的jar包</p>
<p><img src="/img/mybatis-5.jpg" alt="Alt text"></p>
</li>
</ol>
<h2 id="3、整合的步骤"><a href="#3、整合的步骤" class="headerlink" title="3、整合的步骤"></a>3、整合的步骤</h2><ol>
<li><p>创建一个java工程</p>
</li>
<li><p>导入jar包</p>
</li>
<li><p>mybatis配置文件SQLMapConfig.xml</p>
</li>
<li><p>编写Spring配置文件，包括数据库连接及连接池、事务管理、SqlSessionFactory对象，配置到Spring容器中、，mapper代理对象或者dao实现类配置到Spring容器中。</p>
</li>
<li><p>编写dao或者mapper文件</p>
</li>
<li><p>测试</p>
</li>
</ol>
<h3 id="1、SqlMapConfig-xml"><a href="#1、SqlMapConfig-xml" class="headerlink" title="1、SqlMapConfig.xml"></a>1、SqlMapConfig.xml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE configuration</div><div class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</div><div class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">    &lt;!--别名--&gt;</div><div class="line">    &lt;typeAliases&gt;</div><div class="line">        &lt;!--定义单个pojo类别名 type 类的全路径名， alias别名--&gt;</div><div class="line">        &lt;typeAlias type=&quot;cn.itheima.pojo.User&quot; alias=&quot;user&quot;/&gt;</div><div class="line">        &lt;!--使用包扫描的方式数量定义别名，定以后别名等于类名，不区分大小写，建议按照Java命名规则来--&gt;</div><div class="line">        &lt;package name=&quot;cn.itheima.pojo&quot;/&gt;</div><div class="line">    &lt;/typeAliases&gt;</div><div class="line">    &lt;mappers&gt;</div><div class="line">        &lt;mapper resource=&quot;User.xml&quot;/&gt;</div><div class="line">        &lt;!--使用class属性引入接口的全路径名称，使用规则</div><div class="line">        1、接口名称和映射文件名称除了扩展名之外完全相同，</div><div class="line">        2、接口和映射文件要放在同一个目录下</div><div class="line">        --&gt;</div><div class="line">        &lt;!--&lt;mapper class=&quot;UserMapper&quot;/&gt;--&gt;</div><div class="line"></div><div class="line">        &lt;!--使用包扫描的方式批量引入Mapper接口</div><div class="line">        1、接口名称和映射文件名称除了扩展名之外完全相同，</div><div class="line">        2、接口和映射文件要放在同一个目录下--&gt;</div><div class="line">        &lt;package name=&quot;cn.itheima.mapper&quot;/&gt;</div><div class="line">    &lt;/mappers&gt;</div><div class="line"></div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
<h3 id="2、applicationContext-xml"><a href="#2、applicationContext-xml" class="headerlink" title="2、applicationContext.xml"></a>2、applicationContext.xml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</div><div class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</div><div class="line">       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</div><div class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</div><div class="line">	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd</div><div class="line">	http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd</div><div class="line">	http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.0.xsd&quot;&gt;</div><div class="line"></div><div class="line">    &lt;!-- 加载配置文件 --&gt;</div><div class="line">    &lt;context:property-placeholder location=&quot;classpath:db.properties&quot; /&gt;</div><div class="line">    &lt;!-- 数据库连接池 --&gt;</div><div class="line">    &lt;bean id=&quot;dataSource&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot; destroy-method=&quot;close&quot;&gt;</div><div class="line">        &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot; /&gt;</div><div class="line">        &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot; /&gt;</div><div class="line">        &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot; /&gt;</div><div class="line">        &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot; /&gt;</div><div class="line">        &lt;property name=&quot;maxActive&quot; value=&quot;10&quot; /&gt;</div><div class="line">        &lt;property name=&quot;maxIdle&quot; value=&quot;5&quot; /&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">    &lt;!-- mapper配置 --&gt;</div><div class="line">    &lt;!-- 让spring管理sqlsessionfactory 使用mybatis和spring整合包中的 --&gt;</div><div class="line">    &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;</div><div class="line">        &lt;!-- 数据库连接池 --&gt;</div><div class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</div><div class="line">        &lt;!-- 加载mybatis的全局配置文件 --&gt;</div><div class="line">        &lt;property name=&quot;configLocation&quot; value=&quot;classpath:SqlMapConfig.xml&quot; /&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line"></div><div class="line">    &lt;!--配置原生DAO实现--&gt;</div><div class="line">    &lt;!--&lt;bean id=&quot;userDao&quot; class=&quot;cn.itheima.dao.UserDaoImpl&quot;&gt;--&gt;</div><div class="line">        &lt;!--&lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;/&gt;--&gt;</div><div class="line">    &lt;!--&lt;/bean&gt;--&gt;</div><div class="line"></div><div class="line">    &lt;!--Mapper接口代理的实现--&gt;</div><div class="line">    &lt;!--&lt;bean id=&quot;userMapper&quot; class=&quot;org.mybatis.spring.mapper.MapperFactoryBean&quot;&gt;--&gt;</div><div class="line">        &lt;!--&amp;lt;!&amp;ndash;接口路径名&amp;ndash;&amp;gt;--&gt;</div><div class="line">        &lt;!--&lt;property name=&quot;mapperInterface&quot; value=&quot;UserMapper&quot;/&gt;--&gt;</div><div class="line">        &lt;!--&lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;/&gt;--&gt;</div><div class="line">    &lt;!--&lt;/bean&gt;--&gt;</div><div class="line"></div><div class="line">    &lt;!--使用包扫描的方式引入Mapper--&gt;</div><div class="line">    &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</div><div class="line">        &lt;!--指定要扫描的包的全路径名称，如果有多个包，用英文逗号分隔--&gt;</div><div class="line">       &lt;!--扫描后引用的时候使用类名首字母小写--&gt;</div><div class="line">        &lt;property name=&quot;basePackage&quot; value=&quot;cn.itheima.mapper&quot;/&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<h3 id="3、db-properties"><a href="#3、db-properties" class="headerlink" title="3、db.properties"></a>3、db.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">jdbc.driver=com.mysql.jdbc.Driver</div><div class="line">jdbc.url=jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8</div><div class="line">jdbc.username=root</div><div class="line">jdbc.password=linux</div></pre></td></tr></table></figure>
<h2 id="4、DAO的开发"><a href="#4、DAO的开发" class="headerlink" title="4、DAO的开发"></a>4、DAO的开发</h2><p>三种dao的实现方式：</p>
<ol>
<li><p>传统dao的开发方式</p>
</li>
<li><p>使用mapper代理形式开发方式</p>
</li>
<li><p>使用扫描包配置mapper代理</p>
</li>
</ol>
<h3 id="1、使用传统dao的开发方式"><a href="#1、使用传统dao的开发方式" class="headerlink" title="1、使用传统dao的开发方式"></a>1、使用传统dao的开发方式</h3><p>接口+实现类来完成。dao实现类需要继承SqlSessionDaoSupport.</p>
<ol>
<li><p>实现类：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.dao;</div><div class="line"></div><div class="line">import cn.itheima.pojo.User;</div><div class="line">import org.apache.ibatis.session.SqlSession;</div><div class="line">import org.mybatis.spring.support.SqlSessionDaoSupport;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class UserDaoImpl extends SqlSessionDaoSupport implements UserDao&#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public User findUserById(Integer id) &#123;</div><div class="line">        //sqlSession是线程不安全的，所以他是最佳使用范围在方法体内</div><div class="line">        SqlSession openSession = this.getSqlSession();</div><div class="line">        User user = openSession.selectOne(&quot;test.findUserById&quot;, id);</div><div class="line">        return user;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public List&lt;User&gt; findUserByUserName(String username) &#123;</div><div class="line"></div><div class="line">        SqlSession sqlSession = this.getSqlSession();</div><div class="line"></div><div class="line">        List&lt;User&gt; users = sqlSession.selectList(&quot;test.findUserByUserName&quot;, username);</div><div class="line"></div><div class="line">        return users;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>配置DAO：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!--配置原生DAO实现--&gt;</div><div class="line">&lt;bean id=&quot;userDao&quot; class=&quot;cn.itheima.dao.UserDaoImpl&quot;&gt;</div><div class="line">    &lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.test;</div><div class="line"></div><div class="line">import cn.itheima.dao.UserDao;</div><div class="line">import cn.itheima.pojo.User;</div><div class="line">import org.junit.Before;</div><div class="line">import org.junit.Test;</div><div class="line">import org.springframework.context.ApplicationContext;</div><div class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"></div><div class="line">public class UserDaoTest &#123;</div><div class="line">    private ApplicationContext applicationContext;</div><div class="line"></div><div class="line">    @Before</div><div class="line">    public void setUp() throws Exception &#123;</div><div class="line">        String configLocation = &quot;applicationContext.xml&quot;;</div><div class="line">        applicationContext = new ClassPathXmlApplicationContext(configLocation);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void testFindUserById() throws Exception &#123;</div><div class="line">        //获取DAO对象，getBean中的字符串为配置文件中声明的</div><div class="line">        UserDao userDao = (UserDao) applicationContext.getBean(&quot;userDao&quot;);</div><div class="line"></div><div class="line">        User user = userDao.findUserById(1);</div><div class="line"></div><div class="line">        System.out.println(user);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2、Mapper代理形式开发dao"><a href="#2、Mapper代理形式开发dao" class="headerlink" title="2、Mapper代理形式开发dao"></a>2、Mapper代理形式开发dao</h3><p>按照代理的要求，编写映射文件和接口，放置在同一个路径下。</p>
<ol>
<li><p>配置</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!--Mapper接口代理的实现--&gt;</div><div class="line">&lt;bean id=&quot;userMapper&quot; class=&quot;org.mybatis.spring.mapper.MapperFactoryBean&quot;&gt;</div><div class="line">    &amp;lt;!&amp;ndash;接口路径名&amp;ndash;&amp;gt;</div><div class="line">    &lt;property name=&quot;mapperInterface&quot; value=&quot;UserMapper&quot;/&gt;</div><div class="line">    &lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.test;</div><div class="line"></div><div class="line">import cn.itheima.mapper.UserMapper;</div><div class="line">import cn.itheima.pojo.User;</div><div class="line">import cn.itheima.pojo.UserExample;</div><div class="line">import org.junit.Before;</div><div class="line">import org.junit.Test;</div><div class="line">import org.springframework.context.ApplicationContext;</div><div class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class UserMapperTest &#123;</div><div class="line">    private ApplicationContext applicationContext;</div><div class="line"></div><div class="line">    @Before</div><div class="line">    public void setUp() throws Exception &#123;</div><div class="line">        String configLocation = &quot;applicationContext.xml&quot;;</div><div class="line">        applicationContext = new ClassPathXmlApplicationContext(configLocation);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">//    @Test</div><div class="line">//    public void testFindUserById() throws Exception &#123;</div><div class="line">//        //获取DAO对象，getBean中的字符串为配置文件中声明的</div><div class="line">//        UserMapper userMapper = (UserMapper) applicationContext.getBean(&quot;userMapper&quot;);</div><div class="line">//</div><div class="line">//        User user = userMapper.findUserById(1);</div><div class="line">//</div><div class="line">//        System.out.println(user);</div><div class="line">//    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void testFindUserById() throws Exception &#123;</div><div class="line">        //获取DAO对象，getBean中的字符串为配置文件中声明的</div><div class="line">        UserMapper userMapper = (UserMapper) applicationContext.getBean(&quot;userMapper&quot;);</div><div class="line"></div><div class="line">        User user = userMapper.selectByPrimaryKey(1);</div><div class="line"></div><div class="line">        System.out.println(user);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void testFindUserAndSex() throws Exception&#123;</div><div class="line">        //获取DAO对象，getBean中的字符串为配置文件中声明的</div><div class="line">        UserMapper userMapper = (UserMapper) applicationContext.getBean(&quot;userMapper&quot;);</div><div class="line"></div><div class="line">        //创建UserExample对象</div><div class="line">        UserExample userExample = new UserExample();</div><div class="line">        //创建查询条件封装对象</div><div class="line">        UserExample.Criteria criteria = userExample.createCriteria();</div><div class="line">        //输入条件</div><div class="line">        criteria.andUsernameLike(&quot;%王%&quot;);</div><div class="line">        criteria.andSexEqualTo(&quot;1&quot;);</div><div class="line"></div><div class="line">        List&lt;User&gt; user = userMapper.selectByExample(userExample);</div><div class="line"></div><div class="line">        System.out.println(user);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3、使用包扫描的方式配置mapper"><a href="#3、使用包扫描的方式配置mapper" class="headerlink" title="3、使用包扫描的方式配置mapper"></a>3、使用包扫描的方式配置mapper</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!--使用包扫描的方式引入Mapper--&gt;</div><div class="line">&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</div><div class="line">    &lt;!--指定要扫描的包的全路径名称，如果有多个包，用英文逗号分隔--&gt;</div><div class="line">   &lt;!--扫描后引用的时候使用类名首字母小写--&gt;</div><div class="line">    &lt;property name=&quot;basePackage&quot; value=&quot;cn.itheima.mapper&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<p><em>每个mapper代理对象的id就是类名首字母小写</em></p>
<h1 id="八、mybatis逆向工程"><a href="#八、mybatis逆向工程" class="headerlink" title="八、mybatis逆向工程"></a>八、mybatis逆向工程</h1><p>使用官方网站的mapper自动生成工具mybatis-generator-core-1.3.2来生成po类和mapper映射文件。</p>
<p>作用:mybatis官方提供逆向工程,可以使用它通过数据库中的表来自动生成Mapper接口和映射文件(单表增删改查)和Po类.</p>
<p>需要导入的jar包包括：</p>
<p><img src="/img/mybatis-6.jpg" alt="Alt text"></p>
<h2 id="1、mapper生成配置文件"><a href="#1、mapper生成配置文件" class="headerlink" title="1、mapper生成配置文件"></a>1、mapper生成配置文件</h2><p>在generatorConfig.xml中配置mapper生成的详细信息，需要注意：</p>
<ol>
<li><p>添加要生成的数据库表</p>
</li>
<li><p>po文件所在的包路径</p>
</li>
<li><p>mapper文件所在的包路径</p>
</li>
</ol>
<p>配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;!DOCTYPE generatorConfiguration</div><div class="line">        PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</div><div class="line">        &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;</div><div class="line"></div><div class="line">&lt;generatorConfiguration&gt;</div><div class="line">    &lt;context id=&quot;testTables&quot; targetRuntime=&quot;MyBatis3&quot;&gt;</div><div class="line">        &lt;commentGenerator&gt;</div><div class="line">            &lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</div><div class="line">            &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot; /&gt;</div><div class="line">        &lt;/commentGenerator&gt;</div><div class="line">        &lt;!--数据库连接的信息：驱动类、连接地址、用户名、密码 --&gt;</div><div class="line">        &lt;jdbcConnection driverClass=&quot;com.mysql.jdbc.Driver&quot;</div><div class="line">                        connectionURL=&quot;jdbc:mysql://localhost:3306/springmvc&quot; userId=&quot;root&quot;</div><div class="line">                        password=&quot;linux&quot;&gt;</div><div class="line">        &lt;/jdbcConnection&gt;</div><div class="line">        &lt;!-- &lt;jdbcConnection driverClass=&quot;oracle.jdbc.OracleDriver&quot;</div><div class="line">            connectionURL=&quot;jdbc:oracle:thin:@127.0.0.1:1521:yycg&quot;</div><div class="line">            userId=&quot;yycg&quot;</div><div class="line">            password=&quot;yycg&quot;&gt;</div><div class="line">        &lt;/jdbcConnection&gt; --&gt;</div><div class="line"></div><div class="line">        &lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为 Integer，为 true时把JDBC DECIMAL 和</div><div class="line">            NUMERIC 类型解析为java.math.BigDecimal --&gt;</div><div class="line">        &lt;javaTypeResolver&gt;</div><div class="line">            &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot; /&gt;</div><div class="line">        &lt;/javaTypeResolver&gt;</div><div class="line"></div><div class="line">        &lt;!-- targetProject:生成PO类的位置 --&gt;</div><div class="line">        &lt;javaModelGenerator targetPackage=&quot;cn.itheima.pojo&quot;</div><div class="line">                            targetProject=&quot;.\src&quot;&gt;</div><div class="line">            &lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</div><div class="line">            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;</div><div class="line">            &lt;!-- 从数据库返回的值被清理前后的空格 --&gt;</div><div class="line">            &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot; /&gt;</div><div class="line">        &lt;/javaModelGenerator&gt;</div><div class="line">        &lt;!-- targetProject:mapper映射文件生成的位置 --&gt;</div><div class="line">        &lt;sqlMapGenerator targetPackage=&quot;cn.itheima.dao&quot;</div><div class="line">                         targetProject=&quot;.\src&quot;&gt;</div><div class="line">            &lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</div><div class="line">            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;</div><div class="line">        &lt;/sqlMapGenerator&gt;</div><div class="line">        &lt;!-- targetPackage：mapper接口生成的位置 --&gt;</div><div class="line">        &lt;javaClientGenerator type=&quot;XMLMAPPER&quot;</div><div class="line">                             targetPackage=&quot;cn.itheima.dao&quot;</div><div class="line">                             targetProject=&quot;.\src&quot;&gt;</div><div class="line">            &lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</div><div class="line">            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;</div><div class="line">        &lt;/javaClientGenerator&gt;</div><div class="line">        &lt;!-- 指定数据库表 --&gt;</div><div class="line">        &lt;table tableName=&quot;items&quot;&gt;&lt;/table&gt;</div><div class="line">        &lt;!--&lt;table tableName=&quot;orders&quot;&gt;&lt;/table&gt;--&gt;</div><div class="line">        &lt;!--&lt;table tableName=&quot;orderdetail&quot;&gt;&lt;/table&gt;--&gt;</div><div class="line">        &lt;table tableName=&quot;user&quot;&gt;&lt;/table&gt;</div><div class="line">        &lt;!-- &lt;table schema=&quot;&quot; tableName=&quot;sys_user&quot;&gt;&lt;/table&gt;</div><div class="line">        &lt;table schema=&quot;&quot; tableName=&quot;sys_role&quot;&gt;&lt;/table&gt;</div><div class="line">        &lt;table schema=&quot;&quot; tableName=&quot;sys_permission&quot;&gt;&lt;/table&gt;</div><div class="line">        &lt;table schema=&quot;&quot; tableName=&quot;sys_user_role&quot;&gt;&lt;/table&gt;</div><div class="line">        &lt;table schema=&quot;&quot; tableName=&quot;sys_role_permission&quot;&gt;&lt;/table&gt; --&gt;</div><div class="line"></div><div class="line">        &lt;!-- 有些表的字段需要指定java类型</div><div class="line">         &lt;table schema=&quot;&quot; tableName=&quot;&quot;&gt;</div><div class="line">            &lt;columnOverride column=&quot;&quot; javaType=&quot;&quot; /&gt;</div><div class="line">        &lt;/table&gt; --&gt;</div><div class="line">    &lt;/context&gt;</div><div class="line">&lt;/generatorConfiguration&gt;</div></pre></td></tr></table></figure>
<h2 id="2、使用java类生成mapper文件"><a href="#2、使用java类生成mapper文件" class="headerlink" title="2、使用java类生成mapper文件"></a>2、使用java类生成mapper文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">import org.mybatis.generator.api.MyBatisGenerator;</div><div class="line">import org.mybatis.generator.config.Configuration;</div><div class="line">import org.mybatis.generator.config.xml.ConfigurationParser;</div><div class="line">import org.mybatis.generator.internal.DefaultShellCallback;</div><div class="line"></div><div class="line">import java.io.File;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class StartServer &#123;</div><div class="line"></div><div class="line">    public void generator() throws Exception&#123;</div><div class="line">        List&lt;String&gt; warnings = new ArrayList&lt;String&gt;();</div><div class="line">        boolean overwrite = true;</div><div class="line">        File configFile = new File(&quot;generator.xml&quot;);</div><div class="line">        ConfigurationParser cp = new ConfigurationParser(warnings);</div><div class="line">        Configuration config = cp.parseConfiguration(configFile);</div><div class="line">        DefaultShellCallback callback = new DefaultShellCallback(overwrite);</div><div class="line">        MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config,</div><div class="line">                callback, warnings);</div><div class="line">        myBatisGenerator.generate(null);</div><div class="line">    &#125;</div><div class="line">    public static void main(String[] args) throws Exception &#123;</div><div class="line">        try &#123;</div><div class="line">            StartServer startServer = new StartServer();</div><div class="line">            startServer.generator();</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3、将生成的mapper文件拷贝到指定目录"><a href="#3、将生成的mapper文件拷贝到指定目录" class="headerlink" title="3、将生成的mapper文件拷贝到指定目录"></a>3、将生成的mapper文件拷贝到指定目录</h2><p><em>注意：mapper xml文件和mapper.java文件在一个目录内且文件名相同。</em></p>
<h2 id="4、测试mapper接口"><a href="#4、测试mapper接口" class="headerlink" title="4、测试mapper接口"></a>4、测试mapper接口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">package cn.itheima.dao;</div><div class="line"></div><div class="line">import cn.itheima.pojo.Items;</div><div class="line">import cn.itheima.pojo.ItemsExample;</div><div class="line">import java.util.List;</div><div class="line">import org.apache.ibatis.annotations.Param;</div><div class="line"></div><div class="line">public interface ItemsMapper &#123;</div><div class="line">    int countByExample(ItemsExample example);</div><div class="line"></div><div class="line">    int deleteByExample(ItemsExample example);</div><div class="line"></div><div class="line">    int deleteByPrimaryKey(Integer id);</div><div class="line"></div><div class="line">    int insert(Items record);</div><div class="line"></div><div class="line">    int insertSelective(Items record);</div><div class="line"></div><div class="line">    List&lt;Items&gt; selectByExampleWithBLOBs(ItemsExample example);</div><div class="line"></div><div class="line">    List&lt;Items&gt; selectByExample(ItemsExample example);</div><div class="line"></div><div class="line">    Items selectByPrimaryKey(Integer id);</div><div class="line"></div><div class="line">    int updateByExampleSelective(@Param(&quot;record&quot;) Items record, @Param(&quot;example&quot;) ItemsExample example);</div><div class="line"></div><div class="line">    int updateByExampleWithBLOBs(@Param(&quot;record&quot;) Items record, @Param(&quot;example&quot;) ItemsExample example);</div><div class="line"></div><div class="line">    int updateByExample(@Param(&quot;record&quot;) Items record, @Param(&quot;example&quot;) ItemsExample example);</div><div class="line"></div><div class="line">    int updateByPrimaryKeySelective(Items record);</div><div class="line"></div><div class="line">    int updateByPrimaryKeyWithBLOBs(Items record);</div><div class="line"></div><div class="line">    int updateByPrimaryKey(Items record);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="5、注意事项"><a href="#5、注意事项" class="headerlink" title="5、注意事项"></a>5、注意事项</h2><ol>
<li><p>Mapper文件内容时追加不是覆盖。所以XXXMapper.xml文件已经存在时，如果进行重新生成则mapper.xml文件内容不被覆盖而是进行内容追加，结果导致mybatis解析失败。<br><em>解决方法：删除原来已经生成的mapper xml文件再进行生成。Mybatis自动生成的po及mapper.java文件不是内容而是直接覆盖没有此问题。</em></p>
</li>
<li><p>Table Schema问题：</p>
</li>
</ol>
<p>下边是关于针对oracle数据库表生成代码的schema问题：</p>
<p>Schma即数据库模式，oracle中一个用户对应一个schema，可以理解为用户就是schema。<br>当Oralce数据库存在多个schema可以访问相同的表名时，使用mybatis生成该表的mapper.xml将会出现mapper.xml内容重复的问题，结果导致mybatis解析错误。<br>解决方法：在table中填写schema，如下：</p>
<p><table schema="XXXX" tablename=" "><br>XXXX即为一个schema的名称，生成后将mapper.xml的schema前缀批量去掉，如果不去掉当oracle用户变更了sql语句将查询失败。<br>快捷操作方式：mapper.xml文件中批量替换：“from XXXX.”为空</table></p>
<p>Oracle查询对象的schema可从dba_objects中查询，如下：<br>select * from dba_objects</p>
<h1 id="九、总结"><a href="#九、总结" class="headerlink" title="九、总结"></a>九、总结</h1><ol>
<li><p>mybatis是一个持久层框架, 作用是跟数据库交互完成增删改查</p>
</li>
<li><p>原生Dao实现(需要接口和实现类)</p>
</li>
<li><p>动态代理方式(只需要接口)<br>  mapper接口代理实现编写规则:</p>
<ol>
<li>映射文件中namespace要等于接口的全路径名称</li>
<li>映射文件中sql语句id要等于接口的方法名称</li>
<li>映射文件中传入参数类型要等于接口方法的传入参数类型</li>
<li>映射文件中返回结果集类型要等于接口方法的返回值类型</li>
</ol>
</li>
<li><p>#{}占位符:占位<br> 如果传入的是基本类型,那么#{}中的变量名称可以随意写<br> 如果传入的参数是pojo类型,那么#{}中的变量名称必须是pojo中的属性.属性.属性…</p>
</li>
<li><p>${}拼接符:字符串原样拼接<br> 如果传入的是基本类型,那么${}中的变量名必须是value<br> 如果传入的参数是pojo类型,那么${}中的变量名称必须是pojo中的属性.属性.属性…<br> 注意:使用拼接符有可能造成sql注入,在页面输入的时候可以加入校验,不可输入sql关键字,不可输入空格</p>
</li>
<li><p>映射文件:</p>
<ol>
<li>传入参数类型通过parameterType属性指定</li>
<li>返回结果集类型通过resultType属性指定</li>
</ol>
</li>
<li><p>hibernate和mybatis区别:</p>
<ul>
<li>hibernate:它是一个标准的orm框架,比较重量级,学习成本高.<br>  优点:高度封装,使用起来不用写sql,开发的时候,会减低开发周期.<br>  缺点:sql语句无法优化<br>  应用场景:oa(办公自动化系统), erp(企业的流程系统)等,还有一些政府项目,<pre><code>总的来说,在用于量不大,并发量小的时候使用.
</code></pre></li>
<li>mybatis:它不是一个orm框架, 它是对jdbc的轻量级封装, 学习成本低,比较简单<br>  有点:学习成本低, sql语句可以优化, 执行效率高,速度快<br>  缺点:编码量较大,会拖慢开发周期<br>  应用场景: 互联网项目,比如电商,P2p等<pre><code>总的来说是用户量较大,并发高的项目.
</code></pre></li>
</ul>
</li>
<li><p>输入映射(就是映射文件中可以传入哪些参数类型)</p>
<ul>
<li>1)基本类型<ul>
<li>2)pojo类型</li>
<li>3)Vo类型</li>
</ul>
</li>
</ul>
</li>
<li><p>输出映射(返回的结果集可以有哪些类型)</p>
<ul>
<li>1)基本类型</li>
<li>2)pojo类型</li>
<li>3)List类型</li>
</ul>
</li>
<li><p>动态sql:动态的拼接sql语句,因为sql中where条件有可能多也有可能少</p>
<ul>
<li>1)where:可以自动添加where关键字,还可以去掉第一个条件的and关键字</li>
<li>2)if:判断传入的参数是否为空</li>
<li>3)foreach:循环遍历传入的集合参数</li>
<li>4)sql:封装查询条件,以达到重用的目的</li>
</ul>
</li>
<li><p>对单个对象的映射关系:</p>
<ul>
<li>1)自动关联(偷懒的办法):可以自定义一个大而全的pojo类,然后自动映射其实是根据数据库总的字段名称和pojo中的属性名称对应.</li>
<li>2)手动关联: 需要指定数据库中表的字段名称和java的pojo类中的属性名称的对应关系.使用association标签</li>
</ul>
</li>
<li><p>对集合对象的映射关系<br>  只能使用手动映射:指定表中字段名称和pojo中属性名称的对应关系使用collection标签</p>
</li>
<li><p>spring和mybatis整合<br>  整合后会话工厂都归spring管理</p>
<pre><code>*     1)原生Dao实现:
         需要在spring配置文件中指定dao实现类
         dao实现类需要继承SqlSessionDaoSupport超类
         在dao实现类中不要手动关闭会话,不要自己提交事务.
*     2)Mapper接口代理实现:
         在spring配置文件中可以使用包扫描的方式,一次性的将所有mapper加载
</code></pre></li>
<li><p>逆向工程:自动生成Pojo类,还可以自动生成Mapper接口和映射文件</p>
<pre><code>注意:生成的方式是追加而不是覆盖,所以不可以重复生成,重复生成的文件有问题.
    如果想重复生成将原来生成的文件删除
</code></pre></li>
</ol>
<blockquote>
<p>概念区分：</p>
<ol>
<li>pojo:不按mvc分层,只是java bean有一些属性,还有get set方法</li>
<li>domain:不按mvc分层,只是java bean有一些属性,还有get set方法</li>
<li>po:用在持久层,还可以再增加或者修改的时候,从页面直接传入action中,它里面的java bean 类名等于表名,<br> 属性名等于表的字段名,还有对应的get set方法</li>
<li>vo: view object表现层对象,主要用于在高级查询中从页面接收传过来的各种参数.好处是扩展性强</li>
<li>bo: 用在servie层,现在企业基本不用.</li>
</ol>
</blockquote>
<p>这些po,vo, bo,pojo可以用在各种层面吗?</p>
<p>可以,也就是po用在表现层,vo用在持久层不报错,因为都是普通的java bean没有语法错误.<br>但是在企业最好不要混着用,因为这些都是设计的原则,混着用比较乱.不利于代码维护.</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Donate comment here</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="cdx 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="cdx 支付宝"/>
        <p>支付宝</p>
      </div>
    

    
      <div id="bitcoin" style="display: inline-block">
        <img id="bitcoin_qr" src="/images/bitcoin.png" alt="cdx 比特币"/>
        <p>比特币</p>
      </div>
    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Java/" rel="tag"># Java</a>
          
            <a href="/tags/mybatis/" rel="tag"># mybatis</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/22/Spring_Data/" rel="next" title="Spring Data">
                <i class="fa fa-chevron-left"></i> Spring Data
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image"
              src="/images/avatar.gif"
              alt="cdx" />
          
            <p class="site-author-name" itemprop="name">cdx</p>
            <p class="site-description motion-element" itemprop="description">Be a better man!</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cdx0312" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>GitHub</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:cdxu0312@outlook.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一、mybatis简介"><span class="nav-number">1.</span> <span class="nav-text">一、mybatis简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、mybatis入门"><span class="nav-number">2.</span> <span class="nav-text">二、mybatis入门</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、使用jdbc操作数据库存在的问题"><span class="nav-number">2.1.</span> <span class="nav-text">1、使用jdbc操作数据库存在的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、mybatis架构"><span class="nav-number">2.2.</span> <span class="nav-text">2、mybatis架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、mybatis的入门程序"><span class="nav-number">2.3.</span> <span class="nav-text">3、mybatis的入门程序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、mybatis下载"><span class="nav-number">2.3.1.</span> <span class="nav-text">1、mybatis下载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、实现的功能"><span class="nav-number">2.3.2.</span> <span class="nav-text">2、实现的功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、工程搭建"><span class="nav-number">2.3.3.</span> <span class="nav-text">3、工程搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、根据id查询用户信息"><span class="nav-number">2.3.4.</span> <span class="nav-text">4、根据id查询用户信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、根据用户名查询用户信息"><span class="nav-number">2.3.5.</span> <span class="nav-text">5、根据用户名查询用户信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、概念比较"><span class="nav-number">2.3.6.</span> <span class="nav-text">6、概念比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、添加用户"><span class="nav-number">2.3.7.</span> <span class="nav-text">7、添加用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、删除用户"><span class="nav-number">2.3.8.</span> <span class="nav-text">8、删除用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、修改用户"><span class="nav-number">2.3.9.</span> <span class="nav-text">9、修改用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、mybatis解决jdbc编程的问题"><span class="nav-number">2.3.10.</span> <span class="nav-text">10、mybatis解决jdbc编程的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11、mybatis和hibernate的区别"><span class="nav-number">2.3.11.</span> <span class="nav-text">11、mybatis和hibernate的区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、DAO的开发方法"><span class="nav-number">3.</span> <span class="nav-text">三、DAO的开发方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、需求"><span class="nav-number">3.1.</span> <span class="nav-text">1、需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、SqlSession的使用范围"><span class="nav-number">3.2.</span> <span class="nav-text">2、SqlSession的使用范围</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、原始DAO开发方式（需要编写接口和实现类）"><span class="nav-number">3.3.</span> <span class="nav-text">3、原始DAO开发方式（需要编写接口和实现类）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、动态代理方法"><span class="nav-number">3.4.</span> <span class="nav-text">4、动态代理方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、开发规范"><span class="nav-number">3.4.1.</span> <span class="nav-text">1、开发规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、Mapper-xml（映射文件）"><span class="nav-number">3.4.2.</span> <span class="nav-text">2、Mapper.xml（映射文件）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、Mapper-java（接口文件）"><span class="nav-number">3.4.3.</span> <span class="nav-text">3、Mapper.java（接口文件）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、在SQLMapConfig-xml中配置映射文件"><span class="nav-number">3.4.4.</span> <span class="nav-text">4、在SQLMapConfig.xml中配置映射文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、测试"><span class="nav-number">3.4.5.</span> <span class="nav-text">5、测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、小结"><span class="nav-number">3.4.6.</span> <span class="nav-text">6、小结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、SqlMapConfig-xml文件说明"><span class="nav-number">4.</span> <span class="nav-text">四、SqlMapConfig.xml文件说明</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、配置内容："><span class="nav-number">4.1.</span> <span class="nav-text">1、配置内容：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、properties-属性"><span class="nav-number">4.2.</span> <span class="nav-text">2、properties(属性)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、typeAliases-类型别名"><span class="nav-number">4.3.</span> <span class="nav-text">3、typeAliases(类型别名)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、mybatis支持别名："><span class="nav-number">4.3.1.</span> <span class="nav-text">1、mybatis支持别名：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、自定义别名：在SqlMapConfig-xml中配置："><span class="nav-number">4.3.2.</span> <span class="nav-text">2、自定义别名：在SqlMapConfig.xml中配置：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、Mappers-映射器"><span class="nav-number">4.4.</span> <span class="nav-text">4、Mappers(映射器)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、传递pojo包装类内容-输入类型的一种"><span class="nav-number">4.5.</span> <span class="nav-text">5、传递pojo包装类内容(输入类型的一种)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、resultType-输出类型"><span class="nav-number">4.6.</span> <span class="nav-text">6、resultType(输出类型)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、输出简单类型"><span class="nav-number">4.6.1.</span> <span class="nav-text">1、输出简单类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、输出pojo对象或者pojo对象列表"><span class="nav-number">4.6.2.</span> <span class="nav-text">2、输出pojo对象或者pojo对象列表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、resultMap"><span class="nav-number">4.7.</span> <span class="nav-text">7、resultMap</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五-动态sql"><span class="nav-number">5.</span> <span class="nav-text">五 动态sql</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、if"><span class="nav-number">5.1.</span> <span class="nav-text">1、if</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、where"><span class="nav-number">5.2.</span> <span class="nav-text">2、where</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、foreach"><span class="nav-number">5.3.</span> <span class="nav-text">3、foreach</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、sql片段"><span class="nav-number">5.4.</span> <span class="nav-text">4、sql片段</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六-关联查询"><span class="nav-number">6.</span> <span class="nav-text">六 关联查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、商品订单数据模型"><span class="nav-number">6.1.</span> <span class="nav-text">1、商品订单数据模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、一对一关联"><span class="nav-number">6.2.</span> <span class="nav-text">2、一对一关联</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方法一：使用resultType，定义订单信息po类，此po类中包括了订单信息和用户信息。"><span class="nav-number">6.2.1.</span> <span class="nav-text">方法一：使用resultType，定义订单信息po类，此po类中包括了订单信息和用户信息。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法二：使用resultMap，定义专门的resultMap用于映射一对一查询"><span class="nav-number">6.2.2.</span> <span class="nav-text">方法二：使用resultMap，定义专门的resultMap用于映射一对一查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、一对多查询"><span class="nav-number">6.3.</span> <span class="nav-text">3、一对多查询</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七、Spring整合mybatis"><span class="nav-number">7.</span> <span class="nav-text">七、Spring整合mybatis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、整合思路"><span class="nav-number">7.1.</span> <span class="nav-text">1、整合思路</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、整合需要的jar包"><span class="nav-number">7.2.</span> <span class="nav-text">2、整合需要的jar包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、整合的步骤"><span class="nav-number">7.3.</span> <span class="nav-text">3、整合的步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、SqlMapConfig-xml"><span class="nav-number">7.3.1.</span> <span class="nav-text">1、SqlMapConfig.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、applicationContext-xml"><span class="nav-number">7.3.2.</span> <span class="nav-text">2、applicationContext.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、db-properties"><span class="nav-number">7.3.3.</span> <span class="nav-text">3、db.properties</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、DAO的开发"><span class="nav-number">7.4.</span> <span class="nav-text">4、DAO的开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、使用传统dao的开发方式"><span class="nav-number">7.4.1.</span> <span class="nav-text">1、使用传统dao的开发方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、Mapper代理形式开发dao"><span class="nav-number">7.4.2.</span> <span class="nav-text">2、Mapper代理形式开发dao</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、使用包扫描的方式配置mapper"><span class="nav-number">7.4.3.</span> <span class="nav-text">3、使用包扫描的方式配置mapper</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#八、mybatis逆向工程"><span class="nav-number">8.</span> <span class="nav-text">八、mybatis逆向工程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、mapper生成配置文件"><span class="nav-number">8.1.</span> <span class="nav-text">1、mapper生成配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、使用java类生成mapper文件"><span class="nav-number">8.2.</span> <span class="nav-text">2、使用java类生成mapper文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、将生成的mapper文件拷贝到指定目录"><span class="nav-number">8.3.</span> <span class="nav-text">3、将生成的mapper文件拷贝到指定目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、测试mapper接口"><span class="nav-number">8.4.</span> <span class="nav-text">4、测试mapper接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、注意事项"><span class="nav-number">8.5.</span> <span class="nav-text">5、注意事项</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#九、总结"><span class="nav-number">9.</span> <span class="nav-text">九、总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cdx</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
