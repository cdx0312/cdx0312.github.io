<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-struts2总结 五--interceptor拦截器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/07/struts2总结 五--interceptor拦截器/" class="article-date">
  <time datetime="2017-09-07T06:51:07.254Z" itemprop="datePublished">2017-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/07/struts2总结 五--interceptor拦截器/">struts2总结（五）--intercept</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="8-拦截器-intercept"><a href="#8-拦截器-intercept" class="headerlink" title="8 拦截器(intercept)"></a>8 拦截器(intercept)</h2><h3 id="8-1-Struts架构图"><a href="#8-1-Struts架构图" class="headerlink" title="8.1 Struts架构图"></a>8.1 Struts架构图</h3><p>  <img src="/img/struts_arch.jpg" alt="Alt text"></p>
<h3 id="8-2-Struts执行过程分析"><a href="#8-2-Struts执行过程分析" class="headerlink" title="8.2 Struts执行过程分析"></a>8.2 Struts执行过程分析</h3><p><img src="/img/struts.png" alt="Alt text"></p>
<blockquote>
<ul>
<li>拦截器：拦截器是struts2框架中提供的一种Java类</li>
<li>作用：<pre><code>* 可以拦截访问Action的请求
* 给这个Action加上新的丰富功能（上传，参数自动接收，类型自动转换等）需要配置之后，指明哪一个拦截器去拦截哪一个Action或者哪一些Action，这个拦截器才会去拦截我们的Action。
</code></pre></li>
<li>拦截器工作原理：<pre><code>1. 有一个拦截器的类（框架的或者自定义的）
2. 在配置文件中把这个拦截器类配置出来
3. 指明这个拦截器要拦截哪一个或者哪一些action
4. 客户端发送一个请求访问一个被拦截器拦截的Action
5. 这个请求首先会被struts2 的filter所拦截，filter会检查这个请求是不是请求的Action，如果是，会再检查这个Action有没有被定义的拦截器所拦截，如果有，那么把这个请求交给拦截器去处理
</code></pre></li>
</ul>
</blockquote>
<h3 id="8-3-Interceptor拦截器过程模拟"><a href="#8-3-Interceptor拦截器过程模拟" class="headerlink" title="8.3  Interceptor拦截器过程模拟"></a>8.3  Interceptor拦截器过程模拟</h3><ul>
<li>定义一个Interceptor接口，有一个intercept方法。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public interface Inteceptor &#123;</div><div class="line">    public void intercept(ActionInvocation actionInvocation);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>创建两个interceptor实现了interceptor接口：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public class FirstInterceptor implements Inteceptor&#123;</div><div class="line">    @Override</div><div class="line">    public void intercept(ActionInvocation actionInvocation) &#123;</div><div class="line">        System.out.println(1);</div><div class="line">        actionInvocation.invoke();</div><div class="line">        System.out.println(-1);</div><div class="line">      &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public class SecondInterceptor implements Inteceptor&#123;</div><div class="line">    @Override</div><div class="line">    public void intercept(ActionInvocation actionInvocation) &#123;</div><div class="line">        System.out.println(2);</div><div class="line">        actionInvocation.invoke();</div><div class="line">        System.out.println(-2);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>定义一个Action</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public class SecondInterceptor implements Inteceptor&#123;</div><div class="line">    @Override</div><div class="line">    public void intercept(ActionInvocation actionInvocation) &#123;</div><div class="line">        System.out.println(2);</div><div class="line">        actionInvocation.invoke();</div><div class="line">        System.out.println(-2);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>定义ActionInvocation</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">public class ActionInvocation &#123;</div><div class="line">    List&lt;Inteceptor&gt; inteceptors = new ArrayList&lt;&gt;();</div><div class="line">    int index = -1;</div><div class="line">    Action a = new Action();</div><div class="line"></div><div class="line">    public ActionInvocation() &#123;</div><div class="line">        this.inteceptors.add(new FirstInterceptor());</div><div class="line">        this.inteceptors.add(new SecondInterceptor());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void invoke() &#123;</div><div class="line">        index++;</div><div class="line">        if (index &gt;= this.inteceptors.size()) &#123;</div><div class="line">            a.execute();</div><div class="line">        &#125; else &#123;</div><div class="line">            this.inteceptors.get(index).intercept(this);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>执行main文件:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public class Main &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        new ActionInvocation().invoke();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>运行结果为：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">2</div><div class="line">execute</div><div class="line">-2</div><div class="line">-1</div></pre></td></tr></table></figure>
<blockquote>
<p>从而执行顺序为，首先main函数，创建ActionInvocation对象，初始化的时候讲两个Inteceptor加到interceptors这个列表中，调用其invoke()方法，当还有interceptor没有访问时，调用第一个interceptor的intercept方法，输出1，并调用ActionInvocation的invoke方法，此时会调用第二个Inteceptor的intercept方法，输出2，并调用ActionInvocation的invoke方法，此时不存在拦截器，执行Action输出execute，后面依次输出-2 -1， 完成这个模拟过程！</p>
</blockquote>
<h3 id="8-4-定义自己的拦截器"><a href="#8-4-定义自己的拦截器" class="headerlink" title="8.4 定义自己的拦截器"></a>8.4 定义自己的拦截器</h3><ul>
<li><p>struts2框架已经写好了很多个拦截器，同时也把这些拦截器配置在配置文件里面struts-default.xml中，除此之外，我们可以写自己的拦截器</p>
</li>
<li><p>首先实现一个Interceptor接口：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">public class MyInterceptor implements Interceptor &#123;</div><div class="line"></div><div class="line">	public void destroy() &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void init() &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public String intercept(ActionInvocation invocation) throws Exception &#123;</div><div class="line">		long start = System.currentTimeMillis();</div><div class="line">		String r = invocation.invoke();</div><div class="line">		long end = System.currentTimeMillis();</div><div class="line">		System.out.println(&quot;action time = &quot; + (end - start));</div><div class="line">		return r;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>然后在struts.xml文件中配置出这个拦截器：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;package name=&quot;test&quot; namespace=&quot;/&quot; extends=&quot;struts-default&quot;&gt;</div><div class="line">		&lt;interceptors&gt;</div><div class="line">			&lt;interceptor name=&quot;my&quot; class=&quot;com.interceptor.MyInterceptor&quot;&gt;&lt;/interceptor&gt;</div><div class="line">		&lt;/interceptors&gt;</div><div class="line"></div><div class="line">		&lt;action name=&quot;test&quot; class=&quot;com.action.TestAction&quot;&gt;</div><div class="line">			&lt;result&gt;/test.jsp&lt;/result&gt;</div><div class="line">			&lt;interceptor-ref name=&quot;my&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">			&lt;interceptor-ref name=&quot;defaultStack&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">		&lt;/action&gt;</div><div class="line"></div><div class="line">	&lt;/package&gt;</div></pre></td></tr></table></figure>
<h3 id="8-5-拦截器栈"><a href="#8-5-拦截器栈" class="headerlink" title="8.5 拦截器栈"></a>8.5 拦截器栈</h3><p>当一个Action需要被多个拦截器拦截的时候，正常情况下我们需要在这个Action中去引用要使用的多个拦截器，但是我们可以使用一个拦截器栈去包含那几个拦截器，然后直接在Action中引用这个拦截器栈就可以。</p>
<ul>
<li>一个拦截器栈可以包含多个拦截器</li>
<li>一个拦截器栈还可以包含其他拦截器栈</li>
<li>定义拦截器栈都要在<interceptors>标签中</interceptors></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;interceptors&gt;</div><div class="line">   &lt;interceptor name=&quot;myInterceptor&quot; class=&quot;com.interceptor.MyInterceptor&quot;&gt;&lt;/interceptor&gt;</div><div class="line">   &lt;interceptor-stack name=&quot;myStack&quot;&gt;</div><div class="line">   &lt;!-- 这是我们自己定义的一个拦截器 --&gt;</div><div class="line">      &lt;interceptor-ref name=&quot;myInterceptor&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">     &lt;!-- 这是struts-default.xml文件中定义的一个拦截器 --&gt;</div><div class="line">      &lt;interceptor-ref name=&quot;params&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">     &lt;!-- 这是struts-default.xml文件中定义的一个拦截器栈 --&gt;</div><div class="line">    &lt;interceptor-ref name=&quot;basicStack&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">   &lt;/interceptor-stack&gt;</div><div class="line">  &lt;/interceptors&gt;</div></pre></td></tr></table></figure>
<h3 id="8-6-默认拦截器栈-拦截器"><a href="#8-6-默认拦截器栈-拦截器" class="headerlink" title="8.6 默认拦截器栈/拦截器"></a>8.6 默认拦截器栈/拦截器</h3><p>在一个package中，我们可以把一个拦截器或者拦截器栈的声明为一个默认的拦截器/拦截器栈。以后这个package中所有的Action都会被这个默认的拦截器/拦截器栈所拦截</p>
<ul>
<li>我们写的任何Action都会被一个叫做defaultStack的拦截器栈所拦截，这个拦截器栈包含了十几个拦截器，这些拦截器给我们的Action提供了很多丰富的功能，因为我们写的所有的package都是直接或者间接继承了struts-default.xml文件中的一个名字叫struts-default的package， struts-default包中又把名字叫做defaultStack的拦截器栈配置成了一个默认的拦截器栈，我们的package继承了这个，所有的Action都会被defaultStack所拦截。</li>
<li>但是如果我们指明了一个Action被我们所写的一个拦截器/拦截器栈所拦截，name这个Action就不会被defaultStack拦截了，所以我们需要在Action中主动的在声明这个Action被defaultStack所拦截，或者把defaultStack加入到我们自己定义的拦截器栈里面。</li>
<li>也可以专门定义一个package专门定义拦截器，拦截器栈，其他package继承这个拦截器栈package：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 在这个package中,我们只定义拦截器/拦截器栈 --&gt;</div><div class="line">    &lt;package name=&quot;MyInter&quot; extends=&quot;struts-default&quot; namespace=&quot;/&quot;&gt;</div><div class="line"></div><div class="line">    &lt;interceptors&gt;</div><div class="line">        &lt;interceptor name=&quot;myInterceptor&quot; class=&quot;com.briup.web.interceptor.MyInterceptor&quot;&gt;&lt;/interceptor&gt;</div><div class="line">        &lt;interceptor-stack name=&quot;myStack&quot;&gt;</div><div class="line">            &lt;interceptor-ref name=&quot;myInterceptor&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">            &lt;!-- 这是struts-default.xml文件中定义的一个拦截器栈 --&gt;</div><div class="line">            &lt;interceptor-ref name=&quot;defaultStack&quot;&gt;&lt;/interceptor-ref&gt;</div><div class="line">        &lt;/interceptor-stack&gt;</div><div class="line">    &lt;/interceptors&gt;</div><div class="line"></div><div class="line">    &lt;!-- 声明默认拦截器/拦截器栈 --&gt;</div><div class="line">    &lt;!-- 当前包中所有的action都会被这个myStack所拦截器 --&gt;</div><div class="line">    &lt;!-- 继承了当前包的其他包里面的所有action也会被这个myStack所拦截器 --&gt;</div><div class="line">    &lt;default-interceptor-ref name=&quot;myStack&quot;&gt;&lt;/default-interceptor-ref&gt;</div><div class="line"></div><div class="line">    &lt;/package&gt;</div></pre></td></tr></table></figure>
<h3 id="8-7-类型转换"><a href="#8-7-类型转换" class="headerlink" title="8.7 类型转换"></a>8.7 类型转换</h3><p>类型转换：解析HTTP请求参数，将HTTP请求参数赋值给Action属性，当其类型不一致时进行的类型转换操作。struts2完成了String和基本类型的类型转换，只要Action属性有get set 方法。同时其还支持自定义的类型转换。</p>
<p>struts2类型转换时通过Params拦截器进行转换的；如果转换失败，则conversionError拦截器拦截该异常，并封装到fieldError中，放入ActionContext中。</p>
<h4 id="8-7-1-基础类型转换："><a href="#8-7-1-基础类型转换：" class="headerlink" title="8.7.1 基础类型转换："></a>8.7.1 基础类型转换：</h4><p>testAction：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">public class TestAction extends ActionSupport&#123;</div><div class="line">    private String name;</div><div class="line">    private int age;</div><div class="line">    private Date d;</div><div class="line">    Set&lt;String&gt; interests;</div><div class="line">    Map&lt;String, String&gt; users;</div><div class="line"></div><div class="line">    public String getName() &#123;</div><div class="line">        return name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setName(String name) &#123;</div><div class="line">        this.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public int getAge() &#123;</div><div class="line">        return age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setAge(int age) &#123;</div><div class="line">        this.age = age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Date getD() &#123;</div><div class="line">        return d;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setD(Date d) &#123;</div><div class="line">        this.d = d;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Set&lt;String&gt; getInterests() &#123;</div><div class="line">        return interests;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setInterests(Set&lt;String&gt; interests) &#123;</div><div class="line">        this.interests = interests;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Map&lt;String, String&gt; getUsers() &#123;</div><div class="line">        return users;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setUsers(Map&lt;String, String&gt; users) &#123;</div><div class="line">        this.users = users;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String execute() throws Exception &#123;</div><div class="line">        return super.execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>test.jsp:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">name:&lt;s:property value=&quot;name&quot;/&gt;&lt;br/&gt;</div><div class="line">age:&lt;s:property value=&quot;age&quot;/&gt;&lt;br/&gt;</div><div class="line">date:&lt;s:property value=&quot;d&quot;/&gt;&lt;br/&gt;</div><div class="line">&lt;s:date name=&quot;d&quot; format=&quot;yyyy/MM/dd HH:mm:ss&quot;/&gt;&lt;br/&gt;</div><div class="line">&lt;s:property value=&quot;interests&quot;/&gt;&lt;br/&gt;</div><div class="line">&lt;s:property value=&quot;users&quot;/&gt;&lt;br/&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
<h4 id="8-7-2自定义类型转换"><a href="#8-7-2自定义类型转换" class="headerlink" title="8.7.2自定义类型转换"></a>8.7.2自定义类型转换</h4><p>自定义类型转换器方法:</p>
<h5 id="继承DefaultTypeConverter，重写convertValue方法，这个方法的功能是完成双向转换-Sting数组转换到Action属性。函数模板为："><a href="#继承DefaultTypeConverter，重写convertValue方法，这个方法的功能是完成双向转换-Sting数组转换到Action属性。函数模板为：" class="headerlink" title="继承DefaultTypeConverter，重写convertValue方法，这个方法的功能是完成双向转换,Sting数组转换到Action属性。函数模板为："></a>继承DefaultTypeConverter，重写convertValue方法，这个方法的功能是完成双向转换,Sting数组转换到Action属性。函数模板为：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">public class MyPointConverter extends DefaultTypeConverter&#123;</div><div class="line"></div><div class="line">	@Override</div><div class="line">	public Object convertValue(Object value, Class toType) &#123;</div><div class="line">		if(toType == Point.class) &#123;</div><div class="line">			Point p = new Point();</div><div class="line">			String[] strs = (String[])value;</div><div class="line">			String[] xy = strs[0].split(&quot;,&quot;);</div><div class="line">			p.x = Integer.parseInt(xy[0]);</div><div class="line">			p.y = Integer.parseInt(xy[1]);</div><div class="line">			return p;</div><div class="line">		&#125;</div><div class="line">		if(toType == String.class) &#123;</div><div class="line">			return value.toString();</div><div class="line">		&#125;</div><div class="line">		return super.convertValue(value, toType);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="继承StrutsTypeConverter"><a href="#继承StrutsTypeConverter" class="headerlink" title="继承StrutsTypeConverter"></a>继承StrutsTypeConverter</h5><ul>
<li>StrutsTypeConverter是DefaultTypeConverter的子类。在两个方向的类型转换上分别实现：</li>
</ul>
<p>MyPointerConverter:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class MyPointConverter extends StrutsTypeConverter&#123;</div><div class="line">    @Override</div><div class="line">    public Object convertFromString(Map map, String[] strings, Class aClass) &#123;</div><div class="line">        Point point = new Point();</div><div class="line">        String[] strings1 = (String[])strings;</div><div class="line">        String[] xy = strings1[0].split(&quot;,&quot;);</div><div class="line">        point.x = Integer.parseInt(xy[0]);</div><div class="line">        point.y = Integer.parseInt(xy[1]);</div><div class="line">        return point;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String convertToString(Map map, Object o) &#123;</div><div class="line">        return null;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>TestAction:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">public class TestAction extends ActionSupport&#123;</div><div class="line">    Point p;</div><div class="line">    List&lt;Point&gt; ps;</div><div class="line">    Map&lt;String, Point&gt; points;</div><div class="line"></div><div class="line">    public Point getP() &#123;</div><div class="line">        return p;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setP(Point p) &#123;</div><div class="line">        this.p = p;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public List&lt;Point&gt; getPs() &#123;</div><div class="line">        return ps;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setPs(List&lt;Point&gt; ps) &#123;</div><div class="line">        this.ps = ps;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Map&lt;String, Point&gt; getPoints() &#123;</div><div class="line">        return points;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setPoints(Map&lt;String, Point&gt; points) &#123;</div><div class="line">        this.points = points;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String execute() throws Exception &#123;</div><div class="line">        return super.execute();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>jsp:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">&lt;s:property value=&quot;p&quot;/&gt;&lt;br/&gt;</div><div class="line">&lt;s:property value=&quot;ps&quot;/&gt;&lt;br/&gt;</div><div class="line">points:&lt;s:property value=&quot;points&quot;/&gt;&lt;br/&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
<h5 id="注册方式："><a href="#注册方式：" class="headerlink" title="注册方式："></a>注册方式：</h5><ul>
<li>第一种配置方法为在具备类型转换文件中配置，局部类型转换文件命名为<code>ActionName-conversion.properties</code>,位置放在特定的Action目录下，文件内容格式为：<code>typeName=ConverClass</code>仅针对特定的Action的特定属性有效</li>
<li>第二种配置方法为全局类型转换文件中红配置，文件名为xwork-conversion.properties,在<code>WEB-INF\classes</code>下，文件内容格式为：<code>attributeName=ConvertClass</code>, 对某个类型都有效，比如对Point类型注册了类型转换器。</li>
<li><p>注解</p>
<h3 id="8-8-拦截器和过滤器的比较"><a href="#8-8-拦截器和过滤器的比较" class="headerlink" title="8.8 拦截器和过滤器的比较"></a>8.8 拦截器和过滤器的比较</h3></li>
<li>相同点：<ul>
<li>都是一种Java类</li>
<li>都能拦截客户端发给服务端的请求</li>
<li>拦截到请求之后都可以做一些相应的处理，最后还可以把这个请求放行</li>
<li>都需要实现各自相应的接口记忆在相应的配置文件中配置</li>
</ul>
</li>
<li><p>不同点：</p>
<ul>
<li>拦截器是Struts2框架中定义的，过滤器是web里面的对象，是J2EE标准定义的</li>
<li>拦截器只会拦截访问Action的请求，过滤器可以拦截所有的请求</li>
<li>拦截器定义在struts.xml文件中，过滤器定义在web.xml中</li>
<li>拦截器对象的创建、调用、销毁时struts2框架负责的，过滤器对象的创建、调用、销毁时服务器负责的。</li>
</ul>
<p><em>我们自己定义的filter也可以拦截struts2框架中的Action，需要在web.xml文件中把我们自己的filter配置在struts2的filter上面才可以，因为web.xml文件中的filter配置的先后顺序控制filter起作用的顺序，如果struts的filter先拦截到访问action的请求后，不会把这个请求交给下面的filter，而是交给它内部的拦截器。如果我们自己的filter拦截到请求之后，还是会交给下一个filter，也就是交给struts2的filter</em></p>
</li>
</ul>
<h2 id="9-注解Annotation"><a href="#9-注解Annotation" class="headerlink" title="9 注解Annotation"></a>9 注解Annotation</h2><h3 id="9-1-注解使用方式"><a href="#9-1-注解使用方式" class="headerlink" title="9.1 注解使用方式"></a>9.1 注解使用方式</h3><ol>
<li>引入支持struts2框架注解开发的jar包 struts2-convention-plugin-2.3.4.1</li>
<li>struts.xml <code>&lt;constant name=&quot;struts.convention.action.suffix&quot; value=&quot;Action&quot;/&gt;</code></li>
<li><p>Struts2使用注解开发需要遵循一定的规范：</p>
<ul>
<li>Action要必须继承ActionSupport父类</li>
<li>Action所在的包名必须以Action结尾</li>
<li>package-info.java <em>在这里配置这个包下所有的类都可以用</em></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> @Namespace(&quot;/&quot;)</div><div class="line">@ParentPackage(&quot;struts-default&quot;)</div><div class="line">@DefaultInterceptorRef(&quot;authStack&quot;)//authStack自定义的拦截器</div><div class="line"> package com.briup.action.manager;</div><div class="line">import org.apache.struts2.convention.annotation.Namespace;</div><div class="line">import org.apache.struts2.convention.annotation.ParentPackage;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="9-2-Action常用注解"><a href="#9-2-Action常用注解" class="headerlink" title="9.2 Action常用注解"></a>9.2 Action常用注解</h3><ul>
<li><p>Namespace Annotation</p>
<ul>
<li>通过在ActionClass上定义@Namespace(“/custom”)</li>
<li>通过package0info.java定义<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@Namespace(&quot;/manager&quot;)</div><div class="line">@ParentPackage(&quot;default&quot;)</div><div class="line">@DefaultInterceptorRef(&quot;authStack&quot;)</div><div class="line">package com.example.actions;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Action Annotation</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">1. @Action(interceptorRefs=&#123;</div><div class="line">                @InterceptorRef(&quot;validation&quot;),</div><div class="line">                @InterceptorRef(&quot;defaultStack&quot;)</div><div class="line">            &#125;)</div><div class="line"></div><div class="line">2.      chain</div><div class="line">        @Action(&quot;foo&quot;)</div><div class="line">        public String foo() &#123;</div><div class="line">            return &quot;bar&quot;;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Action(&quot;foo-bar&quot;)</div><div class="line">        public String bar() &#123;</div><div class="line">            return SUCCESS;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Result Annotation</p>
<ul>
<li>全局， 整个类可以访问</li>
<li>局部， 某个方法可以访问<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> @Results(&#123;</div><div class="line">    @Result(name=&quot;failure&quot;, location=&quot;fail.jsp&quot;)</div><div class="line">&#125;)</div><div class="line">public class HelloWorld extends ActionSupport &#123;</div><div class="line">    @Action(value=&quot;/different/url&quot;,results=&#123;@Result(name=&quot;success&quot;, location=&quot;http://struts.apache.org&quot;, type=&quot;redirect&quot;)&#125;          )</div><div class="line">    public String execute() &#123;</div><div class="line">        return SUCCESS;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><em>参考：<a href="http://www.jianshu.com/p/a884504a8863" target="_blank" rel="external">http://www.jianshu.com/p/a884504a8863</a></em></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/07/struts2总结 五--interceptor拦截器/" data-id="cj7a8wvou00059sv2l1xbciy6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-struts2总结 四--异常处理和I18N" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/07/struts2总结 四--异常处理和I18N/" class="article-date">
  <time datetime="2017-09-07T06:13:34.789Z" itemprop="datePublished">2017-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/07/struts2总结 四--异常处理和I18N/">struts2总结（三）--Struts Tags</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="6-声明式异常处理"><a href="#6-声明式异常处理" class="headerlink" title="6 声明式异常处理"></a>6 声明式异常处理</h2><p>通过配置的方式捕获指定类型异常，有ExceptionMappingInterceptor拦截器将异常信息（ExceptionHolder：exceptionStack， exception）压入栈顶，然后通过OGNL表达式在页面中获取异常。</p>
<ol>
<li><p>在Actoin中进行异常映射</p>
<ul>
<li>只对当前Action对应类型的异常起作用，在struts2配置文件Action内部节点使用exception-mapping来映射异常,当发生SQLException时，会返回“error”信息，并跳转到error.jsp页面：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;action name=&quot;*-*&quot; class=&quot;com.bbs.action.&#123;1&#125;Action&quot; method=&quot;&#123;2&#125;&quot;&gt;</div><div class="line">          &lt;result&gt;/admin/&#123;1&#125;-&#123;2&#125;.jsp&lt;/result&gt;</div><div class="line">          &lt;result name=&quot;input&quot;&gt;/admin/&#123;1&#125;-&#123;2&#125;.jsp&lt;/result&gt;</div><div class="line">          &lt;exception-mapping exception=&quot;java.sql.SQLException&quot; result=&quot;error&quot; /&gt;</div><div class="line">          &lt;result name=&quot;error&quot;&gt;/error.jsp&lt;/result&gt;</div><div class="line">      &lt;/action&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>在package中进行全局异常映射</p>
<ul>
<li>针对所有Action对应类型的异常都起作用，可以通过OGNL在页面中获取异常信息需。</li>
<li>GLOBAL级别的声明式异常配置必须配置在所有的Action之前，同时，global-result节点需要配置在global-exception-mappings之前。</li>
<li>当捕获到一个异常对象时，如果同时存在Action和全局两种级别的映射信息，则优先使用Action级别。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;package name=&quot;default&quot; extends=&quot;struts-default&quot;&gt;</div><div class="line">      &lt;global-results&gt;</div><div class="line">          &lt;result name=&quot;globleException&quot;&gt;/error.jsp&lt;/result&gt;</div><div class="line">      &lt;/global-results&gt;</div><div class="line"></div><div class="line">      &lt;global-exception-mappings&gt;</div><div class="line">          &lt;exception-mapping result=&quot;globleException&quot; exception=&quot;java.lang.Exception&quot;/&gt;</div><div class="line">      &lt;/global-exception-mappings&gt;</div><div class="line">  &lt;/package&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>使用继承共用异常映射，多个package可以通过extends来公用异常映射：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;package name=&quot;admin&quot; namespace=&quot;/admin&quot; extends=&quot;default&quot; &gt;</div><div class="line"></div><div class="line">       &lt;action name=&quot;index&quot;&gt;</div><div class="line">           &lt;result&gt;/admin/index.html&lt;/result&gt;</div><div class="line">       &lt;/action&gt;</div><div class="line"></div><div class="line">       &lt;action name=&quot;*-*&quot; class=&quot;com.action.&#123;1&#125;Action&quot; method=&quot;&#123;2&#125;&quot;&gt;</div><div class="line">           &lt;result&gt;/admin/&#123;1&#125;-&#123;2&#125;.jsp&lt;/result&gt;</div><div class="line">           &lt;result name=&quot;input&quot;&gt;/admin/&#123;1&#125;-&#123;2&#125;.jsp&lt;/result&gt;</div><div class="line">           &lt;result name=&quot;error&quot;&gt;/error.jsp&lt;/result&gt;</div><div class="line">       &lt;/action&gt;</div><div class="line">&lt;/package&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>Struts2中异常处理由拦截器实现（观察struts-default.xml）</p>
<ul>
<li>实际上Struts2的大多数功能都由拦截器实现</li>
</ul>
</li>
</ol>
<h2 id="7-I18N"><a href="#7-I18N" class="headerlink" title="7 I18N"></a>7 I18N</h2><ol>
<li><p>I18N原理<br>国际化，international。我们将程序中硬编码的文本转移到外部的资源文件（.properties）中期 ，针对每一种语言环境，编写一个资源文件。指定当前程序所用的语言环境，Java中的国际化处理机制能够自动找到对应的资源文件并读取内容。创建了两个资源文件，一个为bbs_en_US.properties,bbs_zh_CN.properties，需要注意的 是编码问题，IDEA中将File-Editor-Code Style-File Encodings-Transparent native-to-ascii conversion勾选上，就可以将中文自动转换成ASCII编码。</p>
<ul>
<li>ResourceBundle和Locale的概念</li>
<li>ResourceBundle:按语言查找顺序</li>
<li>Locale命令是将当前语言环境或全部公共语言环境的信息输出到标准输出上</li>
<li>资源文件:在Action所在的包或者任意一个父包中定义package.properties和package_language_COUTRY.properties资源文件</li>
</ul>
</li>
<li><p>Struts的资源文件</p>
<ul>
<li>Action – Package – App级</li>
<li>一般只用APP</li>
<li>struts.xml custom.i18n</li>
<li>动态语言切换</li>
<li>request_locale=en_US</li>
</ul>
</li>
<li><p>了解的不多，以后可以查教程<br><a href="http://www.yiibai.com/struts_2/struts_localization.html" target="_blank" rel="external">I18N</a></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/07/struts2总结 四--异常处理和I18N/" data-id="cj7a8wvou00069sv2j8felr5d" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-struts2总结 六--struts2项目开发流程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/07/struts2总结 六--struts2项目开发流程/" class="article-date">
  <time datetime="2017-09-07T06:05:53.536Z" itemprop="datePublished">2017-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/07/struts2总结 六--struts2项目开发流程/">struts2总结（三）--Struts Tags</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>建立界面原型</li>
<li>建立struts.XHTML<ul>
<li>确定namespace</li>
<li>确定package</li>
<li>确定Result</li>
<li>将界面原型页面进行修改，匹配现有设置</li>
<li>测试</li>
<li>做好规划</li>
</ul>
</li>
<li>建立数据库</li>
<li>建立Model层</li>
<li>建立Service层<ul>
<li>使用JUnit进行单元测试</li>
</ul>
</li>
<li>开始开发</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/07/struts2总结 六--struts2项目开发流程/" data-id="cj7a8wvot00049sv2yttry069" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-struts2总结 二--Result和OGNL表达式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/07/struts2总结 二--Result和OGNL表达式/" class="article-date">
  <time datetime="2017-09-07T05:32:41.083Z" itemprop="datePublished">2017-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/07/struts2总结 二--Result和OGNL表达式/">struts2总结（二）--Result和OGNL表达式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="4-Result"><a href="#4-Result" class="headerlink" title="4 Result"></a>4 Result</h2><p>Result是Action执行结束之后返回的结果，result包含name和type属性，前者是返回的字符串，后者指定跳转的类型，默认为dispatcher。</p>
<h3 id="4-1-Result常用的四中类型"><a href="#4-1-Result常用的四中类型" class="headerlink" title="4.1 Result常用的四中类型"></a>4.1 Result常用的四中类型</h3><ol>
<li>dispatcher， 从一个Action里面服务器内部跳转到一个页面中, r1–&gt;r1.jsp</li>
<li>chain， 从一个Action里面服务器内部跳转到另一个Action中,r2–&gt;r2.jsp</li>
<li>redirect， 从一个Action里面客户端重定向到一个页面中, r3-&gt;r1-&gt;r1.jsp</li>
<li>redirectAction， 从一个Action里面客户端重定向到另一个Action中, r4-&gt;r2-&gt;r2.jsp<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;package name=&quot;resultTypes&quot; namespace=&quot;/r&quot; extends=&quot;struts-default&quot;&gt;</div><div class="line">	    &lt;action name=&quot;r1&quot;&gt;</div><div class="line">	    	&lt;result type=&quot;dispatcher&quot;&gt;/r1.jsp&lt;/result&gt;</div><div class="line">	    &lt;/action&gt;</div><div class="line"></div><div class="line">	    &lt;action name=&quot;r2&quot;&gt;</div><div class="line">	    	&lt;result type=&quot;redirect&quot;&gt;/r2.jsp&lt;/result&gt;</div><div class="line">	    &lt;/action&gt;</div><div class="line"></div><div class="line">	    &lt;action name=&quot;r3&quot;&gt;</div><div class="line">	    	&lt;result type=&quot;chain&quot;&gt;r1&lt;/result&gt;</div><div class="line">	    &lt;/action&gt;</div><div class="line"></div><div class="line">	    &lt;action name=&quot;r4&quot;&gt;</div><div class="line">	    	&lt;result type=&quot;redirectAction&quot;&gt;r2&lt;/result&gt;</div><div class="line">	    &lt;/action&gt;</div><div class="line"></div><div class="line">    &lt;/package&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4-2-全局结果集"><a href="#4-2-全局结果集" class="headerlink" title="4.2 全局结果集"></a>4.2 全局结果集</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;global-results&gt;</div><div class="line">    		&lt;result name=&quot;mainpage&quot;&gt;/main.jsp&lt;/result&gt;</div><div class="line">&lt;/global-results&gt;</div></pre></td></tr></table></figure>
<p>在其他任何Action中，不需要单独设置，所有返回mainpage字符串的Action会跳转到main.jsp页面。但是如果在某一个Action定义了mainpage字符串的跳转，全局跳转对这个acting失效。action结果集的优先级高于全局结果集。</p>
<h3 id="4-3-动态结果（了解）"><a href="#4-3-动态结果（了解）" class="headerlink" title="4.3 动态结果（了解）"></a>4.3 动态结果（了解）</h3><p>动态结果集表示在struts配置的时候，Action根据类型的不同，动态的决定返回的页面。首先需要在Action中定义两个成员变量，type和r, 其中type用于接收页面传入的参数，r用于保存Action传出的结果。<br>struts.xml为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;package name=&quot;user&quot; namespace=&quot;/user&quot; extends=&quot;struts-default&quot;&gt;</div><div class="line"></div><div class="line">	    &lt;action name=&quot;user&quot; class=&quot;com.bjsxt.struts2.user.action.UserAction&quot;&gt;</div><div class="line">	    	&lt;result&gt;$&#123;r&#125;&lt;/result&gt;</div><div class="line">	    &lt;/action&gt;	    </div><div class="line">    &lt;/package&gt;</div><div class="line"></div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure>
<p>index.jsp:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">动态结果</div><div class="line">一定不要忘了为动态结果的保存值设置set get方法</div><div class="line">&lt;ol&gt;</div><div class="line">	&lt;li&gt;&lt;a href=&quot;user/user?type=1&quot;&gt;返回success&lt;/a&gt;&lt;/li&gt;</div><div class="line">	&lt;li&gt;&lt;a href=&quot;user/user?type=2&quot;&gt;返回error&lt;/a&gt;&lt;/li&gt;</div><div class="line">&lt;/ol&gt;</div><div class="line"></div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
<p>UserAction：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">public class UserAction extends ActionSupport &#123;</div><div class="line">	private int type;</div><div class="line"></div><div class="line">	private String r;</div><div class="line"></div><div class="line">	public String getR() &#123;</div><div class="line">		return r;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setR(String r) &#123;</div><div class="line">		this.r = r;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public int getType() &#123;</div><div class="line">		return type;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setType(int type) &#123;</div><div class="line">		this.type = type;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@Override</div><div class="line">	public String execute() throws Exception &#123;</div><div class="line">		if(type == 1) r=&quot;/user_success.jsp&quot;;</div><div class="line">		else if (type == 2) r=&quot;/user_error.jsp&quot;;</div><div class="line">		return &quot;success&quot;;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="4-4-传递参数"><a href="#4-4-传递参数" class="headerlink" title="4.4 传递参数"></a>4.4 传递参数</h3><p>除了request，session，application来向页面传值之外，还可以通过ValueStack和ActionContext。</p>
<ul>
<li>ValueStack是一个接口， <code>ValueStack vs = context.getValueStack()</code>将值从Action传到页面，ActionContext是一个类，<code>ActionContext context = ActionContext.getContext()</code>来传值，在页面中农需要<code>&lt;s:debug /&gt;</code>标签来查看结果。</li>
<li>当Action进行跳转的时候，struts2框架会自动的把这个Action对象本身分别放到ValueStack和ActionContext中去。然后struts2将这两个对象传递给页面，在页面中可以通过这两个对象来拿到之前放进去的值。也可以在Action中拿到这两个对象手动放值:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ActionContext ac = ActionContext.getContext();</div><div class="line">ValueStack vs = ac.getValueStack();</div><div class="line">ac.put(&quot;ac&quot;,&quot;ac&quot;);</div><div class="line">User user = new User()；</div><div class="line">vs.push(user);</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4-4-1-ValueStack"><a href="#4-4-1-ValueStack" class="headerlink" title="4.4.1 ValueStack"></a>4.4.1 ValueStack</h4><ol>
<li>把一个对象放到值栈之后，文名从这个值栈中是拿不到这个对象的，但是文名可以直接拿到这个对象的属性及其属性值。</li>
<li>从值栈中拿值的时候，是从值栈的property name这一列来拿的，拿到的是property value之一列的值。</li>
<li>所以通过值栈来传递参数到页面需要将参数封装到一个对象中，将这个对象放到值栈中。</li>
<li>生命周期为request</li>
<li>创建一个新的值栈对象后，都会把这个对象放到ActionCon中去。</li>
</ol>
<h4 id="4-4-2-ActionContext"><a href="#4-4-2-ActionContext" class="headerlink" title="4.4.2 ActionContext"></a>4.4.2 ActionContext</h4><ol>
<li>向ActionContext中放值的时候是通过k-v的形式存放的，String-Object键值对，取值同样是通过key拿到value。</li>
<li>struts2框架默认向这个对象里面存放的对象很多，包括request，session，application，ValueStack，parameter等</li>
<li>每次请求都会创建一个新的ActionContext对象</li>
</ol>
<h4 id="4-4-3-取值方式"><a href="#4-4-3-取值方式" class="headerlink" title="4.4.3 取值方式"></a>4.4.3 取值方式</h4><ol>
<li><p>jsp内置对象取值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;%=request.getAttribute(&quot;name&quot;) %&gt;&lt;br&gt;</div><div class="line">&lt;%=session.getAttribute(&quot;name&quot;) %&gt;&lt;br&gt;</div><div class="line">&lt;%=application.getAttribute(&quot;name&quot;) %&gt;&lt;br&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>jstl标签+EL表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$&#123;requestScope.MyName &#125;&lt;br&gt;</div><div class="line"> $&#123;requestScope.name &#125;  &lt;br&gt;</div><div class="line"> $&#123;sessionScope.MyName &#125;  &lt;br&gt;</div><div class="line"> $&#123;applicationScope.MyName &#125;  &lt;br&gt;</div><div class="line"> $&#123;MyName &#125;  &lt;br&gt;</div><div class="line"> $&#123;name &#125;  &lt;br&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>struts2标签+OGNL表达式<code>&lt;s:property value=&quot;OGNL&quot;</code></p>
</li>
</ol>
<blockquote>
<ul>
<li><p>从ValueStack中取值：这个value属性的值name,是一个OGNL表达式，表示取一个名字为name的property的值。从ValueStack中取值，如果存在重名的，默认取最上面的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;s:property value=&quot;name&quot;/&gt;</div><div class="line">&lt;s:property value=&quot;user&quot;/&gt;</div><div class="line">&lt;s:property value=&quot;user.id&quot;/&gt;</div><div class="line">&lt;s:property value=&quot;user.name&quot;/&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>从ActionContext中取值  #</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;s:property value=&quot;#action.name&quot;/&gt;&lt;br&gt;</div><div class="line"> &lt;s:property value=&quot;#msg&quot;/&gt;&lt;br&gt;</div><div class="line"> &lt;s:property value=&quot;#user&quot;/&gt;&lt;br&gt;</div><div class="line"> &lt;s:property value=&quot;#user.id&quot;/&gt;&lt;br&gt;</div><div class="line"> &lt;s:property value=&quot;#user.name&quot;/&gt;&lt;br&gt;</div><div class="line"> &lt;s:property value=&quot;#user.age&quot;/&gt;&lt;br&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<h2 id="5-OGNL表达式"><a href="#5-OGNL表达式" class="headerlink" title="5 OGNL表达式"></a>5 OGNL表达式</h2><p>OGNL:Object-Graph Navigation Language，图对象导航语言，是struts2中默认的表达式语言。</p>
<h3 id="5-1-访问普通方法、属性、构造方法"><a href="#5-1-访问普通方法、属性、构造方法" class="headerlink" title="5.1 访问普通方法、属性、构造方法"></a>5.1 访问普通方法、属性、构造方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;访问值栈中的action的普通属性: username = &lt;s:property value=&quot;username&quot;/&gt; &lt;/li&gt;</div><div class="line">&lt;li&gt;访问值栈中对象的普通属性(get set方法)：&lt;s:property value=&quot;user.age&quot;/&gt; | &lt;s:property value=&quot;user[&apos;age&apos;]&quot;/&gt; | &lt;s:property value=&quot;user[\&quot;age\&quot;]&quot;/&gt; | wrong: &lt;%--&lt;s:property value=&quot;user[age]&quot;/&gt;--%&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问值栈中对象的普通属性(get set方法): &lt;s:property value=&quot;cat.friend.name&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问值栈中对象的普通方法：&lt;s:property value=&quot;password.length()&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问值栈中对象的普通方法：&lt;s:property value=&quot;cat.miaomiao()&quot; /&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问值栈中action的普通方法：&lt;s:property value=&quot;m()&quot; /&gt;&lt;/li&gt;</div><div class="line">&lt;hr /&gt;</div><div class="line">&lt;li&gt;访问普通类的构造方法：&lt;s:property value=&quot;new com.struts2.ognl.User(8)&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;hr /&gt;</div></pre></td></tr></table></figure>
<h3 id="5-2-访问静态方法、属性"><a href="#5-2-访问静态方法、属性" class="headerlink" title="5.2 访问静态方法、属性"></a>5.2 访问静态方法、属性</h3><p>struts2默认的<code>&lt;constant name=&quot;struts.ognl.allowStaticMethodAccess&quot; value=&quot;true&quot;&gt;&lt;/constant&gt;</code>为false，需要配置成true才可以访问静态方法、属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;访问静态方法：&lt;s:property value=&quot;@com.struts2.ognl.S@s()&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问静态属性：&lt;s:property value=&quot;@com.struts2.ognl.S@STR&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Math类的静态方法：&lt;s:property value=&quot;@@max(2,3)&quot; /&gt;&lt;/li&gt;</div></pre></td></tr></table></figure>
<h3 id="5-3-访问集合元素："><a href="#5-3-访问集合元素：" class="headerlink" title="5.3 访问集合元素："></a>5.3 访问集合元素：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;访问List:&lt;s:property value=&quot;users&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问List中某个元素:&lt;s:property value=&quot;users[1]&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问List中元素某个属性的集合:&lt;s:property value=&quot;users.&#123;age&#125;&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问List中元素某个属性的集合中的特定值:&lt;s:property value=&quot;users.&#123;age&#125;[0]&quot;/&gt; | &lt;s:property value=&quot;users[0].age&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Set:&lt;s:property value=&quot;dogs&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Set中某个元素:&lt;s:property value=&quot;dogs[1]&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Map:&lt;s:property value=&quot;dogMap&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Map中某个元素:&lt;s:property value=&quot;dogMap.dog101&quot;/&gt; | &lt;s:property value=&quot;dogMap[&apos;dog101&apos;]&quot;/&gt; | &lt;s:property value=&quot;dogMap[\&quot;dog101\&quot;]&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Map中所有的key:&lt;s:property value=&quot;dogMap.keys&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问Map中所有的value:&lt;s:property value=&quot;dogMap.values&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;访问容器的大小：&lt;s:property value=&quot;dogMap.size()&quot;/&gt; | &lt;s:property value=&quot;users.size&quot;/&gt; &lt;/li&gt;</div></pre></td></tr></table></figure>
<h3 id="5-4-投影和过滤"><a href="#5-4-投影和过滤" class="headerlink" title="5.4 投影和过滤"></a>5.4 投影和过滤</h3><ul>
<li>“?#”：过滤所有符合条件的集合</li>
<li>“^#”：过滤第一个符合条件的元素</li>
<li>“$#”：过滤最后一个符合条件的元素</li>
<li>返回的是一个集合，可以使用索引取得集合中指定的元素。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;投影(过滤)：&lt;s:property value=&quot;users.&#123;?#this.age==1&#125;[0]&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;投影：&lt;s:property value=&quot;users.&#123;^#this.age&gt;1&#125;.&#123;age&#125;&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;投影：&lt;s:property value=&quot;users.&#123;$#this.age&gt;1&#125;.&#123;age&#125;&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;投影：&lt;s:property value=&quot;users.&#123;$#this.age&gt;1&#125;.&#123;age&#125; == null&quot;/&gt;&lt;/li&gt;</div></pre></td></tr></table></figure>
<h3 id="5-5-区分-和"><a href="#5-5-区分-和" class="headerlink" title="5.5 区分 %{} 和 ${}"></a>5.5 区分 %{} 和 ${}</h3><ul>
<li>%{}<br>%{}的主要作用是告诉标签的处理类将它包含的字符串按照OGNL表达式处理，类似eval函数</li>
<li>${}<br>${}的主要用于两方面：<ul>
<li>用于国际化资源文件中</li>
<li>用于Struts2配置文件中</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/07/struts2总结 二--Result和OGNL表达式/" data-id="cj7a8wvos00039sv2jxpehfjy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-struts2总结 三--Struts Tags" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/07/struts2总结 三--Struts Tags/" class="article-date">
  <time datetime="2017-09-07T02:28:13.480Z" itemprop="datePublished">2017-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/07/struts2总结 三--Struts Tags/">struts2总结（三）--Struts Tags</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="5-Struts-Tags"><a href="#5-Struts-Tags" class="headerlink" title="5 Struts Tags"></a>5 Struts Tags</h2><p>要在jsp中使用Struts2的标签，需要先引入<code>&lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;</code></p>
<h3 id="5-1-通用标签"><a href="#5-1-通用标签" class="headerlink" title="5.1 通用标签"></a>5.1 通用标签</h3><ul>
<li><p>property</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;property: &lt;s:property value=&quot;username&quot;/&gt; &lt;/li&gt;</div><div class="line">&lt;li&gt;property 取值为字符串: &lt;s:property value=&quot;&apos;username&apos;&quot;/&gt; &lt;/li&gt;</div><div class="line">&lt;li&gt;property 设定默认值: &lt;s:property value=&quot;admin&quot; default=&quot;管理员&quot;/&gt; &lt;/li&gt;</div><div class="line">&lt;li&gt;property 设定HTML: &lt;s:property value=&quot;&apos;&lt;hr/&gt;&apos;&quot; escape=&quot;false&quot;/&gt; &lt;/li&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>set 将某个值放入指定范围内</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;set 设定adminName值（默认为request 和 ActionContext）: &lt;s:set var=&quot;adminName&quot; value=&quot;username&quot; /&gt;&lt;/li&gt;</div><div class="line"></div><div class="line">&lt;li&gt;set 从request取值: &lt;s:property value=&quot;#request.adminName&quot; /&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;set 从ActionContext取值: &lt;s:property value=&quot;#adminName&quot; /&gt;&lt;/li&gt;</div><div class="line"></div><div class="line">&lt;%--&lt;li&gt;set 设定范围: &lt;s:set name=&quot;adminPassword&quot; value=&quot;password&quot; scope=&quot;page&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;set 从相应范围取值: &lt;%=pageContext.getAttribute(&quot;adminPassword&quot;) %&gt;&lt;/li&gt;</div><div class="line">--%&gt;</div><div class="line">&lt;li&gt;set 设定var，范围为ActionContext: &lt;s:set var=&quot;adminPassword&quot; value=&quot;password&quot; scope=&quot;session&quot;/&gt;&lt;/li&gt;</div><div class="line">&lt;li&gt;set 使用#取值: &lt;s:property value=&quot;#adminPassword&quot;/&gt; &lt;/li&gt;</div><div class="line">&lt;li&gt;set 从相应范围取值: &lt;s:property value=&quot;#session.adminPassword&quot;/&gt; &lt;/li&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>bean 实例化一个JavaBean</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;bean 定义bean,并使用param来设定新的属性值:</div><div class="line">        &lt;s:bean name=&quot;com.struts2.tags.Dog&quot; &gt;</div><div class="line">            &lt;s:param name=&quot;name&quot; value=&quot;&apos;pp&apos;&quot;&gt;&lt;/s:param&gt;</div><div class="line">            &lt;s:property value=&quot;name&quot;/&gt;</div><div class="line"></div><div class="line">        &lt;/s:bean&gt;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;li&gt;bean 查看debug情况:</div><div class="line">        &lt;s:bean name=&quot;com.struts2.tags.Dog&quot; var=&quot;myDog&quot;&gt;</div><div class="line">            &lt;s:param name=&quot;name&quot; value=&quot;&apos;oudy&apos;&quot;&gt;&lt;/s:param&gt;</div><div class="line">        &lt;/s:bean&gt;</div><div class="line">        拿出值：</div><div class="line">        &lt;s:property value=&quot;#myDog.name&quot;/&gt;</div><div class="line">&lt;/li&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>include 将一JSP或者Servlet包含到当前页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;include _include1.html 包含静态英文文件</div><div class="line">       &lt;s:include value=&quot;/_include1.html&quot;&gt;&lt;/s:include&gt;</div><div class="line">   &lt;/li&gt;</div><div class="line"></div><div class="line">   &lt;li&gt;include _include2.html 包含静态中文文件</div><div class="line">       &lt;s:include value=&quot;/_include2.html&quot;&gt;&lt;/s:include&gt;</div><div class="line">   &lt;/li&gt;</div><div class="line"></div><div class="line">   &lt;li&gt;include _include1.html 包含静态英文文件，说明%用法</div><div class="line">       &lt;s:set var=&quot;incPage&quot; value=&quot;%&#123;&apos;/_include1.html&apos;&#125;&quot; /&gt;</div><div class="line">       &lt;s:include value=&quot;%&#123;#incPage&#125;&quot;&gt;&lt;/s:include&gt;</div><div class="line">   &lt;/li&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>param 为其他标签提供参数</p>
</li>
<li>debug 辅助调试，查看值栈等信息<h3 id="5-2-控制标签"><a href="#5-2-控制标签" class="headerlink" title="5.2 控制标签"></a>5.2 控制标签</h3></li>
<li><p>if elseif else 用来控制选择输出的标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;if elseif else:</div><div class="line">    age = &lt;s:property value=&quot;#parameters.age[0]&quot; /&gt; &lt;br /&gt;</div><div class="line">    &lt;s:set var=&quot;age&quot; value=&quot;#parameters.age[0]&quot; /&gt;</div><div class="line">    &lt;s:if test=&quot;#age &lt; 0&quot;&gt;wrong age!&lt;/s:if&gt;</div><div class="line">    &lt;s:elseif test=&quot;#parameters.age[0] &lt; 20&quot;&gt;too young!&lt;/s:elseif&gt;</div><div class="line">    &lt;s:else&gt;yeah!&lt;/s:else&gt;&lt;br /&gt;</div><div class="line"></div><div class="line">    &lt;s:if test=&quot;#parameters.aaa == null&quot;&gt;null&lt;/s:if&gt;</div><div class="line">&lt;/li&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>iterator 迭代器，用于将集合迭代输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;遍历集合：&lt;br /&gt;</div><div class="line">    &lt;s:iterator value=&quot;&#123;1, 2, 3&#125;&quot; &gt;</div><div class="line">        &lt;s:property/&gt; |</div><div class="line">    &lt;/s:iterator&gt;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;li&gt;自定义变量：&lt;br /&gt;</div><div class="line">    &lt;s:iterator value=&quot;&#123;&apos;aaa&apos;, &apos;bbb&apos;, &apos;ccc&apos;&#125;&quot; var=&quot;x&quot;&gt;</div><div class="line">        &lt;s:property value=&quot;#x.toUpperCase()&quot;/&gt; |</div><div class="line">    &lt;/s:iterator&gt;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;li&gt;使用status:&lt;br /&gt;</div><div class="line">    &lt;s:iterator value=&quot;&#123;&apos;aaa&apos;, &apos;bbb&apos;, &apos;ccc&apos;&#125;&quot; status=&quot;status&quot;&gt;</div><div class="line">        &lt;s:property/&gt; |</div><div class="line">        遍历过的元素总数：&lt;s:property value=&quot;#status.count&quot;/&gt; |</div><div class="line">        遍历过的元素索引：&lt;s:property value=&quot;#status.index&quot;/&gt; |</div><div class="line">        当前是偶数？：&lt;s:property value=&quot;#status.even&quot;/&gt; |</div><div class="line">        当前是奇数？：&lt;s:property value=&quot;#status.odd&quot;/&gt; |</div><div class="line">        是第一个元素吗？：&lt;s:property value=&quot;#status.first&quot;/&gt; |</div><div class="line">        是最后一个元素吗？：&lt;s:property value=&quot;#status.last&quot;/&gt;</div><div class="line">        &lt;br /&gt;</div><div class="line">    &lt;/s:iterator&gt;</div><div class="line"></div><div class="line">&lt;/li&gt;</div><div class="line"></div><div class="line">&lt;li&gt;</div><div class="line">    &lt;s:iterator value=&quot;#&#123;1:&apos;a&apos;, 2:&apos;b&apos;, 3:&apos;c&apos;&#125;&quot; &gt;</div><div class="line">        &lt;s:property value=&quot;key&quot;/&gt; | &lt;s:property value=&quot;value&quot;/&gt; &lt;br /&gt;</div><div class="line">    &lt;/s:iterator&gt;</div><div class="line">&lt;/li&gt;</div><div class="line"></div><div class="line">&lt;li&gt;</div><div class="line">    &lt;s:iterator value=&quot;#&#123;1:&apos;a&apos;, 2:&apos;b&apos;, 3:&apos;c&apos;&#125;&quot; var=&quot;x&quot;&gt;</div><div class="line">        &lt;s:property value=&quot;#x.key&quot;/&gt; | &lt;s:property value=&quot;#x.value&quot;/&gt; &lt;br /&gt;</div><div class="line">    &lt;/s:iterator&gt;</div><div class="line">&lt;/li&gt;</div><div class="line"></div><div class="line">&lt;li&gt;</div><div class="line"></div><div class="line">    &lt;s:fielderror fieldName=&quot;fielderror.test&quot; theme=&quot;simple&quot;&gt;&lt;/s:fielderror&gt;</div><div class="line"></div><div class="line">&lt;/li&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>subset 用于截取集合的部分元素，形成新的子集合</p>
<h3 id="5-3-UI标签"><a href="#5-3-UI标签" class="headerlink" title="5.3 UI标签"></a>5.3 UI标签</h3><p>Struts2中一共定义了4个主题，simple， XHTML（默认）， css_xhtml, ajax.</p>
<h3 id="5-4-AJAX标签"><a href="#5-4-AJAX标签" class="headerlink" title="5.4 AJAX标签"></a>5.4 AJAX标签</h3><p>后续可以查</p>
<h3 id="5-5-的区别"><a href="#5-5-的区别" class="headerlink" title="5.5 $ # % 的区别"></a>5.5 $ # % 的区别</h3></li>
<li><p>$用于i18n和struts配置文件</p>
</li>
<li>#取得ActionContext的值</li>
<li>%将原本的文本属性解析为OGNL，对本来是OGNL的属性不起作用</li>
</ul>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p>这部分用的不多，所以存了几个相关的比较全的博客地址，方便需要的时候去学习:<br><a href="http://blog.csdn.net/liujiahan629629/article/details/39274997" target="_blank" rel="external">Struts2标签小结</a><br><a href="http://www.cnblogs.com/lihuiyy/archive/2012/04/09/2439509.html" target="_blank" rel="external">UI标签</a><br><a href="http://blog.csdn.net/zklxuankai/article/details/8468815" target="_blank" rel="external">AJAX标签</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/07/struts2总结 三--Struts Tags/" data-id="cj7a8wvor00029sv2fa7a5vbg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-struts2总结 一--简介和Action" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/06/struts2总结 一--简介和Action/" class="article-date">
  <time datetime="2017-09-06T08:03:25.516Z" itemprop="datePublished">2017-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/06/struts2总结 一--简介和Action/">struts2总结（一）--简介和Action</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>Apache Struts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet,在MVC设计模式中，Struts2作为控制器（Controller）来建立模型与视图的数据交互。Struts2是Struts1和WebWork的技术基础上进行了合并的全新的Struts2框架。其全新的Struts2的体系结构与Struts1的体系结构差别巨大。Struts2以WebWork为核心，采用拦截器的机制来处理用户的请求，这样的设也是的业务逻辑控制器能够ServletAPI完全脱离开。</p>
<h3 id="1-1-Struts2的优点"><a href="#1-1-Struts2的优点" class="headerlink" title="1.1 Struts2的优点"></a>1.1 Struts2的优点</h3><blockquote>
<ol>
<li>在软件设计上，Struts2没有像struts1那样和Servlet API和struts API有着紧密的耦合，Struts2的应用可以不依赖于Servlet API和Struts2 API，属于无侵入式设计。</li>
<li>Struts2提供了拦截器，利用拦截器可以进行AOP（面向切面编程）,实现注入权限拦截等功能。</li>
<li>Struts2提供了类型转换器，可以把特殊的请求参数转换为需要的类型。</li>
<li>Struts2提供支持多种表现层技术，如JSP，freeMarker， Velocity等</li>
<li>Struts2的输入校验可以对指定方法进行校验</li>
<li>提供了全局范围，包范围和Action范围的国际化资源文件管理实现</li>
</ol>
</blockquote>
<h3 id="1-2-Web项目中的三层框架"><a href="#1-2-Web项目中的三层框架" class="headerlink" title="1.2 Web项目中的三层框架"></a>1.2 Web项目中的三层框架</h3><h4 id="1-2-1-表示层"><a href="#1-2-1-表示层" class="headerlink" title="1.2.1 表示层"></a>1.2.1 表示层</h4><p>Struts2框架就是工作在这里</p>
<h4 id="1-2-2-业务逻辑层"><a href="#1-2-2-业务逻辑层" class="headerlink" title="1.2.2 业务逻辑层"></a>1.2.2 业务逻辑层</h4><p>Service层，处理业务逻辑，比如判断用户名是否存在，用户名和密码是否匹配，权限检查等。为一些执行某一个操作条件的判断。</p>
<h4 id="1-2-3-数据访问层"><a href="#1-2-3-数据访问层" class="headerlink" title="1.2.3 数据访问层"></a>1.2.3 数据访问层</h4><p>dao层，专门处理和数据库进行交换的业务。jdbc/hibernate在这里使用。MVC架构是项目中三层架构的一部分，三层架构的表示层可以使用MVC架构的struts2框架来实现。</p>
<h2 id="2-web项目中引入struts2框架"><a href="#2-web项目中引入struts2框架" class="headerlink" title="2. web项目中引入struts2框架"></a>2. web项目中引入struts2框架</h2><h3 id="2-1-开发环境"><a href="#2-1-开发环境" class="headerlink" title="2.1 开发环境"></a>2.1 开发环境</h3><ul>
<li>IDE：Intellij IDEA 2017.2</li>
<li>Server：Tomcat 9.0</li>
<li>JDK：JDK 8</li>
</ul>
<h3 id="2-2-新建项目"><a href="#2-2-新建项目" class="headerlink" title="2.2 新建项目"></a>2.2 新建项目</h3><p>File-New-Project<br>创建JavaEE项目，勾选WebApplication和Struts2选项。</p>
<h3 id="2-3-目录结构"><a href="#2-3-目录结构" class="headerlink" title="2.3 目录结构"></a>2.3 目录结构</h3><ul>
<li>Project Name<ul>
<li>.idea</li>
<li>lib</li>
<li>out</li>
<li>src</li>
<li>web</li>
<li>xx.iml<br>需要注意将lib移动到web目录下面的Web-INF文件夹下，并在moudule中添加路径，不然部署过程中会报ClassNotFoundException。因为部署过程中只会读取web下的lib， 外部的lib是不会读取的。</li>
</ul>
</li>
</ul>
<h3 id="2-4-struts2配置文件"><a href="#2-4-struts2配置文件" class="headerlink" title="2.4 struts2配置文件"></a>2.4 struts2配置文件</h3><p>src目录下面会生成struts.xml文件，默认内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;!DOCTYPE struts PUBLIC</div><div class="line">        &quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</div><div class="line">        &quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;&gt;        </div><div class="line">&lt;struts&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure></p>
<h3 id="2-5-web-xml文件中配置struts2框架的过滤器"><a href="#2-5-web-xml文件中配置struts2框架的过滤器" class="headerlink" title="2.5 web.xml文件中配置struts2框架的过滤器"></a>2.5 web.xml文件中配置struts2框架的过滤器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</div><div class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</div><div class="line">         version=&quot;3.1&quot;&gt;</div><div class="line">    &lt;filter&gt;</div><div class="line">        &lt;filter-name&gt;struts2&lt;/filter-name&gt;</div><div class="line">        &lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;</div><div class="line">    &lt;/filter&gt;</div><div class="line">    &lt;filter-mapping&gt;</div><div class="line">        &lt;filter-name&gt;struts2&lt;/filter-name&gt;</div><div class="line">        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</div><div class="line">    &lt;/filter-mapping&gt;</div><div class="line">&lt;/web-app&gt;</div></pre></td></tr></table></figure>
<p><em>这个过滤器的作用是拦截struts2框架中的action</em></p>
<h2 id="3-Action"><a href="#3-Action" class="headerlink" title="3 Action"></a>3 Action</h2><h3 id="3-1-Action定义"><a href="#3-1-Action定义" class="headerlink" title="3.1 Action定义"></a>3.1 Action定义</h3><ul>
<li>struts2框架中有一种Java类叫做Action。struts2框架楼底层封装了Servlet的相关内容而实现出来的。替代之前Servlet的类在Struts2中成为Action。比Servlet功能更加强大，操作更加简单。原因在于拦截器的设计，拦截器可以拦截访问Action的请求，拦截请求之后，可以给Action添加很多丰富的功能，而Action专注于业务逻辑的处理就可以。</li>
</ul>
<h3 id="3-2-实现一个Action"><a href="#3-2-实现一个Action" class="headerlink" title="3.2 实现一个Action"></a>3.2 实现一个Action</h3><h4 id="3-2-1-类中只要有一个固定的方法："><a href="#3-2-1-类中只要有一个固定的方法：" class="headerlink" title="3.2.1 类中只要有一个固定的方法："></a>3.2.1 类中只要有一个固定的方法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public class IndexAction1 &#123;</div><div class="line">    public String execute() &#123;</div><div class="line">        return &quot;success&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>不需要实现或继承任何接口或者父类。execute方法一定要返回String类型的对象，每个字符串都可以对应一个跳转的页面。（字符串是可以自己随便定义的，字符串对应的哪一个跳转到页面也是自己定义的，在struts.xml文件中定义这些内容）</p>
<h4 id="3-2-2-实现一个接口-com-opensyymphony-xwork2-Action"><a href="#3-2-2-实现一个接口-com-opensyymphony-xwork2-Action" class="headerlink" title="3.2.2 实现一个接口:com.opensyymphony.xwork2.Action"></a>3.2.2 实现一个接口:com.opensyymphony.xwork2.Action</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">package com.struts2.front.action;</div><div class="line"></div><div class="line">import com.opensymphony.xwork2.Action;</div><div class="line"></div><div class="line">public class IndexAction2 implements Action&#123;</div><div class="line">    @Override</div><div class="line">    public String execute() throws Exception &#123;</div><div class="line">        return &quot;success&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该接口有一个抽象方法execute()和五个静态属性：ERROR，SUCCESS， INPUT NONE， LOGIN</p>
<h4 id="3-2-3-继承一个指定的父类ActionSupport"><a href="#3-2-3-继承一个指定的父类ActionSupport" class="headerlink" title="3.2.3 继承一个指定的父类ActionSupport"></a>3.2.3 继承一个指定的父类ActionSupport</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">package com.struts2.front.action;</div><div class="line"></div><div class="line">import com.opensymphony.xwork2.ActionSupport;</div><div class="line"></div><div class="line">public class IndexAction3 extends ActionSupport&#123;</div><div class="line">    @Override</div><div class="line">    public String execute() &#123;</div><div class="line">        return &quot;success&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这种方法是最常用的，继承ActionSupport类，重写execute()方法。实际上ActionSupport实现了Action接口。</p>
<h3 id="3-3-在struts-xml中进行配置"><a href="#3-3-在struts-xml中进行配置" class="headerlink" title="3.3 在struts.xml中进行配置"></a>3.3 在struts.xml中进行配置</h3><p>配置之后，才可以通知struts2框架我们写的这个类是一个Action，将来struts2框架中要给这个类创建对象，调用方法以及这个Action加入更多丰富的功能，注册的实例如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line"></div><div class="line">&lt;!DOCTYPE struts PUBLIC</div><div class="line">        &quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</div><div class="line">        &quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;&gt;</div><div class="line"></div><div class="line">&lt;struts&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;package name=&quot;front&quot; extends=&quot;struts-default&quot; namespace=&quot;/&quot;&gt;</div><div class="line">        &lt;action name=&quot;index&quot; class=&quot;com.struts2.front.action.IndexAction1&quot;&gt;</div><div class="line">            &lt;result name=&quot;success&quot;&gt;/ActionIntroduction.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line">    &lt;/package&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure></p>
<ul>
<li><code>&lt;package&gt;</code>: 一个struts.xml文件中可以配置多个<code>&lt;package&gt;</code>标签，一个<code>&lt;package&gt;</code>标签里面可以配置多个<code>&lt;action&gt;</code>标签，一个<code>&lt;action&gt;</code>标签里面可以配多个<code>&lt;result&gt;</code>标签</li>
<li>name=”front” 表示给当前package起一个名字，唯一标示当前这个package，方便package之间的继承</li>
<li>extends=”struct-default” 表示当前这个package继承了另外一个名字叫做struct-default的package。这个package定义在core包中的struts-default.xml中定义。所有的package都会直接或者间接的继承struts-default这个包，类似java中的Object类。</li>
<li>namespace=”/“ 表示当前package的命名空间为/，以后这个package里面所有的action被访问时候，路径里面都要加上这个命名空间</li>
<li><code>&lt;action&gt;标签属性及其子标签</code>:<blockquote>
<ul>
<li>name=”index” 表示当前配置这个action的名字为index，这个名字是自己定义的，可以和action类的名字相同，同时将来浏览器中的地址栏里面就要出现这个名字来访问当前这个action类</li>
<li>class=”com.struts2.front.action.IndexAction1” 表示当前配置的action对应的是IndexAction1这个类，</li>
<li><code>&lt;result&gt;</code> 标签表示action访问完成之后，根据action返回的字符串的值，跳转不同的页面，默认结果为’success’, 可以省略，一般都是Action接口中的那5个返回值，也可以自己定义。</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="3-4-动态方法调用DMI"><a href="#3-4-动态方法调用DMI" class="headerlink" title="3.4 动态方法调用DMI"></a>3.4 动态方法调用DMI</h3><p>struts2默认调用的是action中的execute方法，实际上我们也可以让其调用其他的方法，首先定义一个类，让其继承ActionSupport类,配置的时候配置其方法，或者不写具体的方法，用DMI的方式进行调用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">package com.struts2.user.action;</div><div class="line"></div><div class="line">import com.opensymphony.xwork2.ActionSupport;</div><div class="line"></div><div class="line">public class UserAction extends ActionSupport&#123;</div><div class="line">    public String add() &#123;</div><div class="line">        return SUCCESS;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>对其进行配置struts2.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;!--&lt;constant name=&quot;struts.enable.DynamicMethodInvocation&quot; value=&quot;true&quot;/&gt;--&gt;</div><div class="line">    &lt;!--允许默认动态方法调用，Struts2默认不支持此功能--&gt;</div><div class="line">    &lt;constant name=&quot;struts.enable.DynamicMethodInvocation&quot; value=&quot;true&quot;/&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;package name=&quot;user&quot; extends=&quot;struts-default&quot; namespace=&quot;/user&quot;&gt;</div><div class="line">        &lt;action name=&quot;userAdd&quot; class=&quot;com.struts2.user.action.UserAction&quot; method=&quot;add&quot;&gt;</div><div class="line">            &lt;result&gt;/user_add_success.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line">        &lt;action name=&quot;user&quot; class=&quot;com.struts2.user.action.UserAction&quot;&gt;</div><div class="line">            &lt;result&gt;/user_add_success.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line">    &lt;/package&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure></p>
<p>其中需要注意的是：</p>
<ul>
<li>struts.enable.DynamicMethodInvocation 默认为false，将其设置为true</li>
<li>配置action的时候，</li>
<li>浏览器中的访问方法为:../user/user!add 动态方法调用， 或者../user/userAdd 都可以成功访问</li>
</ul>
<h3 id="3-5-使用通配符来配置action"><a href="#3-5-使用通配符来配置action" class="headerlink" title="3.5 使用通配符来配置action"></a>3.5 使用通配符来配置action</h3><p>从之前的学习中可以发现，多个action名字或者类的名字是有一定的规律的，比如我们要写两个action， StudentAction， TeacherAction， 每个action有两个方法，add和execute方法，配置的时候可以使用通配符来简化配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;package name=&quot;actions&quot; extends=&quot;struts-default&quot; namespace=&quot;/actions&quot;&gt;</div><div class="line">        &lt;action name=&quot;Student*&quot; class=&quot;com.struts2.action.StudentAction&quot; method=&quot;&#123;1&#125;&quot;&gt;</div><div class="line">            &lt;result&gt;/Student&#123;1&#125;_success.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line"></div><div class="line">        &lt;action name=&quot;*_*&quot; class=&quot;com.struts2.action.&#123;1&#125;Action&quot; method=&quot;&#123;2&#125;&quot; &gt;</div><div class="line">            &lt;result&gt;/&#123;1&#125;_&#123;2&#125;_success.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line">    &lt;/package&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure></p>
<p>其中{1}代表的是前面name属性中的第一个*号的值。这样可以简化配置，如果约定的好的话，整个配置文件可以只配置一个action。但是需要记住一点： <code>约定优于配置！！</code></p>
<h3 id="3-6-action-的特点及其访问"><a href="#3-6-action-的特点及其访问" class="headerlink" title="3.6 action 的特点及其访问"></a>3.6 action 的特点及其访问</h3><h4 id="3-6-1-特点："><a href="#3-6-1-特点：" class="headerlink" title="3.6.1 特点："></a>3.6.1 特点：</h4><ul>
<li>Servlet 是线程不安全的，因为Servlet是单例</li>
<li>struts2 框架中的action是线程安全的，因为每次访问都会创建一个新的Action对象，所有的action里面可以随意定义成员变变量（只有成员变量才有线程安全的问题）<h4 id="3-6-2-访问："><a href="#3-6-2-访问：" class="headerlink" title="3.6.2 访问："></a>3.6.2 访问：</h4>默认情况下，namespace/actionName.action或者namespace/actionName即可访问到action。访问成功会跳转到相应的jsp页面。由于这样会影响对相关Servlet的访问，所有最好默认action访问使用后缀名.action</li>
<li>访问action的时候，action中方法的调用<blockquote>
<ol>
<li>默认情况下，访问action的 时候会调用action的execute（）方法，这个方法执行完返回一个字符串，根据字符串进行跳转</li>
<li>可以在action标签里面添加一个method属性来指明将来访问这个action的时候会调用的方法</li>
<li>地址栏中动态指定调用的方法</li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="3-7-Action接收参数"><a href="#3-7-Action接收参数" class="headerlink" title="3.7 Action接收参数"></a>3.7 Action接收参数</h3><h4 id="3-7-1-同名参数"><a href="#3-7-1-同名参数" class="headerlink" title="3.7.1 同名参数"></a>3.7.1 同名参数</h4><p>例如通过页面将name=a&amp;age=8这个参数传送给action，这时候需要：</p>
<blockquote>
<ul>
<li>action里面定义两个成员变量；name，age</li>
<li>action里面需要提供get/set方法</li>
<li>当页面将参数传送过来的时候，struts2框架会自动帮我们把这两个参数的值放在action中的属性里面，并自动进行了类型转换。从而完成了参数的初始化，实际上这个是有defaultStack这个拦截器栈里面的拦截器来完成的</li>
</ul>
</blockquote>
<p>index.jsp:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;title&gt;$Title$&lt;/title&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">  使用action属性接受参数&lt;a href=&quot;user/user!add?name=a&amp;age=8&quot;&gt;添加用户&lt;/a&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>struts.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot;/&gt;</div><div class="line">    &lt;constant name=&quot;struts.enable.DynamicMethodInvocation&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;package name=&quot;user&quot; extends=&quot;struts-default&quot; namespace=&quot;/user&quot;&gt;</div><div class="line">        &lt;action name=&quot;user&quot; class=&quot;com.struts2.user.action.UserAction&quot;&gt;</div><div class="line">            &lt;result&gt;/user_add_success.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line">    &lt;/package&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure></p>
<p>UserAction:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">package com.struts2.user.action;</div><div class="line"></div><div class="line">import com.opensymphony.xwork2.ActionSupport;</div><div class="line"></div><div class="line">public class UserAction extends ActionSupport&#123;</div><div class="line">    private String name;</div><div class="line">    private int age;</div><div class="line"></div><div class="line">    public String add() &#123;</div><div class="line">        System.out.println(&quot;name = &quot; + name);</div><div class="line">        System.out.println(&quot;age = &quot; + age);</div><div class="line">        return SUCCESS;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public String getName() &#123;</div><div class="line">        return name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setName(String name) &#123;</div><div class="line">        this.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public int getAge() &#123;</div><div class="line">        return age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setAge(int age) &#123;</div><div class="line">        this.age = age;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="3-7-2-DomainModel-域模型"><a href="#3-7-2-DomainModel-域模型" class="headerlink" title="3.7.2 DomainModel 域模型"></a>3.7.2 DomainModel 域模型</h4><p>在接收到的页面传值的时候，可以让struts2框架直接帮我们把这些接收到的值封装到一个JavaBean对象里面：</p>
<ol>
<li>Action中定义一个User类型的变量user，User类中有name，age两个成员变量及其get/set方法</li>
<li>UserAction中提供这个User的get/set方法</li>
<li>页面向Action传递参数的名称要求user.name=1&amp;user.age=23</li>
</ol>
<p>接收到这个参数之后，struts2框架会帮我们去创建一个User队形，并且将所传的参数封装到对象的三个属性中去，最后将这个封装好的对象放到Action中的user属性中去。</p>
<h4 id="3-7-3-模型驱动"><a href="#3-7-3-模型驱动" class="headerlink" title="3.7.3 模型驱动"></a>3.7.3 模型驱动</h4><p>实现ModelDriven接口，没怎么接触，不常用！创建一个User类有name,age两个成员变量，以及一个UserAction类，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class UserAction extends ActionSupport implements ModelDriven&lt;User&gt;&#123;</div><div class="line"></div><div class="line">	private User user = new User();</div><div class="line"></div><div class="line">	public String add() &#123;</div><div class="line">		System.out.println(&quot;name=&quot; + user.getName());</div><div class="line">		System.out.println(&quot;age=&quot; + user.getAge());</div><div class="line">		return SUCCESS;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@Override</div><div class="line">	public User getModel() &#123;</div><div class="line">		return user;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="3-8-简单数据验证"><a href="#3-8-简单数据验证" class="headerlink" title="3.8 简单数据验证"></a>3.8 简单数据验证</h3><p>Action可以进行简单数据验证，这种验证一般不使用UI标签就可以完成，添加addFieldError到页面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public String add() &#123;</div><div class="line">		if(name == null || !name.equals(&quot;admin&quot;)) &#123;</div><div class="line">			this.addFieldError(&quot;name&quot;, &quot;name is error&quot;);</div><div class="line">			this.addFieldError(&quot;name&quot;, &quot;name is too long&quot;);</div><div class="line">			return ERROR;</div><div class="line">		&#125;</div><div class="line">		return SUCCESS;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<h3 id="3-9-访问Web元素"><a href="#3-9-访问Web元素" class="headerlink" title="3.9 访问Web元素"></a>3.9 访问Web元素</h3><p>访问Web元素有四种方法，Map类型的和原始类型的各两种：</p>
<ol>
<li><p>Map类型 依赖于容器：Action初始化的时候生成三个Action容器，获取网页元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public LoginAction1() &#123;</div><div class="line">        request = (Map)ActionContext.getContext().get(&quot;request&quot;);</div><div class="line">        session = ActionContext.getContext().getSession();</div><div class="line">        application = ActionContext.getContext().getApplication();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Map类型 IOC，Action实现了RequestAware,SessionAware, ApplicationAware三个接口,有三个Map类型的成员变量，并重写了成员变量的set方法，struts会自动调用set方法将元素注入到Action中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">public class LoginAction2 extends ActionSupport implements RequestAware, SessionAware, ApplicationAware&#123;</div><div class="line"></div><div class="line">    private Map&lt;String, Object&gt; request;</div><div class="line">    private Map&lt;String, Object&gt; session;</div><div class="line">    private Map&lt;String, Object&gt; application;</div><div class="line"></div><div class="line">    public String execute() &#123;</div><div class="line">        request.put(&quot;r1&quot;, &quot;r1&quot;);</div><div class="line">        session.put(&quot;s1&quot;, &quot;s1&quot;);</div><div class="line">        application.put(&quot;a1&quot;, &quot;a1&quot;);</div><div class="line">        return SUCCESS;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void setApplication(Map&lt;String, Object&gt; application) &#123;</div><div class="line">        this.application = application;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void setRequest(Map&lt;String, Object&gt; request) &#123;</div><div class="line">        this.request = request;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void setSession(Map&lt;String, Object&gt; session) &#123;</div><div class="line">        this.session = session;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>原始类型，IOC,实现了ServletRequestAware接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">public class LoginAction3 extends ActionSupport implements ServletRequestAware&#123;</div><div class="line">    private HttpServletRequest request;</div><div class="line">    private HttpSession session;</div><div class="line">    private ServletContext application;</div><div class="line"></div><div class="line">    public String execute() &#123;</div><div class="line">        request.setAttribute(&quot;r1&quot;, &quot;r1&quot;);</div><div class="line">        session.setAttribute(&quot;s1&quot;, &quot;s1&quot;);</div><div class="line">        application.setAttribute(&quot;a1&quot;, &quot;a1&quot;);</div><div class="line">        return SUCCESS;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void setServletRequest(HttpServletRequest httpServletRequest) &#123;</div><div class="line">        this.request = request;</div><div class="line">        this.session = request.getSession();</div><div class="line">        this.application = session.getServletContext();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>原始类型，依赖容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public class LoginAction4 extends ActionSupport&#123;</div><div class="line">    private HttpServletRequest request;</div><div class="line">    private HttpSession session;</div><div class="line">    private ServletContext application;</div><div class="line"></div><div class="line">    public LoginAction4() &#123;</div><div class="line">        request = ServletActionContext.getRequest();</div><div class="line">        session = request.getSession();</div><div class="line">        application = session.getServletContext();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public String execute() &#123;</div><div class="line">        request.setAttribute(&quot;r1&quot;, &quot;r1&quot;);</div><div class="line">        session.setAttribute(&quot;s1&quot;, &quot;s1&quot;);</div><div class="line">        application.setAttribute(&quot;a1&quot;, &quot;a1&quot;);</div><div class="line">        return SUCCESS;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>原类型和map类型的关系<blockquote>
<ol>
<li>使用Map类型的对象，可以降低对ServletAPI的依赖</li>
<li>我们使用元类型大多时候也是存值和取值，原来性里面本身也封装了Map对象，使用Map类型对象也可以完成存值和取值</li>
<li>map类型的request对象里面的k-v值是复制原类型request对象的键值对的，元类型的request对象中还包含其他的属性和方法。</li>
<li>原类型和Map类型的Request对象是相同的 ，可以互相读取值，session和application也一样。</li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="3-10-包含文件配置"><a href="#3-10-包含文件配置" class="headerlink" title="3.10 包含文件配置"></a>3.10 包含文件配置</h3><p>struts2支持配置文件之间的继承，通过include标签完成，相当于将include内容复制到include的位置：</p>
<ul>
<li><p>struts.xml:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</div><div class="line">    &lt;include file=&quot;login.xml&quot; /&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>login.xml:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;struts&gt;</div><div class="line">    &lt;package name=&quot;login&quot; extends=&quot;struts-default&quot; namespace=&quot;/login&quot;&gt;</div><div class="line">        &lt;action name=&quot;login*&quot; class=&quot;com.bjsxt.struts2.user.action.LoginAction&#123;1&#125;&quot;&gt;</div><div class="line">            &lt;result&gt;/user_login_success.jsp&lt;/result&gt;</div><div class="line">        &lt;/action&gt;</div><div class="line">    &lt;/package&gt;</div><div class="line">&lt;/struts&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-11-默认Action处理"><a href="#3-11-默认Action处理" class="headerlink" title="3.11 默认Action处理"></a>3.11 默认Action处理</h3><p>当struts中没有找到请求的Action的时候会报错，我们可以设置一个默认的Action，当找不到请求的action的时候访问这个特定的Action，使得用户体验更加友好。在package中配置一条语句就可以完成：</p>
<ul>
<li><code>&lt;default-action-ref name=&quot;index&quot;&gt;&lt;/default-action-ref&gt;</code></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/06/struts2总结 一--简介和Action/" data-id="cj7a8wvok00009sv2y0hrqxfu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/06/hello-world/" class="article-date">
  <time datetime="2017-09-06T06:37:08.979Z" itemprop="datePublished">2017-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/06/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/06/hello-world/" data-id="cj7a8wvop00019sv2vt1og0gx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/09/07/struts2总结 五--interceptor拦截器/">struts2总结（五）--intercept</a>
          </li>
        
          <li>
            <a href="/2017/09/07/struts2总结 四--异常处理和I18N/">struts2总结（三）--Struts Tags</a>
          </li>
        
          <li>
            <a href="/2017/09/07/struts2总结 六--struts2项目开发流程/">struts2总结（三）--Struts Tags</a>
          </li>
        
          <li>
            <a href="/2017/09/07/struts2总结 二--Result和OGNL表达式/">struts2总结（二）--Result和OGNL表达式</a>
          </li>
        
          <li>
            <a href="/2017/09/07/struts2总结 三--Struts Tags/">struts2总结（三）--Struts Tags</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>