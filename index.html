<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="Be a better man!">
<meta property="og:type" content="website">
<meta property="og:title" content="小黄">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="小黄">
<meta property="og:description" content="Be a better man!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小黄">
<meta name="twitter:description" content="Be a better man!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>小黄</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小黄</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">黄小黄的幸福生活！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-java">
          <a href="/Java/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Java
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/17/ActiveMQ学习总结（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/17/ActiveMQ学习总结（一）/" itemprop="url">ActiveMQ学习总结（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-17T19:10:14+08:00">
                2018-04-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JMS/" itemprop="url" rel="index">
                    <span itemprop="name">JMS</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JMS/ActiveMQ/" itemprop="url" rel="index">
                    <span itemprop="name">ActiveMQ</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自己写的网上商城项目中使用了ActiveMQ，虽然相比于RabbitMQ，kafka，RocketMQ等相比，ActiveMQ可能性能方面不是最好的选择，不过消息队列其实原理区别不大，这里对学过的关于消息队列的知识进行一下总结，并结合自己面试中关于这方面遇到的问题做一个整理，为后面秋招找工作做准备。这一篇主要介绍一下JMS，ActiveMQ安装及其常用接口，两种队列模式，如何集成到Spring项目，面试总结等。</p>
<h1 id="JMS"><a href="#JMS" class="headerlink" title="JMS"></a>JMS</h1><ul>
<li><p>Java Message Service，Java消息服务应用程序接口，是一个Java平台中关于面向消息中间件（MOM）的API，用于在两个程序之间，或分布式系统中发送消息，进行异步通信，JMS是一个与具体平台无关的API，绝大多数MOM提供商都对JMS提供支持。这是比较详细的关于JMS的定义，而比较直观的说，JMS是一组消息服务的API，也就是说JMS只有接口，其具体实现类交给了各种MOM厂家来做。</p>
</li>
<li><p>JMS使用场景，应用程序A部署在北京，应用程序B部署在上海，每当A触发某个事件之后，B向获取A中的一些信息，也可能有很多个B都想获取A中的信息。这种情况下，Java提供了最佳的解决方案-JMS。JMS同样适用于基于事件的应用程序，如聊天服务，他需要一种发布事件机制向所有与服务器连接的客户端发送消息。JMS与RMI不同，不需要接受者在线。也就是服务器发送完消息，这个事件就与他无关了。</p>
</li>
<li><p>JMS的优势：</p>
<ul>
<li>异步，JMS天生就是异步的，客户端获取消息的时候，不需要主动发送请求，消息会自动发送给可用的客户端。</li>
<li>可靠，JMS保证消息只会被递送一次。大家都遇到过重复创建消息的问题，JMS可以帮你避免这个问题，但是不能杜绝，需要MOM厂家来做更加完备的机制来改善。</li>
</ul>
</li>
<li><p>JMS常用的一些概念：</p>
<ul>
<li>Provider/MessageProvider：生产者</li>
<li>Consumer/MessageConsumer：消费者</li>
<li>PTP：Point To Point，点对点通信消息模型</li>
<li>Pub/Sub：Publish/Subscribe，发布订阅消息模型</li>
<li>Queue：队列，目标类型之一，和PTP结合</li>
<li>Topic：主题，目标类型之一，和Pub/Sub结合</li>
<li>ConnectionFactory：连接工厂，JMS用它创建连接</li>
<li>Connnection：JMS Client到JMS Provider的连接</li>
<li>Destination：消息目的地，由Session创建</li>
<li>Session：会话，由Connection创建，实质上就是发送、接受消息的一个线程，因此生产者、消费者都是Session创建的</li>
</ul>
</li>
</ul>
<h1 id="ActiveMQ简介"><a href="#ActiveMQ简介" class="headerlink" title="ActiveMQ简介"></a>ActiveMQ简介</h1><p>ActiveMQ是Apache出品的，最流行的，能力强劲的开源消息总线。ActiveMQ是一个完全支持JMS1.1和J2EE1.4规范的JMS Provider实现，JMS上面已经有了简单的介绍。</p>
<h2 id="ActiveMQ的特点："><a href="#ActiveMQ的特点：" class="headerlink" title="ActiveMQ的特点："></a>ActiveMQ的特点：</h2><ul>
<li>多种语言和协议编写客户端，语言包括Java、C、C++、C#、Ruby、Perl、Python、PHP，协议包括OpenWire、Stomp、REST、WS Notification、XMPP、AMQP</li>
<li>完全支持JMS1.1和J2EE1.4规范</li>
<li>对Spring的支持，使得ActiveMQ集成到Spring里面很方便</li>
<li>支持多种传送协议：in-VM、TCP、SSL、NIO、UDP、JGroups、JXTA</li>
<li>支持通过JDBC和journal提供高速的消息持久化</li>
<li>从设计上保证了高性能的集群，客户端-服务器点对点</li>
<li>支持Ajax</li>
<li>支持与Axis的整合</li>
</ul>
<h2 id="ActiveMQ的消息形式"><a href="#ActiveMQ的消息形式" class="headerlink" title="ActiveMQ的消息形式"></a>ActiveMQ的消息形式</h2><ul>
<li><p>点对点，也就是一个省车按着对一个消费者的一对一</p>
</li>
<li><p>发布/订阅模式，一个生产者产生消息并进行发送后，可以由多个消费者进行接收</p>
</li>
</ul>
<p>JMS中定义了五种不同的消息正文格式以及调用的消息信息，允许你发送并接收以一些不同形式的数据：</p>
<pre><code>* StreamMessage --- 数据流
* MapMessage --- key-value
* TextMessage --- 字符串
* ObjectMessage --- 序列化的Java对象
* BytesMessage --- 一个字节的数据流
</code></pre><h2 id="ActiveMQ的安装"><a href="#ActiveMQ的安装" class="headerlink" title="ActiveMQ的安装"></a>ActiveMQ的安装</h2><ol>
<li>activemq.apache.org下载ActiveMQ</li>
<li>解压缩</li>
<li>启动， ./activemq start， 关闭 ./activemq stop, 查看状态 ./activemq status</li>
</ol>
<p>后台管理页面：<a href="http://192.168.25.168:8161/admin，" target="_blank" rel="external">http://192.168.25.168:8161/admin，</a> 用户名admin，密码admin</p>
<h1 id="ActiveMQ的使用"><a href="#ActiveMQ的使用" class="headerlink" title="ActiveMQ的使用"></a>ActiveMQ的使用</h1><p>添加jar包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;!--引入ActiveMQ的jar包--&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;activemq-all&lt;/artifactId&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure>
<h2 id="使用Queue形式的消息队列"><a href="#使用Queue形式的消息队列" class="headerlink" title="使用Queue形式的消息队列"></a>使用Queue形式的消息队列</h2><h3 id="Producer"><a href="#Producer" class="headerlink" title="Producer"></a>Producer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * ActiveMQ队列模式生产者</div><div class="line"> * @throws JMSException</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testQueueProducer() throws JMSException &#123;</div><div class="line">    //1.创建一个连接工厂对象、需要指定IP和端口/消息服务端口为61616</div><div class="line">    ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;tcp://192.168.25.128:61616&quot;);</div><div class="line">    //2.使用连接工厂来创建连接</div><div class="line">    Connection connection = connectionFactory.createConnection();</div><div class="line">    //3.开启连接</div><div class="line">    connection.start();</div><div class="line">    //4.创建一个会话，</div><div class="line">    //第一个参数为是否开启ActiveMQ的事务，一般不使用事务</div><div class="line">    //如果开启事务，第二个参数自动忽略，不开启事务，第二个参数表示消息的应答模式，自动应答、手动应答</div><div class="line">    Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);</div><div class="line">    //5.使用Session对象来创建一个Destination对象，topic或者queue</div><div class="line">    Queue queue = session.createQueue(&quot;test-Queue&quot;);</div><div class="line">    //6.使用Session对象来创建一个生产者</div><div class="line">    MessageProducer producer = session.createProducer(queue);</div><div class="line">    //7.创建一个TextMessage对象</div><div class="line">    TextMessage textMessage = new ActiveMQTextMessage();</div><div class="line">    textMessage.setText(&quot;hello!&quot;);</div><div class="line">    //8.发送消息</div><div class="line">    producer.send(textMessage);</div><div class="line">    //9.关闭资源</div><div class="line">    producer.close();</div><div class="line">    session.close();</div><div class="line">    connection.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看出生产者和消费者之间传递的对象，由三个主要部分构成：消息头+消息属性+消息体。当然创建过程中也可以对消息进行持久化的选择等配置。</p>
<h3 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * ActiveMQ队列模式消费者</div><div class="line"> * @throws JMSException</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testQueueConsumer() throws JMSException, IOException &#123;</div><div class="line">    //1.创建一个连接工厂对象、需要指定IP和端口/消息服务端口为61616</div><div class="line">    ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;tcp://192.168.25.128:61616&quot;);</div><div class="line">    //2.使用连接工厂来创建连接</div><div class="line">    Connection connection = connectionFactory.createConnection();</div><div class="line">    //3.开启连接</div><div class="line">    connection.start();</div><div class="line">    //4.创建一个会话，</div><div class="line">    //第一个参数为是否开启ActiveMQ的事务，一般不使用事务</div><div class="line">    //如果开启事务，第二个参数自动忽略，不开启事务，第二个参数表示消息的应答模式，自动应答、手动应答</div><div class="line">    Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);</div><div class="line">    //5.使用Session对象来创建一个Destination对象，topic或者queue</div><div class="line">    Queue queue = session.createQueue(&quot;test-Queue&quot;);</div><div class="line">    //6.使用Session对象来创建一个消费者</div><div class="line">    MessageConsumer consumer = session.createConsumer(queue);</div><div class="line">    //7.接收消息</div><div class="line">    consumer.setMessageListener(new MessageListener() &#123;</div><div class="line">        @Override</div><div class="line">        public void onMessage(Message message) &#123;</div><div class="line">            TextMessage textMessage = (TextMessage) message;</div><div class="line">            String text = null;</div><div class="line">            try &#123;</div><div class="line">                text = textMessage.getText();</div><div class="line">            &#125; catch (JMSException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            System.out.println(text);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    //8.关闭资源</div><div class="line">    System.in.read();</div><div class="line">    consumer.close();</div><div class="line">    session.close();</div><div class="line">    connection.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注释基本解释清楚了基本的流程，唯一要注意的是接收消息的时候，我们先查看setMessageListener这个方法,其接口定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">void setMessageListener(MessageListener var1) throws JMSException;</div></pre></td></tr></table></figure>
<p>也就是说需要传入一个实现了MessageListener接口的对象，而MessageListener接口如下只有一个onMessage方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">package javax.jms;</div><div class="line"></div><div class="line">public interface MessageListener &#123;</div><div class="line">    void onMessage(Message var1);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>采用匿名类的方法来对test-Queue队列进行监控，只要有消息进来，就立即执行onMessage方法。</p>
<h2 id="Topic模式"><a href="#Topic模式" class="headerlink" title="Topic模式"></a>Topic模式</h2><h3 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * ActiveMQ的订阅模式生产者</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testTopicProducer() throws Exception &#123;</div><div class="line">    ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;tcp://192.168.25.128:61616&quot;);</div><div class="line">    Connection connection = connectionFactory.createConnection();</div><div class="line">    connection.start();</div><div class="line">    Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);</div><div class="line">    Topic topic = session.createTopic(&quot;test-topic&quot;);</div><div class="line">    MessageProducer producer = session.createProducer(topic);</div><div class="line">    TextMessage activeMQ_topic = session.createTextMessage(&quot;activeMQ topic&quot;);</div><div class="line">    producer.send(activeMQ_topic);</div><div class="line"></div><div class="line">    producer.close();</div><div class="line">    session.close();</div><div class="line">    connection.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>和队列模式相比，只是由session生成的消息队列模式编程了订阅发布模式，其他完全一样。</p>
<h3 id="Consumer-1"><a href="#Consumer-1" class="headerlink" title="Consumer"></a>Consumer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * ActiveMQ的订阅者模式消费者</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testTopicConsumer() throws Exception&#123;</div><div class="line">    ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;tcp://192.168.25.128:61616&quot;);</div><div class="line">    Connection connection = connectionFactory.createConnection();</div><div class="line">    connection.start();</div><div class="line">    Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);</div><div class="line">    Topic topic = session.createTopic(&quot;test-topic&quot;);</div><div class="line">    MessageConsumer consumer = session.createConsumer(topic);</div><div class="line">    consumer.setMessageListener(new MessageListener() &#123;</div><div class="line">        @Override</div><div class="line">        public void onMessage(Message message) &#123;</div><div class="line">            if (message instanceof TextMessage) &#123;</div><div class="line">                TextMessage textMessage = (TextMessage) message;</div><div class="line">                try &#123;</div><div class="line">                    String text = textMessage.getText();</div><div class="line">                    System.out.println(text);</div><div class="line">                &#125; catch (JMSException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    System.in.read();</div><div class="line">    consumer.close();</div><div class="line">    session.close();</div><div class="line">    connection.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="ActiveMQ在Spring中的使用"><a href="#ActiveMQ在Spring中的使用" class="headerlink" title="ActiveMQ在Spring中的使用"></a>ActiveMQ在Spring中的使用</h1><p>上一节介绍的在项目中直接使用消息队列的方式，可以看出存在很大的重复代码，而且步骤很多，将ActiveMQ整合到Spring中可以大大改善这两个问题。</p>
<ol>
<li>引入JMS相关jar包</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;spring-jms&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure>
<ol>
<li>配置ActiveMQ整合Spring，配置ConnectionFactory</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;!--ConnectionFactory,JMS服务厂商提供的ConnectionFactory--&gt;</div><div class="line">&lt;bean id=&quot;targetConnecctionFactory&quot; class=&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;&gt;</div><div class="line">    &lt;constructor-arg name=&quot;brokerURL&quot; value=&quot;tcp://192.168.25.128:61616&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;!--spring对ConnectionFactory的封装--&gt;</div><div class="line">&lt;bean id=&quot;connectionFactory&quot; class=&quot;org.springframework.jms.connection.SingleConnectionFactory&quot;&gt;</div><div class="line">    &lt;property name=&quot;targetConnectionFactory&quot; ref=&quot;targetConnecctionFactory&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<ol>
<li>配置生产者，使用JMSTemplate对象，发送消息</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!--配置JMSTemplate--&gt;</div><div class="line">&lt;bean id=&quot;jmsTemplate&quot; class=&quot;org.springframework.jms.core.JmsTemplate&quot;&gt;</div><div class="line">    &lt;property name=&quot;connectionFactory&quot; ref=&quot;connectionFactory&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<ol>
<li>配置Destination</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;!--消息的目的地--&gt;</div><div class="line">&lt;bean id=&quot;test-queue&quot; class=&quot;org.apache.activemq.command.ActiveMQQueue&quot;&gt;</div><div class="line">    &lt;constructor-arg name=&quot;name&quot; value=&quot;test-queue&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;bean id=&quot;item-add-topic&quot; class=&quot;org.apache.activemq.command.ActiveMQTopic&quot;&gt;</div><div class="line">    &lt;constructor-arg name=&quot;name&quot; value=&quot;item-add-topic&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<ul>
<li>完整的配置文件：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</div><div class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</div><div class="line">       xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</div><div class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd</div><div class="line">	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd</div><div class="line">	http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.2.xsd</div><div class="line">	http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd&quot;&gt;</div><div class="line"></div><div class="line">    &lt;!--ConnectionFactory,JMS服务厂商提供的ConnectionFactory--&gt;</div><div class="line">    &lt;bean id=&quot;targetConnecctionFactory&quot; class=&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;&gt;</div><div class="line">        &lt;constructor-arg name=&quot;brokerURL&quot; value=&quot;tcp://192.168.25.128:61616&quot;/&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">    &lt;!--spring对ConnectionFactory的封装--&gt;</div><div class="line">    &lt;bean id=&quot;connectionFactory&quot; class=&quot;org.springframework.jms.connection.SingleConnectionFactory&quot;&gt;</div><div class="line">        &lt;property name=&quot;targetConnectionFactory&quot; ref=&quot;targetConnecctionFactory&quot;/&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">    &lt;!--配置JMSTemplate--&gt;</div><div class="line">    &lt;bean id=&quot;jmsTemplate&quot; class=&quot;org.springframework.jms.core.JmsTemplate&quot;&gt;</div><div class="line">        &lt;property name=&quot;connectionFactory&quot; ref=&quot;connectionFactory&quot;/&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">    &lt;!--消息的目的地--&gt;</div><div class="line">    &lt;bean id=&quot;test-queue&quot; class=&quot;org.apache.activemq.command.ActiveMQQueue&quot;&gt;</div><div class="line">        &lt;constructor-arg name=&quot;name&quot; value=&quot;test-queue&quot;/&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">    &lt;bean id=&quot;item-add-topic&quot; class=&quot;org.apache.activemq.command.ActiveMQTopic&quot;&gt;</div><div class="line">        &lt;constructor-arg name=&quot;name&quot; value=&quot;item-add-topic&quot;/&gt;</div><div class="line">    &lt;/bean&gt;</div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><ol>
<li>发送消息，步骤注释中写的很清楚了，</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 使用JMSTemplate来发送消息</div><div class="line"> * @throws Exception</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testJmsTemplate() throws Exception &#123;</div><div class="line">    //初始化Spring容器</div><div class="line">    ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring/applicationContext-activemq.xml&quot;);</div><div class="line">    //从容器中获得模板对象</div><div class="line">    JmsTemplate jmsTemplate = applicationContext.getBean(JmsTemplate.class);</div><div class="line">    //从容器中获得Destination对象</div><div class="line">    Destination destination = (Destination) applicationContext.getBean(&quot;test-queue&quot;);</div><div class="line">    //发送消息</div><div class="line">    jmsTemplate.send(destination, new MessageCreator() &#123;</div><div class="line">        @Override</div><div class="line">        public Message createMessage(Session session) throws JMSException &#123;</div><div class="line">            return session.createTextMessage(&quot;spring activemq send queue message&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>接收消息</li>
</ol>
<p>由于项目中使用ActiveMQ实现索引库和数据库的同步，为了接收ActiveMQ的消息，需要创建一个MessageListener实现类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 接收ActiveMQ发送的消息</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/3/9</div><div class="line"> */</div><div class="line">public class MyMesseageListener implements MessageListener&#123;</div><div class="line">    @Override</div><div class="line">    public void onMessage(Message message) &#123;</div><div class="line">        //接收消息</div><div class="line">        try &#123;</div><div class="line">            TextMessage textMessage = (TextMessage) message;</div><div class="line">            String text = textMessage.getText();</div><div class="line">            System.out.println(text);</div><div class="line">        &#125; catch (JMSException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后在Spring中整合ActiveMQ的消息监听器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;!--ConnectionFactory,JMS服务厂商提供的ConnectionFactory--&gt;</div><div class="line">&lt;bean id=&quot;targetConnecctionFactory&quot; class=&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;&gt;</div><div class="line">    &lt;constructor-arg name=&quot;brokerURL&quot; value=&quot;tcp://192.168.25.128:61616&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;!--spring对ConnectionFactory的封装--&gt;</div><div class="line">&lt;bean id=&quot;connectionFactory&quot; class=&quot;org.springframework.jms.connection.SingleConnectionFactory&quot;&gt;</div><div class="line">    &lt;property name=&quot;targetConnectionFactory&quot; ref=&quot;targetConnecctionFactory&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;!--消息的目的地--&gt;</div><div class="line">&lt;bean id=&quot;test-queue&quot; class=&quot;org.apache.activemq.command.ActiveMQQueue&quot;&gt;</div><div class="line">    &lt;constructor-arg name=&quot;name&quot; value=&quot;test-queue&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;bean id=&quot;item-add-topic&quot; class=&quot;org.apache.activemq.command.ActiveMQTopic&quot;&gt;</div><div class="line">    &lt;constructor-arg name=&quot;name&quot; value=&quot;item-add-topic&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;!--配置消息的接受者--&gt;</div><div class="line">&lt;!--配置监听器--&gt;</div><div class="line">&lt;bean id=&quot;messeageListener&quot; class=&quot;com.market.search.listen.MyMesseageListener&quot;/&gt;</div><div class="line">&lt;!--消息监听容器--&gt;</div><div class="line">&lt;bean class=&quot;org.springframework.jms.listener.DefaultMessageListenerContainer&quot;&gt;</div><div class="line">    &lt;property name=&quot;connectionFactory&quot; ref=&quot;connectionFactory&quot;/&gt;</div><div class="line">    &lt;property name=&quot;destination&quot; ref=&quot;test-queue&quot;/&gt;</div><div class="line">    &lt;property name=&quot;messageListener&quot; ref=&quot;messeageListener&quot;/&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<p>测试代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testQueueConsumer() throws Exception &#123;</div><div class="line">    //初始化Spring容器</div><div class="line">    ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;spring/applicationContext-activemq.xml&quot;);</div><div class="line">    System.in.read();</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/17/Dubbo框架学习总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/17/Dubbo框架学习总结/" itemprop="url">Dubbo框架学习总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-17T09:15:00+08:00">
                2018-04-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Dubbo/" itemprop="url" rel="index">
                    <span itemprop="name">Dubbo</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Dubbo/RPC/" itemprop="url" rel="index">
                    <span itemprop="name">RPC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Dubbo的定义"><a href="#Dubbo的定义" class="headerlink" title="Dubbo的定义"></a>Dubbo的定义</h1><p>官方定义：Apache Dubbo是一个由阿里提供开源的基于Java的高性能的RPC框架。遵循RPC框架的设计原则，Dubbo也定义了服务的概念，可以远程根据参数和返回值来调用具体的方法。在服务侧，服务侧实现这个接口并运行一个Dubbo服务来处理客户端的请求，在客户端保存有服务端相同的方法存根。</p>
<p>Dubbo有三个主要特性：</p>
<ul>
<li>基于接口的远程的调用</li>
<li>容错和负载均衡</li>
<li>服务的子自动注册和发现。</li>
</ul>
<p>Dubbo相关的文档：<br><a href="http://dubbo.apache.org/books/dubbo-user-book/preface/background.html" target="_blank" rel="external">Dubbo用户手册</a><br><a href="http://dubbo.apache.org/books/dubbo-dev-book/build.html" target="_blank" rel="external">Dubbo开发手册</a><br><a href="http://dubbo.apache.org/books/dubbo-admin-book/install/zookeeper.html" target="_blank" rel="external">Dubbo管理手册</a><br><a href="https://github.com/apache/incubator-dubbo" target="_blank" rel="external">Dubbo GitHub </a></p>
<h1 id="Dubbo结构"><a href="#Dubbo结构" class="headerlink" title="Dubbo结构"></a>Dubbo结构</h1><p><img src="/img/Dubbo-Arch.png" alt="Alt text"></p>
<ol>
<li>服务提供者-对外暴露自己的服务，服务提供者会将自己提供的服务注册到注册中心</li>
<li>容器-初始化服务，加载服务，运行服务</li>
<li>服务消费者-调用远程服务，会向注册中心订阅他需要的服务。</li>
<li>注册中心-服务注册与发现</li>
<li>监控中心-记录服务相关的数据，比如服务的调用频率，调用次数等</li>
</ol>
<p><em>服务提供者，服务消费者和注册中心的连接是持久的，所以当一个服务提供者挂掉之后，注册中心可以检测到服务提供者的失效并将此信息通知给服务消费者</em></p>
<p><em>注册中心和监控中心是可选的，服务消费者可以直接连接到服务提供者，但是这样会影响整个系统的稳定性，不推荐直接连接</em></p>
<h2 id="调用关系说明"><a href="#调用关系说明" class="headerlink" title="调用关系说明"></a>调用关系说明</h2><ol>
<li>服务容器负责启动，加载，运行服务提供者。</li>
<li>服务提供者在启动时，向注册中心注册自己提供的服务。</li>
<li>服务消费者在启动时，向注册中心订阅自己需要的服务。</li>
<li>注册中心返回服务提供者列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</li>
<li>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者经调用，如果调用失败，再选一台调用。</li>
<li>服务消费者和提供者，在内存中累积调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</li>
</ol>
<h2 id="Dubbo架构的特点"><a href="#Dubbo架构的特点" class="headerlink" title="Dubbo架构的特点"></a>Dubbo架构的特点</h2><h3 id="连通性"><a href="#连通性" class="headerlink" title="连通性"></a>连通性</h3><ul>
<li>注册中心负责服务地址的注册于查找，相当于目录服务，服务提供者和消费者只在启动时与注册中心交互，注册中心不转发消息，压力较小。</li>
<li>监控中心负责统计各服务调用次数，调用时间等，统计先在内存汇总后每分钟一次发送到监控中心服务器，并以报表展示。</li>
<li>服务提供者向注册中心注册其提供的服务，并汇报调用时间到监控中心，此时间不包含网络开销。</li>
<li>服务消费者向注册中心获取服务提供者地址列表，并根据负载算法直接调用提供者，同时汇报调用时间到监控中心，此时间包含网络开销。</li>
<li>注册中心，服务提供者，服务消费者三者之间均为长连接，监控中心不是。</li>
<li>注册中心通过长连接感知服务提供者的存在，服务提供者宕机，注册中心将立即推送事件通知消费者。</li>
<li>注册中心和监控中心全部宕机，不影响已运行的提供者和消费者，消费者在本地魂村了提供者列表。</li>
<li>注册中心和监控中心都是可选的，服务消费者可以直连服务提供者。</li>
</ul>
<h3 id="健壮性"><a href="#健壮性" class="headerlink" title="健壮性"></a>健壮性</h3><ul>
<li>监控中心宕机不影响使用，只是丢失部分统计数据。</li>
<li>数据库宕机，注册中心仍能通过缓存提供服务列表查询，但不能注册新服务</li>
<li>注册中心对等集群，任意一台宕机之后，将自动切换到另一台</li>
<li>注册中心全部宕机后，服务提供者和服务消费者仍能通过本地换粗通讯</li>
<li>服务提供者无状态，任意一台宕机后，不影响使用。</li>
<li>服务提供者全部宕机之后，服务消费者应用将无法使用，并无限次重连等待服务提供者回复。</li>
</ul>
<h3 id="伸缩性"><a href="#伸缩性" class="headerlink" title="伸缩性"></a>伸缩性</h3><ul>
<li>注册中心为了对等集群，可动态增加机器部署实例，所有客户端将自动发现新的注册中心</li>
<li>服务提供者无状态，可动态增加及其部署实例，注册中心将推送新的服务提供者信息给消费者。</li>
</ul>
<h3 id="升级性"><a href="#升级性" class="headerlink" title="升级性"></a>升级性</h3><ul>
<li>当服务集群规模进一步扩大，带动IT治理结构进一步升级，需要实现动态部署，进行流动计算，现有的分布式架构不会带来阻力，下图为一种可能结果：</li>
</ul>
<p><img src="/img/Dubbo-Futurearch.png" alt="Alt text"></p>
<h1 id="Dubbo依赖要求"><a href="#Dubbo依赖要求" class="headerlink" title="Dubbo依赖要求"></a>Dubbo依赖要求</h1><ul>
<li><p>工具版本要求：</p>
<ul>
<li>JDK：6及以上</li>
<li>Maven：3及以上</li>
</ul>
</li>
<li><p>Maven依赖配置：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;dubbo&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;$&#123;dubbo.version&#125;&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure>
<ul>
<li>Dubbo缺省依赖以下库：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[INFO] +- com.alibaba:dubbo:jar:2.5.9-SNAPSHOT:compile</div><div class="line">[INFO] |  +- org.springframework:spring-context:jar:4.3.10.RELEASE:compile</div><div class="line">[INFO] |  +- org.javassist:javassist:jar:3.21.0-GA:compile</div><div class="line">[INFO] |  \- org.jboss.netty:netty:jar:3.2.5.Final:compile</div></pre></td></tr></table></figure>
<ul>
<li>可选依赖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">netty-all 4.0.35.Final</div><div class="line">mina: 1.1.7</div><div class="line">grizzly: 2.1.4</div><div class="line">httpclient: 4.5.3</div><div class="line">hessian_lite: 3.2.1-fixed</div><div class="line">fastjson: 1.2.31</div><div class="line">zookeeper: 3.4.9</div><div class="line">jedis: 2.9.0</div><div class="line">xmemcached: 1.3.6</div><div class="line">hessian: 4.0.38</div><div class="line">jetty: 6.1.26</div><div class="line">hibernate-validator: 5.4.1.Final</div><div class="line">zkclient: 0.2</div><div class="line">curator: 2.12.0</div><div class="line">cxf: 3.0.14</div><div class="line">thrift: 0.8.0</div><div class="line">servlet: 3.0 6</div><div class="line">validation-api: 1.1.0.GA 6</div><div class="line">jcache: 1.0.0 6</div><div class="line">javax.el: 3.0.1-b08 6</div><div class="line">kryo: 4.0.1</div><div class="line">kryo-serializers: 0.42</div><div class="line">fst: 2.48-jdk-6</div><div class="line">resteasy: 3.0.19.Final</div><div class="line">tomcat-embed-core: 8.0.11</div><div class="line">slf4j: 1.7.25</div><div class="line">log4j: 1.2.16</div></pre></td></tr></table></figure>
<h2 id="Spring中Dubbo应用示例"><a href="#Spring中Dubbo应用示例" class="headerlink" title="Spring中Dubbo应用示例"></a>Spring中Dubbo应用示例</h2><ul>
<li>定义服务接口：由于服务的提供者和消费者都依赖于同一个接口，因此强烈建议将接口定义在一个单独的模块里面，从而方便服务提供者模块和消费者模块来依赖。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">package com.alibaba.dubbo.demo;</div><div class="line"></div><div class="line">public interface DemoService &#123;</div><div class="line">    String sayHello(String name);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>实现服务的提供者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">package com.alibaba.dubbo.demo.provider;</div><div class="line">import com.alibaba.dubbo.demo.DemoService;</div><div class="line"></div><div class="line">public class DemoServiceImpl implements DemoService &#123;</div><div class="line">    public String sayHello(String name) &#123;</div><div class="line">        return &quot;Hello &quot; + name;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>配置服务的提供者–在spring中如何配置Dubbo服务。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</div><div class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">    xmlns:dubbo=&quot;http://code.alibabatech.com/schema/dubbo&quot;</div><div class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;&gt;</div><div class="line"></div><div class="line">    &lt;!-- 提供方应用信息，用于计算依赖关系 --&gt;</div><div class="line">    &lt;dubbo:application name=&quot;hello-world-app&quot;  /&gt;</div><div class="line"></div><div class="line">    &lt;!-- 使用multicast广播注册中心暴露服务地址 --&gt;</div><div class="line">    &lt;dubbo:registry address=&quot;multicast://224.5.6.7:1234&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;!-- 用dubbo协议在20880端口暴露服务 --&gt;</div><div class="line">    &lt;dubbo:protocol name=&quot;dubbo&quot; port=&quot;20880&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;!-- 声明需要暴露的服务接口 --&gt;</div><div class="line">    &lt;dubbo:service interface=&quot;com.alibaba.dubbo.demo.DemoService&quot; ref=&quot;demoService&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;!-- 和本地bean一样实现服务 --&gt;</div><div class="line">    &lt;bean id=&quot;demoService&quot; class=&quot;com.alibaba.dubbo.demo.provider.DemoServiceImpl&quot; /&gt;</div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<p>从配置文件中可以看到我们只将demoService的接口暴露给一个URL，dubbo://127.0.0.1:20880,并将该服务注册给一个多媒体地址：multicast://224.5.6.7:1234</p>
<p>dubbo协议是Dubbo框架支持的众多协议之一，dubbo协议是在Java NIO特性的基础之上的，为Dubbo架构的默认协议。</p>
<ul>
<li>开启服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"></div><div class="line">public class Provider &#123;</div><div class="line">    public static void main(String[] args) throws Exception &#123;</div><div class="line">        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(</div><div class="line">                new String[] &#123;&quot;META-INF/spring/dubbo-demo-provider.xml&quot;&#125;);</div><div class="line">        context.start();</div><div class="line">        // press any key to exit</div><div class="line">        System.in.read();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>配置服务消费者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</div><div class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">    xmlns:dubbo=&quot;http://code.alibabatech.com/schema/dubbo&quot;</div><div class="line">    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;&gt;</div><div class="line"></div><div class="line">    &lt;!-- 消费方应用名，用于计算依赖关系，不是匹配条件，不要与提供方一样 --&gt;</div><div class="line">    &lt;dubbo:application name=&quot;consumer-of-helloworld-app&quot;  /&gt;</div><div class="line"></div><div class="line">    &lt;!-- 使用multicast广播注册中心暴露发现服务地址 --&gt;</div><div class="line">    &lt;dubbo:registry address=&quot;multicast://224.5.6.7:1234&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;!-- 生成远程服务代理，可以和本地bean一样使用demoService --&gt;</div><div class="line">    &lt;dubbo:reference id=&quot;demoService&quot; interface=&quot;com.alibaba.dubbo.demo.DemoService&quot; /&gt;</div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure>
<p>这个过程看起来和传统的web服务调用很想，但是dubbo协议使得其调用更加简单，轻量化，效率相对要高。</p>
<ul>
<li>运行服务消费者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line">import com.alibaba.dubbo.demo.DemoService;</div><div class="line"></div><div class="line">public class Consumer &#123;</div><div class="line">    public static void main(String[] args) throws Exception &#123;</div><div class="line">        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(new String[] &#123;&quot;http://10.20.160.198/wiki/display/dubbo/consumer.xml&quot;&#125;);</div><div class="line">        context.start();</div><div class="line">        DemoService demoService = (DemoService)context.getBean(&quot;demoService&quot;); // 获取远程服务代理</div><div class="line">        String hello = demoService.sayHello(&quot;world&quot;); // 执行远程方法</div><div class="line">        System.out.println( hello ); // 显示调用结果</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>配置简单注册中心</li>
</ul>
<p>当我们使用多点传播注册中心时，注册服务不是单独的，因此适用于局域网场景。为了适应更加便于管理的注册中心，可以使用SimpleRegistryService。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;dubbo:application name=&quot;simple-registry&quot; /&gt;</div><div class="line">&lt;dubbo:protocol port=&quot;9090&quot; /&gt;</div><div class="line">&lt;dubbo:service interface=&quot;com.alibaba.dubbo.registry.RegistryService&quot;</div><div class="line">  ref=&quot;registryService&quot; registry=&quot;N/A&quot; ondisconnect=&quot;disconnect&quot;&gt;</div><div class="line">    &lt;dubbo:method name=&quot;subscribe&quot;&gt;</div><div class="line">        &lt;dubbo:argument index=&quot;1&quot; callback=&quot;true&quot; /&gt;</div><div class="line">    &lt;/dubbo:method&gt;</div><div class="line">    &lt;dubbo:method name=&quot;unsubscribe&quot;&gt;</div><div class="line">        &lt;dubbo:argument index=&quot;1&quot; callback=&quot;true&quot; /&gt;</div><div class="line">    &lt;/dubbo:method&gt;</div><div class="line">&lt;/dubbo:service&gt;</div><div class="line"></div><div class="line">&lt;bean class=&quot;com.alibaba.dubbo.registry.simple.SimpleRegistryService&quot;</div><div class="line">  id=&quot;registryService&quot; /&gt;</div></pre></td></tr></table></figure>
<p>可以用于测试，但是实际工程中不推荐使用。</p>
<h1 id="Dubbo配置"><a href="#Dubbo配置" class="headerlink" title="Dubbo配置"></a>Dubbo配置</h1><h2 id="XML配置"><a href="#XML配置" class="headerlink" title="XML配置"></a>XML配置</h2><p>xml配置Dubbo可以参照上一节的实例，spring中可以直接通过dubbo标签库来对其进行配置设定等操作，使用广泛且条理清晰。所有的标签都支持自定义参数，用于不同扩展点实现的特殊配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;dubbo:protocol name=&quot;jms&quot;&gt;</div><div class="line">    &lt;dubbo:parameter key=&quot;queue&quot; value=&quot;your_queue&quot; /&gt;</div><div class="line">&lt;/dubbo:protocol&gt;</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//2.1之后开始支持这种自定义参数的方式</div><div class="line">&lt;dubbo:protocol name=&quot;jms&quot; p:queue=&quot;your_queue&quot; /&gt;</div></pre></td></tr></table></figure>
<ul>
<li>常用标签</li>
</ul>
<table>
<thead>
<tr>
<th>标签</th>
<th style="text-align:center">用途</th>
<th style="text-align:right">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><dubbo:service></dubbo:service></td>
<td style="text-align:center">服务配置</td>
<td style="text-align:right">用于暴露一个服务，定义服务的元信息，一个服务可以用多个协议暴露，一个服务也可以注册到多个注册中心</td>
</tr>
<tr>
<td><dubbo:reference></dubbo:reference></td>
<td style="text-align:center">引用配置</td>
<td style="text-align:right">用于创建一个远程服务代理，一个引用可以指向多个注册中心</td>
</tr>
<tr>
<td><dubbo:protocol></dubbo:protocol></td>
<td style="text-align:center">协议配置</td>
<td style="text-align:right">用于配置提供服务的协议信息，协议由提供方指定，消费方被动接受</td>
</tr>
<tr>
<td><dubbo:application></dubbo:application></td>
<td style="text-align:center">应用配置</td>
<td style="text-align:right">用于配置当前应用信息，不管该应用是提供者还是消费者</td>
</tr>
<tr>
<td><dubbo:module></dubbo:module></td>
<td style="text-align:center">模块配置</td>
<td style="text-align:right">用于配置当前模块信息，可选</td>
</tr>
<tr>
<td><dubbo:registry></dubbo:registry></td>
<td style="text-align:center">注册中心配置</td>
<td style="text-align:right">用于配置连接注册中心相关信息</td>
</tr>
<tr>
<td><dubbo:monitor></dubbo:monitor></td>
<td style="text-align:center">监控中心配置</td>
<td style="text-align:right">用于配置连接监控中心相关信息，可选</td>
</tr>
<tr>
<td><dubbo:provider></dubbo:provider></td>
<td style="text-align:center">提供方配置</td>
<td style="text-align:right">当ProtocolConfig 和 ServiceConfig 某属性没有配置时，采用此缺省值，可选</td>
</tr>
<tr>
<td><dubbo:consumer></dubbo:consumer></td>
<td style="text-align:center">消费方配置</td>
<td style="text-align:right">当 ReferenceConfig 某属性没有配置时，采用此缺省值，可选</td>
</tr>
<tr>
<td><dubbo:method></dubbo:method></td>
<td style="text-align:center">方法配置</td>
<td style="text-align:right">用于 ServiceConfig 和 ReferenceConfig 指定方法级的配置信息</td>
</tr>
<tr>
<td><dubbo:argument></dubbo:argument></td>
<td style="text-align:center">参数配置</td>
<td style="text-align:right">用于指定方法参数配置</td>
</tr>
</tbody>
</table>
<ul>
<li>标签之间的关系</li>
</ul>
<p><img src="/img/Dubbo-3.png" alt="Alt text"></p>
<p>  <em>配置覆盖关系为方法级别的优先，接口几倍的次之，全局配置再次之，级别一样消费者优先，提供者次之</em></p>
<h2 id="属性配置"><a href="#属性配置" class="headerlink" title="属性配置"></a>属性配置</h2><p>公共配置简单，没有多注册中心，多协议等情况，或者多个Spring容器想要共享配置，可以使用dubbo.properties作为缺省配置。Dubbo会自动加载classpath路径下的dubbo.properties文件，可以通过JVM启动参数<code>-Ddubbo.properties.file=xxx.properties</code>改动缺省位置。</p>
<ul>
<li>映射规则:将XML配置的标签名，属性名，用点分隔，多个属性拆分成多行。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dubbo.application.name=foo</div><div class="line">dubbo.application.owner=bar</div><div class="line">dubbo.registry.address=10.20.153.10:9090</div></pre></td></tr></table></figure>
<ul>
<li>覆盖策略：JVM启动，-D参数优先，XML次之，Properties文件最后。只有XML没有配置时，dubbo.properties才会生效。</li>
</ul>
<h2 id="Java-API配置Dubbo"><a href="#Java-API配置Dubbo" class="headerlink" title="Java API配置Dubbo"></a>Java API配置Dubbo</h2><p>除了spring配置文件来配置Dubbo之外，通过Java API，property文件以及注解来配置Dubbo同样可以。配置文件和注解配置适用于结构不是很复杂的场景。下面介绍如何使用API来配置Dubbo。</p>
<ul>
<li>服务提供者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">import com.alibaba.dubbo.rpc.config.ApplicationConfig;</div><div class="line">import com.alibaba.dubbo.rpc.config.RegistryConfig;</div><div class="line">import com.alibaba.dubbo.rpc.config.ProviderConfig;</div><div class="line">import com.alibaba.dubbo.rpc.config.ServiceConfig;</div><div class="line">import com.xxx.XxxService;</div><div class="line">import com.xxx.XxxServiceImpl;</div><div class="line"></div><div class="line">// 服务实现</div><div class="line">XxxService xxxService = new XxxServiceImpl();</div><div class="line"></div><div class="line">// 当前应用配置</div><div class="line">ApplicationConfig application = new ApplicationConfig();</div><div class="line">application.setName(&quot;xxx&quot;);</div><div class="line"></div><div class="line">// 连接注册中心配置</div><div class="line">RegistryConfig registry = new RegistryConfig();</div><div class="line">registry.setAddress(&quot;10.20.130.230:9090&quot;);</div><div class="line">registry.setUsername(&quot;aaa&quot;);</div><div class="line">registry.setPassword(&quot;bbb&quot;);</div><div class="line"></div><div class="line">// 服务提供者协议配置</div><div class="line">ProtocolConfig protocol = new ProtocolConfig();</div><div class="line">protocol.setName(&quot;dubbo&quot;);</div><div class="line">protocol.setPort(12345);</div><div class="line">protocol.setThreads(200);</div><div class="line"></div><div class="line">// 注意：ServiceConfig为重对象，内部封装了与注册中心的连接，以及开启服务端口</div><div class="line"></div><div class="line">// 服务提供者暴露服务配置</div><div class="line">ServiceConfig&lt;XxxService&gt; service = new ServiceConfig&lt;XxxService&gt;(); // 此实例很重，封装了与注册中心的连接，请自行缓存，否则可能造成内存和连接泄漏</div><div class="line">service.setApplication(application);</div><div class="line">service.setRegistry(registry); // 多个注册中心可以用setRegistries()</div><div class="line">service.setProtocol(protocol); // 多个协议可以用setProtocols()</div><div class="line">service.setInterface(XxxService.class);</div><div class="line">service.setRef(xxxService);</div><div class="line">service.setVersion(&quot;1.0.0&quot;);</div><div class="line"></div><div class="line">// 暴露及注册服务</div><div class="line">service.export();</div></pre></td></tr></table></figure>
<ul>
<li>此时，服务已经暴露给多点传播的注册中心了，然后配置服务消费者：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">import com.alibaba.dubbo.rpc.config.ApplicationConfig;</div><div class="line">import com.alibaba.dubbo.rpc.config.RegistryConfig;</div><div class="line">import com.alibaba.dubbo.rpc.config.ConsumerConfig;</div><div class="line">import com.alibaba.dubbo.rpc.config.ReferenceConfig;</div><div class="line">import com.xxx.XxxService;</div><div class="line"></div><div class="line">// 当前应用配置</div><div class="line">ApplicationConfig application = new ApplicationConfig();</div><div class="line">application.setName(&quot;yyy&quot;);</div><div class="line"></div><div class="line">// 连接注册中心配置</div><div class="line">RegistryConfig registry = new RegistryConfig();</div><div class="line">registry.setAddress(&quot;10.20.130.230:9090&quot;);</div><div class="line">registry.setUsername(&quot;aaa&quot;);</div><div class="line">registry.setPassword(&quot;bbb&quot;);</div><div class="line"></div><div class="line">// 注意：ReferenceConfig为重对象，内部封装了与注册中心的连接，以及与服务提供方的连接</div><div class="line"></div><div class="line">// 引用远程服务</div><div class="line">ReferenceConfig&lt;XxxService&gt; reference = new ReferenceConfig&lt;XxxService&gt;(); // 此实例很重，封装了与注册中心的连接以及与提供者的连接，请自行缓存，否则可能造成内存和连接泄漏</div><div class="line">reference.setApplication(application);</div><div class="line">reference.setRegistry(registry); // 多个注册中心可以用setRegistries()</div><div class="line">reference.setInterface(XxxService.class);</div><div class="line">reference.setVersion(&quot;1.0.0&quot;);</div><div class="line"></div><div class="line">// 和本地bean一样使用xxxService</div><div class="line">XxxService xxxService = reference.get(); // 注意：此代理对象内部封装了所有通讯细节，对象较重，请缓存复用</div></pre></td></tr></table></figure>
<h2 id="注解配置"><a href="#注解配置" class="headerlink" title="注解配置"></a>注解配置</h2><h3 id="服务提供方"><a href="#服务提供方" class="headerlink" title="服务提供方"></a>服务提供方</h3><ul>
<li>Service注解暴露服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">import com.alibaba.dubbo.config.annotation.Service;</div><div class="line"></div><div class="line">@Service(timeout = 5000)</div><div class="line">public class AnnotateServiceImpl implements AnnotateService &#123;</div><div class="line">    // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>javaconfig形式配置公共模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">@Configuration</div><div class="line">public class DubboConfiguration &#123;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public ApplicationConfig applicationConfig() &#123;</div><div class="line">        ApplicationConfig applicationConfig = new ApplicationConfig();</div><div class="line">        applicationConfig.setName(&quot;provider-test&quot;);</div><div class="line">        return applicationConfig;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public RegistryConfig registryConfig() &#123;</div><div class="line">        RegistryConfig registryConfig = new RegistryConfig();</div><div class="line">        registryConfig.setAddress(&quot;zookeeper://127.0.0.1:2181&quot;);</div><div class="line">        registryConfig.setClient(&quot;curator&quot;);</div><div class="line">        return registryConfig;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>指定Java扫描路径</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@SpringBootApplication</div><div class="line">@DubboComponentScan(basePackages = &quot;com.alibaba.dubbo.test.service.impl&quot;)</div><div class="line">public class ProviderTestApp &#123;</div><div class="line">    // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="服务消费者"><a href="#服务消费者" class="headerlink" title="服务消费者"></a>服务消费者</h3><ul>
<li>reference 注解引用服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public class AnnotationConsumeService &#123;</div><div class="line"></div><div class="line">    @com.alibaba.dubbo.config.annotation.Reference</div><div class="line">    public AnnotateService annotateService;</div><div class="line"></div><div class="line">    // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>javaconfig形式配置公共模块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">@Configuration</div><div class="line">public class DubboConfiguration &#123;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public ApplicationConfig applicationConfig() &#123;</div><div class="line">        ApplicationConfig applicationConfig = new ApplicationConfig();</div><div class="line">        applicationConfig.setName(&quot;consumer-test&quot;);</div><div class="line">        return applicationConfig;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public ConsumerConfig consumerConfig() &#123;</div><div class="line">        ConsumerConfig consumerConfig = new ConsumerConfig();</div><div class="line">        consumerConfig.setTimeout(3000);</div><div class="line">        return consumerConfig;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public RegistryConfig registryConfig() &#123;</div><div class="line">        RegistryConfig registryConfig = new RegistryConfig();</div><div class="line">        registryConfig.setAddress(&quot;zookeeper://127.0.0.1:2181&quot;);</div><div class="line">        registryConfig.setClient(&quot;curator&quot;);</div><div class="line">        return registryConfig;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>指定dubbo扫描路径</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@SpringBootApplication</div><div class="line">@DubboComponentScan(basePackages = &quot;com.alibaba.dubbo.test.service&quot;)</div><div class="line">public class ConsumerTestApp &#123;</div><div class="line">    // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看出，还是XML配置更加的简洁明了。</p>
<h1 id="Dubbo支持的协议"><a href="#Dubbo支持的协议" class="headerlink" title="Dubbo支持的协议"></a>Dubbo支持的协议</h1><p>Dubbo框架支持多种协议，包括dubbo、RMI、hessian、HTTP、web service、thrift、memcached、redis等。大多数协议之前都已经了解过，除了dubbo这个协议。</p>
<p>dubbo协议在服务提供者和消费者之间建立了长连接，这种长连接和非阻塞的网络传输在传输数据小于100k的时候效率非常高。dubbo协议中的参数包含端口，每个消费者的连接数，最大接受的连接数等。</p>
<p><code>&lt;dubbo:protocol name=&quot;dubbo&quot; port=&quot;20880&quot;  connections=&quot;2&quot; accepts=&quot;1000&quot; /&gt;</code></p>
<p>Dubbo还支持通过不同协议来同时暴露服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;dubbo:protocol name=&quot;dubbo&quot; port=&quot;20880&quot; /&gt;</div><div class="line">&lt;dubbo:protocol name=&quot;rmi&quot; port=&quot;1099&quot; /&gt;</div><div class="line"></div><div class="line">&lt;dubbo:service interface=&quot;com.baeldung.dubbo.remote.GreetingsService&quot; version=&quot;1.0.0&quot; ref=&quot;greetingsService&quot; protocol=&quot;dubbo&quot; /&gt;</div><div class="line">&lt;dubbo:service interface=&quot;com.bealdung.dubbo.remote.AnotherService&quot; version=&quot;1.0.0&quot; ref=&quot;anotherService&quot; protocol=&quot;rmi&quot; /&gt;</div></pre></td></tr></table></figure>
<h1 id="结果缓存"><a href="#结果缓存" class="headerlink" title="结果缓存"></a>结果缓存</h1><p>Dubbo对于远程调用的结果进行了本地的缓存来提高对于热点数据的访问速度。实现添加cache属性即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;dubbo:reference interface=&quot;com.baeldung.dubbo.remote.GreetingsService&quot; id=&quot;greetingsService&quot; cache=&quot;lru&quot; /&gt;</div></pre></td></tr></table></figure>
<p>缓存策略选择的是最少最近使用缓存，当我们队服务的提供者的实现类进行修改之后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">public class GreetingsServiceSpecialImpl implements GreetingsService &#123;</div><div class="line">    @Override</div><div class="line">    public String sayHi(String name) &#123;</div><div class="line">        try &#123;</div><div class="line">            SECONDS.sleep(5);</div><div class="line">        &#125; catch (Exception ignored) &#123; &#125;</div><div class="line">        return &quot;hi, &quot; + name;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对调用速度进行一下测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void givenProvider_whenConsumerSaysHi_thenGotResponse() &#123;</div><div class="line">    ClassPathXmlApplicationContext localContext</div><div class="line">      = new ClassPathXmlApplicationContext(&quot;multicast/consumer-app.xml&quot;);</div><div class="line">    localContext.start();</div><div class="line">    GreetingsService greetingsService</div><div class="line">      = (GreetingsService) localContext.getBean(&quot;greetingsService&quot;);</div><div class="line"></div><div class="line">    long before = System.currentTimeMillis();</div><div class="line">    String hiMessage = greetingsService.sayHi(&quot;baeldung&quot;);</div><div class="line"></div><div class="line">    long timeElapsed = System.currentTimeMillis() - before;</div><div class="line">    assertTrue(timeElapsed &gt; 5000);</div><div class="line">    assertNotNull(hiMessage);</div><div class="line">    assertEquals(&quot;hi, baeldung&quot;, hiMessage);</div><div class="line"></div><div class="line">    before = System.currentTimeMillis();</div><div class="line">    hiMessage = greetingsService.sayHi(&quot;baeldung&quot;);</div><div class="line">    timeElapsed = System.currentTimeMillis() - before;</div><div class="line"></div><div class="line">    assertTrue(timeElapsed &lt; 1000);</div><div class="line">    assertNotNull(hiMessage);</div><div class="line">    assertEquals(&quot;hi, baeldung&quot;, hiMessage);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>除了第一次调用，后面的调用几乎是立刻完成的，说明缓存生效了。</p>
<h1 id="zookeeper"><a href="#zookeeper" class="headerlink" title="zookeeper"></a>zookeeper</h1><p>Dubbo通过负载均衡和集中容错策略可以支持我们来自由的扩展我们的服务。假定我们使用zookeeper来做我们管理服务的集群。服务提供者在zookeeper上注册服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;dubbo:registry address=&quot;zookeeper://127.0.0.1:2181&quot;/&gt;</div></pre></td></tr></table></figure>
<p>为了引入使用以上的注册方式，需要引入zookeeper的相关依赖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;3.4.11&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;com.101tec&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;zkclient&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;0.10&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure>
<h1 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h1><ul>
<li>随机负载均衡<ul>
<li>随机，按照权重设置随机概率</li>
<li>在一个截面上碰撞的概率高，单调用量越大分布越均匀，而且按概率使用权重后也比较均匀，有利于动态调整提供者权重。</li>
</ul>
</li>
<li>轮询负载均衡<ul>
<li>按公约后的权重设置轮询比率。</li>
<li>存在慢的提供者累积请求的问题，比如第二台机器很慢，当请求调到第二台就卡在那里，时间久了所有请求都卡在第二台机器上。</li>
</ul>
</li>
<li>最少活跃数负载均衡<ul>
<li>最少活跃调用数，相同活跃数的随机，活跃数指调用前后计数差。</li>
<li>使慢的提供者受到更少的请求，因为越慢的提供者的调用前后计数差会越大。</li>
</ul>
</li>
<li>一致性哈希负载均衡<ul>
<li>相同参数的请求总是发到同一个提供者</li>
<li>当某一台提供者挂掉时，原本发往该提供者的请求，基于虚拟节点，平摊到其他提供者，不会引起剧烈变动。</li>
<li>缺醒只对第一个参数哈希，也可以配置<dubbo:parameter key="hash.arguments" value="0,1">修改。</dubbo:parameter></li>
<li>缺醒使用160份虚拟节点，如果要修改，请配置<dubbo:parameter key="hash.nodes" value="320"></dubbo:parameter></li>
</ul>
</li>
</ul>
<p>配置：</p>
<ul>
<li><p>服务端</p>
<ul>
<li>服务级别<code>&lt;dubbo:service interface=&quot;...&quot; loadbalance=&quot;roundrobin&quot; /&gt;</code></li>
<li>方法级别</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;dubbo:service interface=&quot;...&quot;&gt;</div><div class="line">    &lt;dubbo:method name=&quot;...&quot; loadbalance=&quot;roundrobin&quot;/&gt;</div><div class="line">&lt;/dubbo:service&gt;&gt;</div></pre></td></tr></table></figure>
<ul>
<li><p>客户端</p>
<ul>
<li>服务级别<code>&lt;dubbo:reference interface=&quot;...&quot; loadbalance=&quot;roundrobin&quot; /&gt;</code></li>
<li>方法级别</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">      &lt;dubbo:reference interface=&quot;...&quot;&gt;</div><div class="line">          &lt;dubbo:method name=&quot;...&quot; loadbalance=&quot;roundrobin&quot;/&gt;</div><div class="line">      &lt;/dubbo:reference&gt;</div><div class="line">      ```    </div><div class="line"></div><div class="line">## 轮询负载均衡举例</div><div class="line"></div><div class="line">假定在一个集群里面存在两这个服务的实现作为服务提供者，请求时采用轮询方式做负载均衡。首先，创建服务提供者：</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>Before<br>public void initRemote() {<br>    ExecutorService executorService = Executors.newFixedThreadPool(2);<br>    executorService.submit(() -&gt; {<br>        ClassPathXmlApplicationContext remoteContext<br>          = new ClassPathXmlApplicationContext(“cluster/provider-app-default.xml”);<br>        remoteContext.start();<br>    });<br>    executorService.submit(() -&gt; {<br>        ClassPathXmlApplicationContext backupRemoteContext<br>          = new ClassPathXmlApplicationContext(“cluster/provider-app-special.xml”);<br>        backupRemoteContext.start();<br>    });<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">然后我们有一个标准的高速服务提供者，可以立即给出相应结果，一个低速服务提供者，每个响应需要等候5s。执行六次请求，此时采用轮询的负载均衡侧率，则期待的是平均相应时间为2.5s。</div></pre></td></tr></table></figure></p>
<p>@Test<br>public void givenProviderCluster_whenConsumerSaysHi_thenResponseBalanced() {<br>    ClassPathXmlApplicationContext localContext<br>      = new ClassPathXmlApplicationContext(“cluster/consumer-app-lb.xml”);<br>    localContext.start();<br>    GreetingsService greetingsService<br>      = (GreetingsService) localContext.getBean(“greetingsService”);</p>
<pre><code>List&lt;Long&gt; elapseList = new ArrayList&lt;&gt;(6);
for (int i = 0; i &lt; 6; i++) {
    long current = System.currentTimeMillis();
    String hiMessage = greetingsService.sayHi(&quot;baeldung&quot;);
    assertNotNull(hiMessage);
    elapseList.add(System.currentTimeMillis() - current);
}

OptionalDouble avgElapse = elapseList
  .stream()
  .mapToLong(e -&gt; e)
  .average();
assertTrue(avgElapse.isPresent());
assertTrue(avgElapse.getAsDouble() &gt; 2500.0);
</code></pre><p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">同时，动态负载均衡是支持的，下面的例子说明这一点，采用的是轮询的负载均衡策略，当新的服务注册时候，消费者会选择新的服务。低俗的服务提供者在系统启动后2s注册。</div></pre></td></tr></table></figure></p>
<p>@Before<br>public void initRemote() {<br>    ExecutorService executorService = Executors.newFixedThreadPool(2);<br>    executorService.submit(() -&gt; {<br>        ClassPathXmlApplicationContext remoteContext<br>          = new ClassPathXmlApplicationContext(“cluster/provider-app-default.xml”);<br>        remoteContext.start();<br>    });<br>    executorService.submit(() -&gt; {<br>        SECONDS.sleep(2);<br>        ClassPathXmlApplicationContext backupRemoteContext<br>          = new ClassPathXmlApplicationContext(“cluster/provider-app-special.xml”);<br>        backupRemoteContext.start();<br>        return null;<br>    });<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">服务提供者此时每秒调用一次服务，6次之后，我们期望平均响应时间大于1.6s。</div></pre></td></tr></table></figure></p>
<p>@Test<br>public void givenProviderCluster_whenConsumerSaysHi_thenResponseBalanced()<br>  throws InterruptedException {<br>    ClassPathXmlApplicationContext localContext<br>      = new ClassPathXmlApplicationContext(“cluster/consumer-app-lb.xml”);<br>    localContext.start();<br>    GreetingsService greetingsService<br>      = (GreetingsService) localContext.getBean(“greetingsService”);<br>    List<long> elapseList = new ArrayList&lt;&gt;(6);<br>    for (int i = 0; i &lt; 6; i++) {<br>        long current = System.currentTimeMillis();<br>        String hiMessage = greetingsService.sayHi(“baeldung”);<br>        assertNotNull(hiMessage);<br>        elapseList.add(System.currentTimeMillis() - current);<br>        SECONDS.sleep(1);<br>    }</long></p>
<pre><code>OptionalDouble avgElapse = elapseList
  .stream()
  .mapToLong(e -&gt; e)
  .average();

assertTrue(avgElapse.isPresent());
assertTrue(avgElapse.getAsDouble() &gt; 1666.0);
</code></pre><p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">*负载均衡在服务提供者和服务消费者都可以使用。*</div><div class="line"></div><div class="line"># 集群容错</div><div class="line"></div><div class="line">Dubbo支持多种容错机制，默认为failover重试。</div><div class="line"></div><div class="line">![Alt text](/img/Dubbo-4.png)</div><div class="line"></div><div class="line">## 各节点的关系</div><div class="line"></div><div class="line">* Invoke是Provider的一个可调用Service的抽象，Invoker封装了Provider地址及Service接口信息。</div><div class="line">* Directory代表多个Invoker，List&lt;Invoker&gt;，值可以动态变化，比如注册中心推送变更</div><div class="line">* Cluster将Director中的多个Invoker封装成一个Invoker，对上层逃命，伪装过程包含了容错逻辑，如果失败后，重试另一个</div><div class="line">* Route负责从多个Invoker中按照路由规则选出子集没比如读写分离，应用隔离等</div><div class="line">* loadbalance负责从多个Invoker中选出一个具体用于本地调用，选的过程中包含了负载均衡该算法。</div><div class="line"></div><div class="line">## 集群容错模式</div><div class="line"></div><div class="line">* fail-over</div><div class="line">    * 当一个消费者获取一个服务失败的时候，会尝试访问集群中其他的服务提供者</div><div class="line">    * 通常用于读操作，但是重试会带来更长的延迟</div><div class="line">    * 可通过retries=“2”来设置重试次数，其中第一次不包含在内。    </div><div class="line">* fail-safe</div><div class="line">    * 失败安全，出现异常时，直接忽略</div><div class="line">    * 通常用于写入审计日志等操作</div><div class="line">* fail-fast</div><div class="line">    * 快速失败，只发起一次调用，失败立即报错</div><div class="line">    * 通常用于非幂等性的写操作，比如新增记录</div><div class="line">* fail-back</div><div class="line">    * 失败自动恢复，后台记录失败请求，定时重发</div><div class="line">    * 通常用于消息通知操作</div><div class="line">* forking</div><div class="line">    * 并行调度多个服务器，只要一个成功及返回。</div><div class="line">    * 通常实时性要求比较高的读操作，但是需要浪费很多服务资源，可以通过forks=&quot;2&quot;来设置最大并行数</div><div class="line">* broadcast</div><div class="line">    * 广播调用所有的提供者，逐个调用，任意一台报错则报错。</div><div class="line">    * 通常用于通知所有提供者更新缓存或者日志等本地资源信息。</div><div class="line"></div><div class="line">## 集群模式配置</div></pre></td></tr></table></figure></p>
<p>//服务端</p>
<p><dubbo:service cluster="failsafe"><br>//客户端</dubbo:service></p>
<p><dubbo:reference cluster="failsafe"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># 线性模型</div><div class="line"></div><div class="line">![Alt text](/img/Dubbo-5.png)</div><div class="line"></div><div class="line">* 如果事件的处理逻辑能够迅速完成，并且不会发起新的IO请求，比如只是在内存中标记个标识，则直接在IO线程上处理更快，因为这样减少了线程池的调度。</div><div class="line">* 如果事件处理逻辑较慢，或者需要发起新的IO请求，比如需要查询数据库，则必须派发到线程池，否则IO线程阻塞，将导致不能接受其他请求。</div><div class="line">* 如果用IO线程处理事件，又在事件处理过程中发起新的IO请求，比如在链接事件中发起登录请求，会报可能发生死锁异常。</div><div class="line"></div><div class="line">针对不同的场景，需要设定相应的派发侧率和不同的线程池：</div></pre></td></tr></table></figure></dubbo:reference></p>
<p><dubbo:protocol name="dubbo" dispatcher="all" threadpool="fixed" threads="100"><br>```</dubbo:protocol></p>
<h2 id="Dispatcher"><a href="#Dispatcher" class="headerlink" title="Dispatcher"></a>Dispatcher</h2><ul>
<li>all，所有消息都派发到线程池，包括请求，相应，连接事件，断开事件，心跳等。</li>
<li>direct，所有消息都不派发到线程池，全部在IO线程上直接执行</li>
<li>message，只有请求相应消息派发到线程池，其他直接在IO线程执行</li>
<li>execution，只将请求消息派发到线程池，其他直接在IO线程执行</li>
<li>connection，在IO线程上，将连接断开事件放入队列，顺序执行，其他消息派发到线程池</li>
</ul>
<h2 id="threadPool"><a href="#threadPool" class="headerlink" title="threadPool"></a>threadPool</h2><ul>
<li>fixed，固定大小线程池，启动时创建线程，不关闭，一致持有，缺省</li>
<li>cached，缓存线程池，线程空闲一分钟自动删除，需要时创建</li>
<li>limited，可伸缩性线程池，单线程池中的线程数只会增长不会收缩，避免收缩带来的性能问题。</li>
<li>eager，优先创建worker线程池，当任务数量大于corePoolSize但小于maximumPoolSize时，优先创建Worker来处理任务。当任务数量大于maximumpoolSize时，将任务放入阻塞队列，阻塞队列充满时抛出RejectedExecutionException。</li>
</ul>
<h1 id="客户端和服务端直连"><a href="#客户端和服务端直连" class="headerlink" title="客户端和服务端直连"></a>客户端和服务端直连</h1><p>测试过程中，可以绕过注册中心来直接连接，此时会忽略注册中心的提供者列表，A接口配置点对点，不影响B接口从注册中心获取列表。</p>
<p>配置方法：</p>
<ul>
<li><p>XML：<code>&lt;dubbo:reference id=&quot;xxxService&quot; interface=&quot;com.alibaba.xxx.XxxService&quot; url=&quot;dubbo://localhost:20890&quot; /&gt;</code></p>
</li>
<li><p>JVM：<code>java -Dcom.alibaba.xxx.XxxService=dubbo://localhost:20890</code></p>
</li>
<li><p>properties: <code>com.alibaba.xxx.XxxService=dubbo://localhost:20890</code></p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/16/Java网络编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/16/Java网络编程/" itemprop="url">Java网络编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-16T10:57:16+08:00">
                2018-04-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="网络编程中的两个主要问题"><a href="#网络编程中的两个主要问题" class="headerlink" title="网络编程中的两个主要问题"></a>网络编程中的两个主要问题</h1><ul>
<li>如何准确的定位网络上的一台或者多台主机</li>
</ul>
<p>TCP/IP协议中IP协议主要负责网络主机的定位，数据传输的路由，可以由IP地址唯一的确定Internet上的一台主机。</p>
<ul>
<li>找到主机后如何进行可靠高效的数据传输</li>
</ul>
<p>TCP层提供面向应用的可靠传输（TCP） 或者非可靠的UDP数据传输机制。目前比较流行的网络编程模型为C/S架构，也就是通信一方作为服务器等待客户提出请求并给予相应，客户端在需要服务时向服务器提出申请。服务器一般作为守护进程始终执行，监听网络端口，一旦有客户请求，就会启动一个服务进程来响应客户，同时自己继续监听服务端口，使后来的客户也能及时得到服务。</p>
<h1 id="TCP协议和UDP协议"><a href="#TCP协议和UDP协议" class="headerlink" title="TCP协议和UDP协议"></a>TCP协议和UDP协议</h1><p>TCP：Transfer Control Protocol的简称，是一种面向连接的可靠传输协议。通过TCP协议传输得到的是一个顺序的无差错的数据流，发送方和接收方的成对的连个socket必须建立连接，以便在TCP协议的基础上进行通信。</p>
<p>UDP：User Datagram Protocol的简称，是一种无连接的协议。每个数据报都是一个独立的消息，包括完整的源地址或目的地址，在网络上以任何可能的路径进行传送，能否到达目的地以及到达的时间都不确定。</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center">UDP</th>
<th style="text-align:right">TCP</th>
</tr>
</thead>
<tbody>
<tr>
<td>连接性</td>
<td style="text-align:center">无连接</td>
<td style="text-align:right">面向连接</td>
</tr>
<tr>
<td>传输数据大小</td>
<td style="text-align:center">大小有限制，64KB以内</td>
<td style="text-align:right">统一格式数据传输</td>
</tr>
<tr>
<td>可靠性</td>
<td style="text-align:center">不可靠，不保证到达</td>
<td style="text-align:right">可靠协议</td>
</tr>
<tr>
<td>应用</td>
<td style="text-align:center">Telnet/FTP</td>
<td style="text-align:right">视频会议</td>
</tr>
</tbody>
</table>
<h1 id="基于Socket的Java网络编程"><a href="#基于Socket的Java网络编程" class="headerlink" title="基于Socket的Java网络编程"></a>基于Socket的Java网络编程</h1><p>网络上两个程序通过一个双向的通讯连接实现数据的交换，这个双向链路的一端成为一个Socket。Socket通常用来实现客户方和服务端的链接。一个Socket由一个IP和一个PROT唯一确定。Java环境下，Socket编程主要是指基于TCP/IP协议的网络编程。</p>
<h2 id="Socket通信流程"><a href="#Socket通信流程" class="headerlink" title="Socket通信流程"></a>Socket通信流程</h2><ol>
<li>Server端监听某个端口是否有连接请求</li>
<li>Client端相Server端发送Connect请求</li>
<li>Server端相Client端发送Accept消息，建立连接。</li>
<li>Server端和Client端都可以通过Send，Write等方式通信。</li>
<li>关闭Socket</li>
</ol>
<h2 id="创建一个Socket"><a href="#创建一个Socket" class="headerlink" title="创建一个Socket"></a>创建一个Socket</h2><p>Java中java.net包中提供了两个类，Socket，ServerSocket，分别表示双向连接的客户端和服务端。</p>
<p>客户端类的构造方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public Socket(String host, int port)</div><div class="line">    throws UnknownHostException, IOException</div><div class="line">&#123;</div><div class="line">    this(host != null ? new InetSocketAddress(host, port) :</div><div class="line">         new InetSocketAddress(InetAddress.getByName(null), port),</div><div class="line">         (SocketAddress) null, true);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>服务端的构造方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public ServerSocket(int port) throws IOException &#123;</div><div class="line">    this(port, 50, null);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="简单的Client-Server程序"><a href="#简单的Client-Server程序" class="headerlink" title="简单的Client/Server程序"></a>简单的Client/Server程序</h2><hr>
<p>未完</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/Redis-redis基础总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/Redis-redis基础总结/" itemprop="url">Redis-redis基础总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T20:55:44+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="redis简介"><a href="#redis简介" class="headerlink" title="redis简介"></a>redis简介</h1><p>redis是一个开源的，C语言编写的、支持网络交互的，可基于内存也可以持久化的key-value数据库，是当前最为热门的非关系型数据库。其官网为redis.io。</p>
<h2 id="redis的安装"><a href="#redis的安装" class="headerlink" title="redis的安装"></a>redis的安装</h2><ol>
<li>下载redis源码并解压缩</li>
<li>进入redis源码目录，make编译一下。</li>
<li>make install PREFIX=/usr/local/redis</li>
</ol>
<p>安装完毕，其目录如下：</p>
<blockquote>
<p>./redis-benchmark //用于进行redis性能测试的工具<br>  ./redis-check-dump //用于修复出问题的dump.rdb文件<br>  ./redis-cli //redis的客户端<br>  ./redis-server //redis的服务端<br>  ./redis-check-aof //用于修复出问题的AOF文件<br>  ./redis-sentinel //用于集群管理</p>
</blockquote>
<h2 id="redis的使用"><a href="#redis的使用" class="headerlink" title="redis的使用"></a>redis的使用</h2><p>./redis-server redis.conf 可指定配置文件并启动redis服务，默认端口号为6379。可以通过redis-cli或者可视化的客户端如redis management来远程登录操作服务器。</p>
<h1 id="redis的五种数据类型"><a href="#redis的五种数据类型" class="headerlink" title="redis的五种数据类型"></a>redis的五种数据类型</h1><ol>
<li>String</li>
</ol>
<p>字符串是redis最基本的数据类型，一个key对应一个value.String类型是二进制安全的。也就是说redis的String可以包含任何数据。比如JPG图片或者序列化的对象。String类型是redis最基本的数据类型，一个redis中字符串value最多可以是512M。</p>
<p>基本操作包括get、set、incr、decr</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; set mynum &quot;2&quot;</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; get mynum</div><div class="line">&quot;2&quot;</div><div class="line">127.0.0.1:6379&gt; incr mynum</div><div class="line">(integer) 3</div><div class="line">127.0.0.1:6379&gt; get mynum</div><div class="line">&quot;3&quot;</div></pre></td></tr></table></figure>
<p>考虑到INCR等指令本身就具有原子操作的特性，可以利用redis的INCR，DECR等指令来实现原子计数，用这个特性来实现业务上的统计技术需求。</p>
<ol>
<li>Hash</li>
</ol>
<p>Hash是一个键值对集合,相当于一个key对应一个map，map中还有键值对。使用hash对key进行归类。</p>
<p>基本操作包括hset、hget。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; HMSET user:001 username antirez password P1pp0 age 34</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; HGETALL user:001</div><div class="line">1) &quot;username&quot;</div><div class="line">2) &quot;antirez&quot;</div><div class="line">3) &quot;password&quot;</div><div class="line">4) &quot;P1pp0&quot;</div><div class="line">5) &quot;age&quot;</div><div class="line">6) &quot;34&quot;</div><div class="line">127.0.0.1:6379&gt; HSET user:001 password 12345</div><div class="line">(integer) 0</div><div class="line">127.0.0.1:6379&gt; HGETALL user:001</div><div class="line">1) &quot;username&quot;</div><div class="line">2) &quot;antirez&quot;</div><div class="line">3) &quot;password&quot;</div><div class="line">4) &quot;12345&quot;</div><div class="line">5) &quot;age&quot;</div><div class="line">6) &quot;34&quot;</div></pre></td></tr></table></figure>
<ol>
<li>List</li>
</ol>
<p>列表在低层的实现为链表，则其插入和删除的效率非常高。其存在的缺点在于链表中元素的定位比较慢。</p>
<p>其基本操作包括lpush,rpush,lrange等,也就是从左侧插入，右侧插入以及指定一个范围来提取元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; lpush mylist &quot;1&quot;</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; rpush mylist &quot;2&quot;</div><div class="line">(integer) 2</div><div class="line">127.0.0.1:6379&gt; lpush mylist &quot;0&quot;</div><div class="line">(integer) 3</div><div class="line">127.0.0.1:6379&gt; lrange mylist 0 1</div><div class="line">1) &quot;0&quot;</div><div class="line">2) &quot;1&quot;</div><div class="line">127.0.0.1:6379&gt; lrange mylist 0 -1</div><div class="line">1) &quot;0&quot;</div><div class="line">2) &quot;1&quot;</div><div class="line">3) &quot;2</div></pre></td></tr></table></figure>
<p>list的使用场景包括：</p>
<ul>
<li>利用lists来实现一个消息队列，可以确保消息的顺序执行。</li>
<li>利用LRANGE实现分页功能</li>
</ul>
<ol>
<li>Set</li>
</ol>
<p>集合和Java中的集合定义类似，无序，不重合。可以对集合进行添加，删除，取交集，取并集，取差集等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; sadd myset &quot;one&quot;</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; sadd myset &quot;two&quot;</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; smembers myset</div><div class="line">1) &quot;one&quot;</div><div class="line">2) &quot;two&quot;</div><div class="line">127.0.0.1:6379&gt; sismember myset &quot;one&quot;</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; sismember myset &quot;three&quot;</div><div class="line">(integer) 0</div><div class="line">127.0.0.1:6379&gt; sadd yourset &quot;1&quot;</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; sadd yourset &quot;2&quot;</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; smembers yourset</div><div class="line">1) &quot;1&quot;</div><div class="line">2) &quot;2&quot;</div><div class="line">127.0.0.1:6379&gt; sunion myset yourset</div><div class="line">1) &quot;1&quot;</div><div class="line">2) &quot;one&quot;</div><div class="line">3) &quot;2&quot;</div><div class="line">4) &quot;two&quot;</div></pre></td></tr></table></figure>
<ol>
<li>zset</li>
</ol>
<p>有序集合，每个元素都关联一个score，据此来进行排序。常用操作有zrange,zadd,zreevrange,zrangebyscore等等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; zadd myzset 1 baidu.com</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; zadd myzset 3 360.com</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; zadd myzset 2 google.com</div><div class="line">(integer) 1</div><div class="line">127.0.0.1:6379&gt; zrange myzset 0 -1 with scores</div><div class="line">1) &quot;baidu.com&quot;</div><div class="line">2) &quot;1&quot;</div><div class="line">3) &quot;google.com&quot;</div><div class="line">4) &quot;2&quot;</div><div class="line">5) &quot;360.com&quot;</div><div class="line">6) &quot;3&quot;</div><div class="line">127.0.0.1:6379&gt; zrange myzset 0 -1</div><div class="line">1) &quot;baidu.com&quot;</div><div class="line">2) &quot;google.com&quot;</div><div class="line">3) &quot;360.com&quot;</div></pre></td></tr></table></figure>
<h1 id="redis持久化"><a href="#redis持久化" class="headerlink" title="redis持久化"></a>redis持久化</h1><p>redis提供了两种持久化方案：RDB和AOF。</p>
<h2 id="RDB-Redis-Database"><a href="#RDB-Redis-Database" class="headerlink" title="RDB-Redis Database"></a>RDB-Redis Database</h2><ul>
<li><p>rdb是将redis某一个时刻的数据持久化到磁盘中，是一种快照式的持久化方法。redis在持久化过程中，会将数据都写入到一个临时文件中，待持久化过程都结束了，才会用这个临时文件替换上次持久化好的dump.rdb。保证快照文件试完整可用的，可以随时进行备份。</p>
</li>
<li><p>RDB进行持久化过程时，redis会单独fork一个子进程来进行持久化，而主进程不会进行任何的IO操作，从而保证了redis的高性能。</p>
<ul>
<li>fork的作用是复制一个和当前进程一样的进程。新进程的所有数据数值和原进程一致，但是是一个全新的进程，并作为原进程的子进程。</li>
</ul>
</li>
<li><p>RDB快照的触发方法</p>
<ul>
<li>配置文件中默认的快照配置，cp后重新使用。</li>
<li>命令save、bgsave，其中save时只保存，其他全部阻塞，bgsave会在后台进行快照操作，快照同时还可以响应客户端的请求，可以通过lastsave命令获取最后一次成功执行快照的时间。</li>
<li>使用flushall命令，不过里面是空的，无意义。</li>
</ul>
</li>
<li><p>RDB的优势和劣势</p>
<ul>
<li>优势：如果需要进行大规模的数据恢复，且对于数据恢复的完整性不是非常敏感，nameRDB方式要比AOF方式更加的高效。</li>
<li>劣势：RDB的缺点在于如果对于数据完整性要求比较高，则当redis故障时，会丢失掉最后一次快照后的所有数据。而如果持久化频率太高，会增加服务器的多余压力。同时fork时，内存中的数据被复制了一份，内存膨胀需要考虑。</li>
</ul>
</li>
</ul>
<h2 id="AOF-Append-Only-File"><a href="#AOF-Append-Only-File" class="headerlink" title="AOF-Append Only File"></a>AOF-Append Only File</h2><ul>
<li><p>AOF,只允许对文件追加。AOF采用的持久化方案是将执行过的写指令记录下来，在数据恢复时按照从前到后的顺序将指令都执行一遍。AOF的开启可以通过修改redis.conf中的appendonly yes来设置。此时，如果有写操作，都会追加到AOF文件的末尾。默认的AOF持久化策略为每秒种fsync一次，由于向磁盘中写一个指令对系统的压力很小，因此此时redis保持高效运行。而redis重启时根据日志文件顺次执行其指令来完成数据恢复。</p>
</li>
<li><p>redis出现故障，丢失的数据也就是这1s没有被同步的数据。同时在追加日志时，恰好遇到磁盘空间满，断电等情况导致日志写入不完整，此时redis提供了redis-check-aof工具来修复日志。</p>
<p>  如果AOF文件出现了被写坏的情况，可以通过以下步骤来修复：</p>
<pre><code>* 备份被写坏的AOF文件
* 运行redis-check-aof-fix进行修复
* 用diff -u来查看两个文件的差异，确认问题点
* 重启redis,加载修改后的AOF文件
</code></pre></li>
</ul>
<ul>
<li><p>重写机制：bgrewriteaof</p>
<ul>
<li><p>追加方式会导致AOF文件越来越大，因此redis提供了AOF文件重写机制，也就是当AOF文件的大小超过所设定的阈值时，redis会启动AOF文件的内容压缩，只保留可以恢复数据的最小指令集。比如，如果我们队一个字符串的值进行了1000次INCR，AOF中应该记录1000条指令，这时候我们完全可以用一个set的值，将其设置为正确的数据。同时AOF重写过程中，仍然是采用先写临时文件，全部完成后再替换的流程，所以断电、磁盘满等问题都不会影响AOF文件的可用性。</p>
</li>
<li><p>重写原理：</p>
<ul>
<li>重写时会fork一个新进程来将文件进行重写，先写临时文件然后rename覆盖。重写过程为遍历此时内存中的数据，每条数据有一条对应的set语句。重写AOF文件的操作并不是读取旧的AOF文件，而是将整个内存中的数据库内容用命令的方式重写了一个新的AOF文件，类似于快照。</li>
</ul>
</li>
<li><p>重写触发条件：</p>
<ul>
<li>redis会记录上次重写时的AOF大小，默认配置是当AOF文件大小是上次rewrite后的大小的一倍且文件大于64M时触发。</li>
</ul>
</li>
</ul>
</li>
<li><p>AOF的优势和劣势</p>
<ul>
<li><p>AOF的优势：</p>
<ul>
<li>每秒同步，异步操作，每秒记录，如果1s以内的宕机，有数据丢失</li>
<li>不需要同步</li>
</ul>
</li>
<li><p>AOF的缺陷主要有两个方面：</p>
<ul>
<li>同样数据规模的情况下，AOF文件要比RDB文件的体积大。</li>
<li>AOF方式的恢复速度也要慢于RDB方式。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="选择方案"><a href="#选择方案" class="headerlink" title="选择方案"></a>选择方案</h2><p>RDB持久化方式能够在指定时间间隔内对你的数据进行快照存储。而AOF持久化方式能记录每次对服务器写的操作，当服务器重启时重新执行这些命令来回复原始数据，AOF命令以redis协议追加保存每次写的操作到文件末尾。Redis还能对AOF文件进行后台重写，使得AOF文件不至于过大。</p>
<ul>
<li>两种方式都开启来提供更加可靠的持久化方案</li>
</ul>
<p>这种情况下，当redis重启时会优先载入AOF文件来回复原始的数据，因为在通常的情况下AOF文件保存的数据比RDB文件要更加完整。而RDB作为候选方案，对当前内存的数据进行定期的备份，来防范AOF可能存在的BUG。</p>
<ul>
<li>性能建议</li>
</ul>
<p>考虑到RDB做数据备份，建议在Slave上持久化RDB文件。</p>
<p>如果这时候Enable AOF，好处是最坏的情况下丢失的数据也不会超过2s，启动脚本简单的load自己的AOF文件就可以看，代价是带来了持续的IO，以及rewrite过程中将产生的新数据写到新文件造成的阻塞难以避免。在磁盘允许的情况下，应该尽量减少AOF重写的频率。</p>
<p>如果不Enable AOF，仅仅依靠主从复制来实现高可靠也是可以的。这样能节省一大笔IO操作，也减少了rewrite时带来的系统资源占用，但是如果master和slave同时坏掉，会丢失十几分钟的数据，启动脚本要比较Master、Slave中的RDB文件，载入比较新的哪一个。</p>
<h1 id="redis的主从复制"><a href="#redis的主从复制" class="headerlink" title="redis的主从复制"></a>redis的主从复制</h1><p>redis支持主从同步的，同时支持一主多从以及多级从结构。主从结构的优点在于：</p>
<ul>
<li>冗余备份</li>
<li>提升读性能。</li>
</ul>
<p>redis主从结构中，一般推荐关闭主服务器的数据持久化功能，只让从服务器进行数据持久化，这样可以提高主服务器的处理性能，。。</p>
<p>主从架构中，从服务器通常设置为只读模式，这样可以避免从服务器的数据被误修改。但是从服务器仍然可以接受config等指令，不应该将从服务器直接暴露到不安全的网络环境中。如果必须如此，需要考虑给其指令进行重命名，避免误操作。</p>
<h2 id="主从同步的配置方法"><a href="#主从同步的配置方法" class="headerlink" title="主从同步的配置方法"></a>主从同步的配置方法</h2><ol>
<li>配置的是Slave库。</li>
<li>从库配置：slaveof 主库ip 主库port， 每次与master断开之后，都需要进行重新连接，除非你配置进redis.conf中的info replication。</li>
<li>修改配置文件的细节操作：<ul>
<li>拷贝多个redis.conf文件</li>
<li>开启daemonize yes</li>
<li>pid文件名字</li>
<li>指定端口</li>
<li>log文件名称</li>
<li>dump.rdb文件名称。</li>
</ul>
</li>
</ol>
<h2 id="一主二仆的配置"><a href="#一主二仆的配置" class="headerlink" title="一主二仆的配置"></a>一主二仆的配置</h2><ul>
<li>初始化启动一个Master和两个Slave</li>
<li>查看日志包括主机，备份机的日志，以及info replication</li>
<li>上一个Slave可以是下一个Slave的Master，Slave同样可以接受其他Slave的连接和同步请求，那么该Slave作为了链条中的下一个的Master，可以有效减轻master的写压力。</li>
<li>中途变更转向时会清除之前的数据，重新拷贝最新的slaveof ip port</li>
<li>slaveof no one， 使得当前的数据库停止与其他数据库的同步，转成主数据库。</li>
</ul>
<h2 id="主从复制原理"><a href="#主从复制原理" class="headerlink" title="主从复制原理"></a>主从复制原理</h2><ol>
<li>Slave启动成功连接到master之后会发送一个sync命令。</li>
<li>Master接到命令后，调用bgsave指令来创建一个子进程专门进行数据持久化工作，也就是讲主服务器的数据写入RDB文件中。在数据持久化过程中，主服务器将执行的写指令都缓存在内存中。</li>
<li>bgsave指令完成之后，主服务器会将持久化好的RDB文件发送给服务器，从服务器接到此文件后会将其存储到磁盘上，然后再将读取到内存中。这个动作完成之后，主服务器会将这段时间缓存的写指令以redis协议的格式发送给从服务器。也就是全量复制和增量复制结合使用。</li>
</ol>
<ul>
<li>全量复制与增量复制<ul>
<li>全量复制：slave服务在接收到数据库文件数据之后，将其存盘并加载到内存中。</li>
<li>增量复制：master继续将新的收集到的修改命令依次传给slave，完成同步。</li>
</ul>
</li>
<li><p>多个从服务器同时发来SYNC指令，主服务器也只会执行一个bgsave，然后把持久化好的RDB文件发送给多个下游节点。redis2.8之前，从服务器和主服务器断开连接之后，都会进行一次主从之间的全量数据同步，2.8之后，redis支持效率更高的增量同步策略。</p>
</li>
<li><p>主服务器会在内存中维护一个缓冲区，缓冲区中存储着将要发给从服务器的内容。从服务器在与主服务器出现网络瞬间断开之后，从服务器会尝试与主服务器连接，一旦连接成功，从服务器就会把希望同步的主服务器ID和希望请求的数据偏移量位置发送给主服务器。主服务器接收到这种同步请求之后，首先会验证主服务器ID是否和自己的ID匹配，其次会检查请求的偏移量是否存在于自己的缓冲区中，如果两者都满足的话，主服务器会向服务器发送增量内容。</p>
</li>
</ul>
<h1 id="redis事务管理"><a href="#redis事务管理" class="headerlink" title="redis事务管理"></a>redis事务管理</h1><p>redis事务处理的基础为MULTI、EXEC、DISCARD、WATCH四个指令。</p>
<p>MULTI：用来组装一个事务，标记事务的开始<br>EXEC：用来执行一个事务<br>DISCARD：用来取消一个事务<br>WATCH：用来监视一些可以，一旦这些key在事务执行前被改变，则取消事务的执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">redis&gt; MULTI</div><div class="line">OK</div><div class="line">redis&gt; INCR user_id</div><div class="line">QUEUED</div><div class="line">redis&gt; INCR user_id</div><div class="line">QUEUED</div><div class="line">redis&gt; INCR user_id</div><div class="line">QUEUED</div><div class="line">redis&gt; PING</div><div class="line">QUEUED</div><div class="line">redis&gt; EXEC</div><div class="line">1) (integer) 1</div><div class="line">2) (integer) 2</div><div class="line">3) (integer) 3</div><div class="line">4) PONG</div></pre></td></tr></table></figure>
<ul>
<li><p>其中QUEUED表示我们在用MULTI组装事务时，每一个命令都会进入到内存队列中缓存起来，如果出现QUEUED则表示我们这个命令成功的插入了缓存队列，将来执行EXEC时，这些被QUEUED的命令都会被组装成一个事务来执行。</p>
</li>
<li><p>事务执行完成之后，如果redis开启了AOF持久化的话，那么一旦事务被成功执行，事务中的命令就会通过write命令一次性写入到磁盘中，如果写入过程中出现故障则会造成部分命令AOF持久化，此时可以使用redis-check-aof工具来修复这个问题，这个问题会将AOF文件中不完整的信息溢出，确保AOF文件完整可用。</p>
</li>
<li><p>事务遇到的错误分为：</p>
<ul>
<li><p>调用EXEC之前的错误：导致某个命令无法成功写入缓冲队列，调用redis会拒绝执行这个事务。</p>
<ul>
<li>语法错误</li>
<li><p>内存不足</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; multi</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; haha</div><div class="line">(error) ERR unknown command &apos;haha&apos;</div><div class="line">127.0.0.1:6379&gt; ping</div><div class="line">QUEUED</div><div class="line">127.0.0.1:6379&gt; exec</div><div class="line">(error) EXECABORT Transaction discarded because of previous errors.</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>调用EXEC之后的错误：redis会忽略这些错误，而是继续向下执行事务中的其他命令。也就是某一条命令失败并不会影响其他命令的执行。</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">127.0.0.1:6379&gt; multi</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; set age 23</div><div class="line">QUEUED</div><div class="line">127.0.0.1:6379&gt; sadd age 15</div><div class="line">QUEUED</div><div class="line">127.0.0.1:6379&gt; set age 29</div><div class="line">QUEUED</div><div class="line">127.0.0.1:6379&gt; exec</div><div class="line">1) OK</div><div class="line">2) (error) WRONGTYPE Operation against a key holding the wrong kind of value</div><div class="line">3) OK</div><div class="line">127.0.0.1:6379&gt; get age</div><div class="line">&quot;29&quot;</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p>WATCH指令可以使用类似于乐观锁的效果也就是CAS，WATCH本身作用是监视某些key是否被改动过，只要还没有真正的触发事务，WATCH都会监视指定的key，一旦发现某个key被修改了，在执行EXEC时就会返回nil，表示事务无法触发。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">  127.0.0.1:6379&gt; set age 23</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; watch age</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; set age 24</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; multi</div><div class="line">OK</div><div class="line">127.0.0.1:6379&gt; set age 25</div><div class="line">QUEUED</div><div class="line">127.0.0.1:6379&gt; get age</div><div class="line">QUEUED</div><div class="line">127.0.0.1:6379&gt; exec</div><div class="line">(nil)</div></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/数据结构-两个栈实现一个队列以及两个队列实现一个栈/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/数据结构-两个栈实现一个队列以及两个队列实现一个栈/" itemprop="url">数据结构-两个栈实现一个队列和两个队列实现一个栈</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T19:15:03+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="两个栈实现一个队列"><a href="#两个栈实现一个队列" class="headerlink" title="两个栈实现一个队列"></a>两个栈实现一个队列</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">import java.util.Stack;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/13</div><div class="line"> */</div><div class="line">public class TwoStackImpQueue &#123;</div><div class="line">    private Stack&lt;Integer&gt; stack1 = new Stack&lt;&gt;();</div><div class="line">    private Stack&lt;Integer&gt; stack2 = new Stack&lt;&gt;();</div><div class="line"></div><div class="line">    public void push(int node) &#123;</div><div class="line">        stack1.push(node);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Integer pop() &#123;</div><div class="line">        if (stack2.size() &lt;= 0) &#123;</div><div class="line">            while (stack1.size() &gt; 0) &#123;</div><div class="line">                stack2.push(stack1.pop());</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        if (stack2.isEmpty()) &#123;</div><div class="line">            try &#123;</div><div class="line">                throw new Exception(&quot;queue is empty&quot;);</div><div class="line">            &#125; catch (Exception e)&#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return stack2.pop();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="两个队列实现一个栈"><a href="#两个队列实现一个栈" class="headerlink" title="两个队列实现一个栈"></a>两个队列实现一个栈</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.Queue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/13</div><div class="line"> */</div><div class="line">public class TwoListImpStack &#123;</div><div class="line">    private Queue&lt;Integer&gt; list1 = new LinkedList&lt;&gt;();</div><div class="line">    private Queue&lt;Integer&gt; list2 = new LinkedList&lt;&gt;();</div><div class="line"></div><div class="line">    public void push(int node) &#123;</div><div class="line">        if (list1.isEmpty() &amp;&amp; list2.isEmpty())&#123;</div><div class="line">            list1.add(node);</div><div class="line">        &#125; else if (list1.isEmpty()) &#123;</div><div class="line">            list2.add(node);</div><div class="line">        &#125; else &#123;</div><div class="line">            list2.add(node);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Integer pop() &#123;</div><div class="line">        if (list1.isEmpty() &amp;&amp; list2.isEmpty())&#123;</div><div class="line">            try &#123;</div><div class="line">                throw new Exception(&quot;stack is Empty!&quot;);</div><div class="line">            &#125; catch (Exception e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125; else if (list1.isEmpty()) &#123;</div><div class="line">            while (list2.size() &gt; 1) &#123;</div><div class="line">                list1.add(list2.poll());</div><div class="line">            &#125;</div><div class="line">            return list2.poll();</div><div class="line">        &#125; else &#123;</div><div class="line">            while (list1.size() &gt; 1) &#123;</div><div class="line">                list2.add(list1.poll());</div><div class="line">            &#125;</div><div class="line">            return list1.poll();</div><div class="line">        &#125;</div><div class="line">        return null;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/算法之查找/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/算法之查找/" itemprop="url">算法-查找</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T18:40:18+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/algorithms/" itemprop="url" rel="index">
                    <span itemprop="name">algorithms</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数组重复元素问题"><a href="#数组重复元素问题" class="headerlink" title="数组重复元素问题"></a>数组重复元素问题</h1><h2 id="给定一个数组，查看数组是否存在重复元素"><a href="#给定一个数组，查看数组是否存在重复元素" class="headerlink" title="给定一个数组，查看数组是否存在重复元素"></a>给定一个数组，查看数组是否存在重复元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashSet;</div><div class="line">import java.util.Set;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/6</div><div class="line"> */</div><div class="line">public class ContainsDuplicate_217 &#123;</div><div class="line">    public boolean containsDuplicate(int[] nums) &#123;</div><div class="line">        Set&lt;Integer&gt; record = new HashSet&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class="line">            if (record.contains(nums[i]))</div><div class="line">                return true;</div><div class="line">            record.add(nums[i]);</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给定一个数组，是否存在两个元素重复，并且两个元素下标之差的绝对值小于等于k。"><a href="#给定一个数组，是否存在两个元素重复，并且两个元素下标之差的绝对值小于等于k。" class="headerlink" title="给定一个数组，是否存在两个元素重复，并且两个元素下标之差的绝对值小于等于k。"></a>给定一个数组，是否存在两个元素重复，并且两个元素下标之差的绝对值小于等于k。</h2><p>维持set的长度为K</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.HashSet;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/6</div><div class="line"> */</div><div class="line">public class ContainsDuplicateII &#123;</div><div class="line">    public boolean containsNearbyDuplicate(int[] nums, int k) &#123;</div><div class="line">        HashSet&lt;Integer&gt; record = new HashSet&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class="line">            if (record.contains(nums[i]))</div><div class="line">                return true;</div><div class="line">            record.add(nums[i]);</div><div class="line">            if (record.size() == k + 1)</div><div class="line">                record.remove(nums[i-k]);</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给定一个数组，是否存在两个元素的之差的绝对值小于等于t，并且两个元素下标之差的绝对值小于等于k。"><a href="#给定一个数组，是否存在两个元素的之差的绝对值小于等于t，并且两个元素下标之差的绝对值小于等于k。" class="headerlink" title="给定一个数组，是否存在两个元素的之差的绝对值小于等于t，并且两个元素下标之差的绝对值小于等于k。"></a>给定一个数组，是否存在两个元素的之差的绝对值小于等于t，并且两个元素下标之差的绝对值小于等于k。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashSet;</div><div class="line">import java.util.TreeSet;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/6</div><div class="line"> */</div><div class="line">public class ContainsDuplicateIII &#123;</div><div class="line">    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) &#123;</div><div class="line">        if (nums.length &lt; 2 || k == 0) &#123;</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">        TreeSet&lt;Long&gt; set = new TreeSet&lt;&gt;();</div><div class="line"></div><div class="line">        int i = 0;</div><div class="line">        while (i &lt; nums.length) &#123;</div><div class="line">            Long floor = set.floor((long) nums[i]);</div><div class="line">            Long ceiling = set.ceiling((long) nums[i]);</div><div class="line">            if ((floor != null &amp;&amp; nums[i] - floor &lt;= t ) ||</div><div class="line">                    (ceiling != null &amp;&amp; ceiling - nums[i] &lt;= t)) &#123;</div><div class="line">                return true;</div><div class="line">            &#125;</div><div class="line">            set.add((long) nums[i++]);</div><div class="line">            if (i &gt; k) &#123;</div><div class="line">                set.remove((long) nums[i - k - 1]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="数组和问题"><a href="#数组和问题" class="headerlink" title="数组和问题"></a>数组和问题</h1><h2 id="数组中查找是否存在和为target的问题"><a href="#数组中查找是否存在和为target的问题" class="headerlink" title="数组中查找是否存在和为target的问题"></a>数组中查找是否存在和为target的问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class TwoSum_1 &#123;</div><div class="line">    //1、暴力O(N^2)</div><div class="line">    public int[] twoSum3(int[] nums, int target) &#123;</div><div class="line">        int[] res = new int[2];</div><div class="line">        for (int i = 0; i &lt; nums.length-1; i++) &#123;</div><div class="line">            for (int j = i + 1; j &lt; nums.length; j++) &#123;</div><div class="line">                if (nums[i] + nums[j] == target) &#123;</div><div class="line">                    res[0] = i;</div><div class="line">                    res[1] = j;</div><div class="line">                    return res;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //O(N) O(N)</div><div class="line">    public int[] twoSum(int[] nums, int target) &#123;</div><div class="line">        int[] res = new int[2];</div><div class="line">        HashMap&lt;Integer, Integer&gt; record = new HashMap&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class="line">            int complement = target - nums[i];</div><div class="line">            if (record.containsKey(complement)) &#123;</div><div class="line">                res[1] = i;</div><div class="line">                res[0] = record.get(complement);</div><div class="line">                return res;</div><div class="line">            &#125;</div><div class="line">            record.put(nums[i], i);</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="查找表问题"><a href="#查找表问题" class="headerlink" title="查找表问题"></a>查找表问题</h1><h2 id="给定四个整形列表，A-i-B-j-C-k-D-l-0-找出所有的i-j-k-l的个数。"><a href="#给定四个整形列表，A-i-B-j-C-k-D-l-0-找出所有的i-j-k-l的个数。" class="headerlink" title="给定四个整形列表，A[i] + B[j] + C[k] + D[l] = 0,找出所有的i,j,k,l的个数。"></a>给定四个整形列表，A[i] + B[j] + C[k] + D[l] = 0,找出所有的i,j,k,l的个数。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/5</div><div class="line"> */</div><div class="line">public class FourSumII_454 &#123;</div><div class="line">    //查找表中记录C,D中任意两个和的可能次数O(N^2)</div><div class="line">    public int fourSumCount(int[] A, int[] B, int[] C, int[] D) &#123;</div><div class="line">        HashMap&lt;Integer, Integer&gt; record = new HashMap&lt;&gt;();</div><div class="line">        for (int aC : C) &#123;</div><div class="line">            for (int aD : D) &#123;</div><div class="line">                int tmp = aC + aD;</div><div class="line">                if (record.containsKey(tmp)) &#123;</div><div class="line">                    record.put(tmp, record.get(tmp) + 1);</div><div class="line">                &#125; else &#123;</div><div class="line">                    record.put(tmp, 1);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        int count = 0;</div><div class="line">        for (int i = 0; i &lt; A.length; i++) &#123;</div><div class="line">            for (int j = 0; j &lt; B.length; j++) &#123;</div><div class="line">                int tmp = 0 - A[i] - B[j];</div><div class="line">                if (record.containsKey(tmp)) &#123;</div><div class="line">                    count += record.get(tmp);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return count;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="返回两个数组的交集"><a href="#返回两个数组的交集" class="headerlink" title="返回两个数组的交集"></a>返回两个数组的交集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashSet;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class IntersectoionOfTwoArray &#123;</div><div class="line">    public int[] intersection(int[] num1, int[] num2) &#123;</div><div class="line">        HashSet&lt;Integer&gt; record = new HashSet&lt;&gt;();</div><div class="line">        HashSet&lt;Integer&gt; result = new HashSet&lt;&gt;();</div><div class="line"></div><div class="line">        for (int aNum1 : num1) &#123;</div><div class="line">            record.add(aNum1);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        for (int aNum1 : num2) &#123;</div><div class="line">            if (record.contains(aNum1))</div><div class="line">                result.add(aNum1);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        int[] resultA = new int[result.size()];</div><div class="line"></div><div class="line">        int j = 0;</div><div class="line">        for (int i : result) &#123;</div><div class="line">            resultA[j++] = i;</div><div class="line">        &#125;</div><div class="line">        return resultA;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给定两个字符串s-t，确定s是否可以通过替换变成t。Given-“egg”-“add”-return-true-Given-“foo”-“bar”-return-false-Given-“paper”-“title”-return-true"><a href="#给定两个字符串s-t，确定s是否可以通过替换变成t。Given-“egg”-“add”-return-true-Given-“foo”-“bar”-return-false-Given-“paper”-“title”-return-true" class="headerlink" title="给定两个字符串s,t，确定s是否可以通过替换变成t。Given “egg”, “add”, return true.Given “foo”, “bar”, return false.Given “paper”, “title”, return true."></a>给定两个字符串s,t，确定s是否可以通过替换变成t。Given “egg”, “add”, return true.Given “foo”, “bar”, return false.Given “paper”, “title”, return true.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashSet;</div><div class="line">import java.util.Set;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class IsomorphicStrings_205 &#123;</div><div class="line">    public boolean isIsomorphic(String s, String t) &#123;</div><div class="line">        int[] num = new int[256];</div><div class="line">        Set&lt;Integer&gt; set = new HashSet&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; num.length; i++)</div><div class="line">            num[i] = Integer.MAX_VALUE;</div><div class="line">        for (int i = 0; i &lt; s.length(); i++) &#123;</div><div class="line">            int tmp = t.charAt(i);</div><div class="line">            if (num[s.charAt(i)] == Integer.MAX_VALUE) &#123;</div><div class="line">                num[s.charAt(i)] = tmp;</div><div class="line">                if (set.contains(tmp))</div><div class="line">                    return false;</div><div class="line">                else</div><div class="line">                    set.add(tmp);</div><div class="line">            &#125; else &#123;</div><div class="line">                if (tmp != num[s.charAt(i)])</div><div class="line">                    return false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="i和j的距离与i和k的距离相等"><a href="#i和j的距离与i和k的距离相等" class="headerlink" title="i和j的距离与i和k的距离相等"></a>i和j的距离与i和k的距离相等</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/5</div><div class="line"> */</div><div class="line">public class NumberOfBoomerangs_447 &#123;</div><div class="line">    public int numberOfBoomerangs(int[][] points) &#123;</div><div class="line">        int res = 0;</div><div class="line">        for (int i = 0; i &lt; points.length; i++) &#123;</div><div class="line">            //和i点的距离，距离出现的频率</div><div class="line">            HashMap&lt;Integer, Integer&gt; record = new HashMap&lt;&gt;();</div><div class="line">            for (int j = 0; j &lt; points.length; j++) &#123;</div><div class="line">                if (j != i) &#123;</div><div class="line">                    int dis = dis(points[i], points[j]);</div><div class="line">                    if (record.containsKey(dis))&#123;</div><div class="line">                        record.put(dis, record.get(dis)+1);</div><div class="line">                    &#125; else &#123;</div><div class="line">                        record.put(dis, 1);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            for (Integer integer : record.keySet()) &#123;</div><div class="line">                if (record.get(integer) &gt;= 2) &#123;</div><div class="line">                    res += record.get(integer) * (record.get(integer)-1);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private int dis(int[] point, int[] point1) &#123;</div><div class="line">        return (point[0] - point1[0]) * (point[0] - point1[0])</div><div class="line">                + (point[1] - point1[1]) * (point[1] - point1[1]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="按照字符串的频率逆序排列"><a href="#按照字符串的频率逆序排列" class="headerlink" title="按照字符串的频率逆序排列"></a>按照字符串的频率逆序排列</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.*;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class SortCharactersByFrequency_451 &#123;</div><div class="line">    public String frequencySort(String s) &#123;</div><div class="line">        HashMap&lt;Character, Integer&gt; map = new HashMap&lt;&gt;();</div><div class="line">        for (char c : s.toCharArray()) &#123;</div><div class="line">            if (map.containsKey(c))</div><div class="line">                map.put(c, map.get(c) + 1);</div><div class="line">            else</div><div class="line">                map.put(c, 1);</div><div class="line">        &#125;</div><div class="line">        List&lt;Character&gt; [] bucket = new List[s.length() + 1];</div><div class="line">        for (char key : map.keySet()) &#123;</div><div class="line">            int freq = map.get(key);</div><div class="line">            if (bucket[freq] == null)</div><div class="line">                bucket[freq] = new ArrayList&lt;&gt;();</div><div class="line">            bucket[freq].add(key);</div><div class="line">        &#125;</div><div class="line">        StringBuilder sb = new StringBuilder();</div><div class="line">        for (int j = bucket.length - 1; j &gt;= 0; j--) &#123;</div><div class="line">            if (bucket[j] != null) &#123;</div><div class="line">                for (char ch : bucket[j]) &#123;</div><div class="line">                    for (int i = 0; i &lt; map.get(ch); i++)</div><div class="line">                        sb.append(ch);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="判断t和S是否由相同的char组成"><a href="#判断t和S是否由相同的char组成" class="headerlink" title="判断t和S是否由相同的char组成"></a>判断t和S是否由相同的char组成</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class ValidAnagram_242 &#123;</div><div class="line">    public boolean isAnagram(String s, String t) &#123;</div><div class="line">        if (s == null &amp;&amp; t == null)</div><div class="line">            return true;</div><div class="line">        if (s == null || t == null)</div><div class="line">            return false;</div><div class="line">        if (s.length() != t.length())</div><div class="line">            return false;</div><div class="line">        HashMap&lt;Character, Integer&gt; sMap = new HashMap&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; s.length(); i++) &#123;</div><div class="line">            char s1 = s.charAt(i);</div><div class="line">            char t1 = t.charAt(i);</div><div class="line">            if (sMap.containsKey(s1))</div><div class="line">                sMap.put(s1, sMap.get(s1)+1);</div><div class="line">            else</div><div class="line">                sMap.put(s1,1);</div><div class="line">            if (sMap.containsKey(t1))</div><div class="line">                sMap.put(t1, sMap.get(t1)-1);</div><div class="line">            else</div><div class="line">                sMap.put(t1, -1);</div><div class="line">        &#125;</div><div class="line">        for (Character ch : sMap.keySet()) &#123;</div><div class="line">            if (sMap.get(ch) != 0)</div><div class="line">                return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public boolean isAnagram1(String s, String t) &#123;</div><div class="line">        int[] chars = new int[26];</div><div class="line">        for (char c : s.toCharArray()) &#123;</div><div class="line">            chars[c-&apos;a&apos;]++;</div><div class="line">        &#125;</div><div class="line">        for (char c : t.toCharArray()) &#123;</div><div class="line">            chars[c-&apos;a&apos;]--;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        for (int i : chars) &#123;</div><div class="line">            if (i != 0)</div><div class="line">                return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="判断一个字符串是否遵循固定的样式，如pattern-“abba”-str-“dog-cat-cat-dog”-should-return-true"><a href="#判断一个字符串是否遵循固定的样式，如pattern-“abba”-str-“dog-cat-cat-dog”-should-return-true" class="headerlink" title="判断一个字符串是否遵循固定的样式，如pattern = “abba”, str = “dog cat cat dog” should return true."></a>判断一个字符串是否遵循固定的样式，如pattern = “abba”, str = “dog cat cat dog” should return true.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.HashSet;</div><div class="line">import java.util.Objects;</div><div class="line">import java.util.Set;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class WordPattern_290 &#123;</div><div class="line">    public boolean wordPattern(String pattern, String str) &#123;</div><div class="line">        if (pattern == null || str == null)</div><div class="line">            return false;</div><div class="line">        HashMap&lt;Object, Integer&gt; map = new HashMap&lt;&gt;();</div><div class="line">        char[] chars = pattern.toCharArray();</div><div class="line">        String[] strings = str.split(&quot; &quot;);</div><div class="line">        if (chars.length != strings.length)</div><div class="line">            return false;</div><div class="line">        for (int i = 0; i &lt; chars.length; i++) &#123;</div><div class="line">            if (!Objects.equals(map.put(chars[i], i), map.put(strings[i], i)))</div><div class="line">                return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public boolean wordPattern1(String pattern, String str) &#123;</div><div class="line">        char[] chars = pattern.toCharArray();</div><div class="line">        String[] strings = str.split(&quot; &quot;);</div><div class="line">        String[] pat = new String[26];</div><div class="line">        if (chars.length != strings.length)</div><div class="line">            return false;</div><div class="line">        Set&lt;String&gt; set = new HashSet&lt;&gt;();</div><div class="line"></div><div class="line">        for (int i = 0; i &lt; chars.length; i++) &#123;</div><div class="line">            if (pat[chars[i]-&apos;a&apos;] == null) &#123;</div><div class="line">                pat[chars[i]-&apos;a&apos;] = strings[i];</div><div class="line">                if (set.contains(strings[i]))</div><div class="line">                    return false;</div><div class="line">                else</div><div class="line">                    set.add(strings[i]);</div><div class="line">            &#125; else &#123;</div><div class="line">                if (!strings[i].equals(pat[chars[i]-&apos;a&apos;]))</div><div class="line">                    return false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="happy-Number判定"><a href="#happy-Number判定" class="headerlink" title="happy Number判定"></a>happy Number判定</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">package leetcode.search;</div><div class="line"></div><div class="line">import java.util.HashSet;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/4</div><div class="line"> */</div><div class="line">public class HappyNum_202 &#123;</div><div class="line">    public boolean isHappy(int n) &#123;</div><div class="line">        HashSet&lt;Integer&gt; set = new HashSet&lt;&gt;();</div><div class="line">        int sum = 0;</div><div class="line">        while (n != 1) &#123;</div><div class="line">            set.add(n);</div><div class="line">            while (n != 0) &#123;</div><div class="line">                sum += (n % 10) * (n % 10);</div><div class="line">                n = n / 10;</div><div class="line">            &#125;</div><div class="line">            n = sum;</div><div class="line">            sum = 0;</div><div class="line">            if (set.contains(n))</div><div class="line">                return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/算法之回溯法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/算法之回溯法/" itemprop="url">算法-回溯法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T17:46:54+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/algorithms/" itemprop="url" rel="index">
                    <span itemprop="name">algorithms</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="组合问题"><a href="#组合问题" class="headerlink" title="组合问题"></a>组合问题</h1><h2 id="返回C-n-k-的所有可能值"><a href="#返回C-n-k-的所有可能值" class="headerlink" title="返回C(n,k)的所有可能值"></a>返回C(n,k)的所有可能值</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class Combinations_77 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; combine(int n, int k) &#123;</div><div class="line">        if (n &lt;= 0 || k &lt;= 0 || k &gt; n)</div><div class="line">            return res;</div><div class="line">        combine(n, k, 1, new ArrayList&lt;&gt;());</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 求解C(n,k),</div><div class="line">     * @param n</div><div class="line">     * @param k</div><div class="line">     * @param start</div><div class="line">     * @param list</div><div class="line">     */</div><div class="line">    private void combine(int n, int k, int start, List&lt;Integer&gt; list) &#123;</div><div class="line">        if (list.size() == k) &#123;</div><div class="line">            res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        for (int i = start; i &lt;= n- (k - list.size()) + 1; i++) &#123;</div><div class="line">            list.add(i);</div><div class="line">            combine(n, k, i + 1, list);</div><div class="line">            list.remove(list.size() - 1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="组合和等于target问题"><a href="#组合和等于target问题" class="headerlink" title="组合和等于target问题"></a>组合和等于target问题</h1><h2 id="给定一个数组-数组里面的值可以选无数次。"><a href="#给定一个数组-数组里面的值可以选无数次。" class="headerlink" title="给定一个数组,数组里面的值可以选无数次。"></a>给定一个数组,数组里面的值可以选无数次。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.Arrays;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class CombinationSum_39 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; combinationSum(int[] candidates, int target) &#123;</div><div class="line">        Arrays.sort(candidates);</div><div class="line">        combinationSum(candidates, target, new ArrayList&lt;&gt;(), 0);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void combinationSum(int[] candidates, int target, ArrayList&lt;Integer&gt; list, int pos) &#123;</div><div class="line">        if (target == 0) &#123;</div><div class="line">            res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        for (int i = pos; i &lt; candidates.length; i++) &#123;</div><div class="line">            if (target &lt; candidates[i]) &#123;</div><div class="line">                return;</div><div class="line">            &#125; else &#123;</div><div class="line">                list.add(candidates[i]);</div><div class="line">                combinationSum(candidates, target - candidates[i], list, i);</div><div class="line">                list.remove(list.size() - 1);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给定一个数组，数组中的数只能用一次"><a href="#给定一个数组，数组中的数只能用一次" class="headerlink" title="给定一个数组，数组中的数只能用一次"></a>给定一个数组，数组中的数只能用一次</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.Arrays;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Set;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class CombinationSumII_40 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; combinationSum2(int[] candidates, int target) &#123;</div><div class="line">        Arrays.sort(candidates);</div><div class="line">        combinationSum(candidates, target, new ArrayList&lt;&gt;(), 0);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void combinationSum(int[] candidates, int target, ArrayList&lt;Integer&gt; list, int pos) &#123;</div><div class="line">        if (target == 0) &#123;</div><div class="line">            res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        for (int i = pos; i &lt; candidates.length; i++) &#123;</div><div class="line">            if (i != pos &amp;&amp; candidates[i] == candidates[i-1])</div><div class="line">                continue;</div><div class="line">            if (target &lt; candidates[i]) &#123;</div><div class="line">                return;</div><div class="line">            &#125; else &#123;</div><div class="line">                list.add(candidates[i]);</div><div class="line">                combinationSum(candidates, target - candidates[i], list, i+1);</div><div class="line">                list.remove(list.size() - 1);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="从1-9中选取k个数和为n"><a href="#从1-9中选取k个数和为n" class="headerlink" title="从1-9中选取k个数和为n"></a>从1-9中选取k个数和为n</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class CombinationSumIII_216 &#123;</div><div class="line">    List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">    public static final int[] nums = &#123;1,2,3,4,5,6,7,8,9&#125;;</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; combinationSum3(int k, int n) &#123;</div><div class="line">        if (k &lt;= 0 || n &lt;= 0)</div><div class="line">            return res;</div><div class="line">        combinationSum3(k, n, 0, new ArrayList&lt;Integer&gt;());</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void combinationSum3(int k, int sum, int index, ArrayList&lt;Integer&gt; list) &#123;</div><div class="line">         if (k == 0 &amp;&amp; sum == 0)&#123;</div><div class="line">             res.add(new ArrayList&lt;&gt;(list));</div><div class="line">             return;</div><div class="line">         &#125;</div><div class="line"></div><div class="line">         for (int i = index; i &lt; nums.length; i++) &#123;</div><div class="line">             if (sum &lt; nums[index])</div><div class="line">                 return;</div><div class="line">             list.add(nums[i]);</div><div class="line">             combinationSum3(k-1, sum- nums[i], i + 1, list);</div><div class="line">             list.remove(list.size() - 1);</div><div class="line">         &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="电话数字和字母映射的组合问题"><a href="#电话数字和字母映射的组合问题" class="headerlink" title="电话数字和字母映射的组合问题"></a>电话数字和字母映射的组合问题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Objects;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class LetterCombinationsOfAPhoneNumber_17 &#123;</div><div class="line"></div><div class="line">    private static final String[] letterMap  =  &#123;&quot; &quot;, &quot;&quot;,&quot;abc&quot;,&quot;def&quot;,&quot;ghi&quot;,&quot;jkl&quot;,&quot;mno&quot;,&quot;pqrs&quot;,&quot;tuv&quot;,&quot;wxyz&quot;&#125;;</div><div class="line"></div><div class="line">    private List&lt;String&gt; res = new ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    public List&lt;String&gt; letterCombinations(String digits) &#123;</div><div class="line">        if (digits == null || Objects.equals(digits, &quot;&quot;))</div><div class="line">            return res;</div><div class="line">        findCombation(digits, 0, &quot;&quot;);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void findCombation(String digits, int index, String s) &#123;</div><div class="line">        if (index == digits.length()) &#123;</div><div class="line">            //保存s</div><div class="line">            res.add(s);</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        char c = digits.charAt(index);</div><div class="line">        String letters = letterMap[c - &apos;0&apos;];</div><div class="line">        for (int i = 0; i &lt; letters.length(); i++) &#123;</div><div class="line">            findCombation(digits, index + 1, s + letters.charAt(i));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="N皇后问题"><a href="#N皇后问题" class="headerlink" title="N皇后问题"></a>N皇后问题</h1><p>行，列，左右对角线</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/11</div><div class="line"> */</div><div class="line">public class NQueens_51 &#123;</div><div class="line">    private List&lt;List&lt;String&gt;&gt; res = new LinkedList&lt;&gt;();</div><div class="line">    boolean[] col, dia1, dia2;</div><div class="line">    public List&lt;List&lt;String&gt;&gt; solveNQueens(int n) &#123;</div><div class="line">        res.clear();</div><div class="line">        List&lt;Integer&gt; row = new LinkedList&lt;&gt;();</div><div class="line">        col = new boolean[n];</div><div class="line">        dia1 = new boolean[2*n - 1];</div><div class="line">        dia2 = new boolean[2*n - 1];</div><div class="line">        putQueen(n, 0, row);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     *</div><div class="line">     * @param n n皇后问题</div><div class="line">     * @param index 第index行</div><div class="line">     * @param row 数组，row[0]=i表示第0行第i列放皇后</div><div class="line">     */</div><div class="line">    private void putQueen(int n, int index, List&lt;Integer&gt; row) &#123;</div><div class="line">        if (index == n) &#123;</div><div class="line">            res.add(generateBoard(n, row));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        for (int i = 0; i &lt; n; i++) &#123;</div><div class="line">            if (!col[i] &amp;&amp; !dia1[index + i] &amp;&amp; !dia2[index-i+n-1]) &#123;</div><div class="line">                row.add(i);</div><div class="line">                col[i] = true;</div><div class="line">                dia1[index + i] = true;</div><div class="line">                dia2[index-i+n-1] = true;</div><div class="line">                putQueen(n, index + 1, row);</div><div class="line">                col[i] = false;</div><div class="line">                dia1[index + i] = false;</div><div class="line">                dia2[index-i+n-1] = false;</div><div class="line">                row.remove(row.size() -1);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private List&lt;String&gt; generateBoard(int n, List&lt;Integer&gt; row) &#123;</div><div class="line">        List&lt;String&gt; board = new ArrayList&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; n; i++) &#123;</div><div class="line">            StringBuilder sb = new StringBuilder();</div><div class="line">            for (int j = 0; j &lt; n; j ++) &#123;</div><div class="line">                if (j == row.get(i)) &#123;</div><div class="line">                    sb.append(&quot;Q&quot;);</div><div class="line">                &#125; else &#123;</div><div class="line">                    sb.append(&quot;.&quot;);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            board.add(sb.toString());</div><div class="line">        &#125;</div><div class="line">        return board;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        NQueens_51 queen = new NQueens_51();</div><div class="line">        queen.solveNQueens(8);</div><div class="line">        System.out.println(queen.res);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="WaterFlooding问题"><a href="#WaterFlooding问题" class="headerlink" title="WaterFlooding问题"></a>WaterFlooding问题</h1><h2 id="太平洋，大西洋问题"><a href="#太平洋，大西洋问题" class="headerlink" title="太平洋，大西洋问题"></a>太平洋，大西洋问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/11</div><div class="line"> */</div><div class="line">public class PacificAtlanticWaterFlow_417 &#123;</div><div class="line">    public List&lt;int[]&gt; pacificAtlantic(int[][] matrix) &#123;</div><div class="line">        List&lt;int[]&gt; res = new LinkedList&lt;&gt;();</div><div class="line">        if(matrix == null || matrix.length == 0 || matrix[0].length == 0)&#123;</div><div class="line">            return res;</div><div class="line">        &#125;</div><div class="line">        int n = matrix.length, m = matrix[0].length;</div><div class="line">        boolean[][] pacific = new boolean[n][m];</div><div class="line">        boolean[][] atlantic = new boolean[n][m];</div><div class="line">        for(int i=0; i&lt;n; i++)&#123;</div><div class="line">            dfs(matrix, pacific, Integer.MIN_VALUE, i, 0);</div><div class="line">            dfs(matrix, atlantic, Integer.MIN_VALUE, i, m-1);</div><div class="line">        &#125;</div><div class="line">        for(int i=0; i&lt;m; i++)&#123;</div><div class="line">            dfs(matrix, pacific, Integer.MIN_VALUE, 0, i);</div><div class="line">            dfs(matrix, atlantic, Integer.MIN_VALUE, n-1, i);</div><div class="line">        &#125;</div><div class="line">        for (int i = 0; i &lt; n; i++)</div><div class="line">            for (int j = 0; j &lt; m; j++)</div><div class="line">                if (pacific[i][j] &amp;&amp; atlantic[i][j])</div><div class="line">                    res.add(new int[] &#123;i, j&#125;);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    int[][]dir = new int[][]&#123;&#123;0,1&#125;,&#123;0,-1&#125;,&#123;1,0&#125;,&#123;-1,0&#125;&#125;;</div><div class="line"></div><div class="line">    public void dfs(int[][]matrix, boolean[][]visited, int height, int x, int y)&#123;</div><div class="line">        int n = matrix.length, m = matrix[0].length;</div><div class="line">        if(x&lt;0 || x&gt;=n || y&lt;0 || y&gt;=m || visited[x][y] || matrix[x][y] &lt; height)</div><div class="line">            return;</div><div class="line">        visited[x][y] = true;</div><div class="line">        for(int[]d:dir)&#123;</div><div class="line">            dfs(matrix, visited, matrix[x][y], x+d[0], y+d[1]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="岛屿数量问题"><a href="#岛屿数量问题" class="headerlink" title="岛屿数量问题"></a>岛屿数量问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class NumbersOfIslands_200 &#123;</div><div class="line">    public int numIslands(char[][] grid) &#123;</div><div class="line">        int count = 0;</div><div class="line">        for (int i = 0; i &lt; grid.length; i++) &#123;</div><div class="line">            for (int j = 0; j &lt; grid[0].length; j++) &#123;</div><div class="line">                if (grid[i][j] == &apos;1&apos;) &#123;</div><div class="line">                    dfs(grid, i, j);</div><div class="line">                    count++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return count;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void dfs(char[][] grid, int x, int y) &#123;</div><div class="line">        if (x &lt; 0 || x &gt;= grid.length || y &lt; 0 || y &gt;= grid[0].length || grid[x][y] != &apos;1&apos;)</div><div class="line">            return;</div><div class="line">        grid[x][y] = &apos;2&apos;;</div><div class="line">        dfs(grid, x-1, y);</div><div class="line">        dfs(grid, x+1,y);</div><div class="line">        dfs(grid, x, y-1);</div><div class="line">        dfs(grid, x, y + 1);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="环绕区域问题"><a href="#环绕区域问题" class="headerlink" title="环绕区域问题"></a>环绕区域问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/11</div><div class="line"> */</div><div class="line">public class SurroundedRegions_130 &#123;</div><div class="line">    int m;</div><div class="line">    int n;</div><div class="line">    public void solve(char[][] board) &#123;</div><div class="line">        if (board == null || board.length == 0)</div><div class="line">            return;</div><div class="line">        m = board.length;</div><div class="line">        n = board[0].length;</div><div class="line">        //从最外圈寻找O,找到之后dfs标记与O相连的O</div><div class="line">        for (int i = 0; i &lt; m; i++) &#123;</div><div class="line">            if (board[i][0] == &apos;O&apos;)</div><div class="line">                dfs(board, i, 0);</div><div class="line">            if (board[i][n-1] == &apos;O&apos;)</div><div class="line">                dfs(board, i, n-1);</div><div class="line">        &#125;</div><div class="line">        for (int j = 0; j &lt; n; j++) &#123;</div><div class="line">            if (board[0][j] == &apos;O&apos;)</div><div class="line">                dfs(board, 0, j);</div><div class="line">            if (board[m-1][j] == &apos;O&apos;)</div><div class="line">                dfs(board, m-1, j);</div><div class="line">        &#125;</div><div class="line">        //修改</div><div class="line">        for (int i = 0; i &lt; m; i++) &#123;</div><div class="line">            for (int j = 0; j &lt; n; j++) &#123;</div><div class="line">                if (board[i][j] != &apos;Z&apos;)&#123;</div><div class="line">                    board[i][j] = &apos;X&apos;;</div><div class="line">                &#125; else &#123;</div><div class="line">                    board[i][j] = &apos;O&apos;;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void dfs(char[][] board, int i, int j) &#123;</div><div class="line">        if (i &lt; 0 || i &gt;= m || j &lt; 0 || j &gt;= n || board[i][j] != &apos;O&apos;)</div><div class="line">            return;</div><div class="line">        board[i][j] = &apos;Z&apos;;</div><div class="line">        dfs(board, i - 1, j);</div><div class="line">        dfs(board, i + 1, j);</div><div class="line">        dfs(board, i, j - 1);</div><div class="line">        dfs(board, i, j + 1);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="字符串分隔问题"><a href="#字符串分隔问题" class="headerlink" title="字符串分隔问题"></a>字符串分隔问题</h1><h2 id="给定一个字符串，将字符串分成若干个子串，每个子串都为回文字符串，返回所有可能的分隔子串集合。"><a href="#给定一个字符串，将字符串分成若干个子串，每个子串都为回文字符串，返回所有可能的分隔子串集合。" class="headerlink" title="给定一个字符串，将字符串分成若干个子串，每个子串都为回文字符串，返回所有可能的分隔子串集合。"></a>给定一个字符串，将字符串分成若干个子串，每个子串都为回文字符串，返回所有可能的分隔子串集合。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class PalindromePartitioning_131 &#123;</div><div class="line">    private List&lt;List&lt;String&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    public List&lt;List&lt;String&gt;&gt; partition(String s) &#123;</div><div class="line">        List&lt;String&gt; list = new ArrayList&lt;&gt;();</div><div class="line">        partition(list, s, 0, &quot;&quot;);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void partition(List&lt;String&gt; list, String s, int pos, String sub) &#123;</div><div class="line">        if (pos == s.length()) &#123;</div><div class="line">            if (sub.equals(&quot;&quot;))</div><div class="line">                res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        String tmp = sub + s.charAt(pos);</div><div class="line">        if (isPalindrome(tmp)) &#123;</div><div class="line">            list.add(tmp);</div><div class="line">            partition(list, s, pos + 1, &quot;&quot;);</div><div class="line">            list.remove(list.size() - 1);</div><div class="line">        &#125;</div><div class="line">        partition(list, s, pos + 1, tmp);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private boolean isPalindrome(String s) &#123;</div><div class="line">        for (int i = 0; i &lt; s.length()/2; i += 1) &#123;</div><div class="line">            if (s.charAt(i) != s.charAt(s.length()-1-i))</div><div class="line">                return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        String s = &quot;aab&quot;;</div><div class="line">        System.out.println(new PalindromePartitioning_131().partition(s));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给定一个字符串，返回其可能的IP值集合。"><a href="#给定一个字符串，返回其可能的IP值集合。" class="headerlink" title="给定一个字符串，返回其可能的IP值集合。"></a>给定一个字符串，返回其可能的IP值集合。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class RestoreIpAddress_93 &#123;</div><div class="line"></div><div class="line">    private List&lt;String&gt; res = new ArrayList&lt;&gt;();</div><div class="line">    public List&lt;String&gt; restoreIpAddresses(String s) &#123;</div><div class="line">        int len = s.length();</div><div class="line">        for (int i = 1; i &lt; 4 &amp;&amp; i &lt; len - 2; i++) &#123;</div><div class="line">            for (int j = i + 1; j &lt; i + 4 &amp;&amp; j &lt; len - 1; j++) &#123;</div><div class="line">                for (int k = j + 1; k &lt; j + 4 &amp;&amp; k &lt; len; k++) &#123;</div><div class="line">                    String s1 = s.substring(0,i);</div><div class="line">                    String s2 = s.substring(i,j);</div><div class="line">                    String s3 = s.substring(j,k);</div><div class="line">                    String s4 = s.substring(k,len);</div><div class="line">                    if (isValid(s1) &amp;&amp; isValid(s2) &amp;&amp; isValid(s3) &amp;&amp; isValid(s4))&#123;</div><div class="line">                        StringBuilder sb = new StringBuilder();</div><div class="line">                        sb.append(s1).append(&quot;.&quot;).append(s2).append(&quot;.&quot;).append(s3)</div><div class="line">                                .append(&quot;.&quot;).append(s4);</div><div class="line">                        res.add(sb.toString());</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private boolean isValid(String s) &#123;</div><div class="line">        return s.length() &lt;= 3 &amp;&amp; s.length() != 0 &amp;&amp; (s.charAt(0) != &apos;0&apos; || s.length() &lt;= 1) &amp;&amp; Integer.parseInt(s) &lt;= 255;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public List&lt;String&gt; restoreIpAddresses1(String s) &#123;</div><div class="line">        dfs(new StringBuilder(), 0, s, 0, 0);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * DFS方法，回溯法应用</div><div class="line">     * @param sb 拼接的字符串</div><div class="line">     * @param pos 字符串的下标</div><div class="line">     * @param s 输入的字符串</div><div class="line">     * @param num 组成的数字</div><div class="line">     * @param dot 点的个数</div><div class="line">     */</div><div class="line">    private void dfs(StringBuilder sb, int pos, String s, int num, int dot) &#123;</div><div class="line">        //终止条件，当检查晚最后一个元素时，如果点为3个，将字符串添加到res中</div><div class="line">        if (pos == s.length()) &#123;</div><div class="line">            if (dot == 3)</div><div class="line">                res.add(sb.toString());</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        //pos时，检查将其添加到当前数字中是否小于255，小于说明可以添加，则将其添加过去，遍历下一位</div><div class="line">        if (num * 10 + s.charAt(pos)-&apos;0&apos; &lt;= 255) &#123;</div><div class="line">            if (pos == 0 || num != 0) &#123;</div><div class="line">                sb.append(s.charAt(pos));</div><div class="line">                dfs(sb, pos + 1, s,num * 10 + s.charAt(pos)-&apos;0&apos;, dot);</div><div class="line">                sb.deleteCharAt(sb.length() - 1);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        //不管pos能否添加，都不添加，而直接加点，迭代下一位</div><div class="line">        if (dot &lt; 3 &amp;&amp; pos &gt; 0)&#123;</div><div class="line">            sb.append(&quot;.&quot;);</div><div class="line">            sb.append(s.charAt(pos));</div><div class="line">            dfs(sb,pos + 1, s, s.charAt(pos) - &apos;0&apos;, dot + 1);</div><div class="line">            sb.deleteCharAt(sb.length() - 1);</div><div class="line">            sb.deleteCharAt(sb.length() - 1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="全排列问题"><a href="#全排列问题" class="headerlink" title="全排列问题"></a>全排列问题</h1><h2 id="给定一个数组，给出数组的所有全排列，没有重复元素"><a href="#给定一个数组，给出数组的所有全排列，没有重复元素" class="headerlink" title="给定一个数组，给出数组的所有全排列，没有重复元素"></a>给定一个数组，给出数组的所有全排列，没有重复元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class Permutations_46 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; permute(int[] nums) &#123;</div><div class="line">        boolean[] used = new boolean[nums.length];</div><div class="line">        List&lt;Integer&gt; list = new ArrayList&lt;&gt;();</div><div class="line">        dfs(list, nums,0, used);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void dfs(List&lt;Integer&gt; list, int[] nums, int pos, boolean[] used) &#123;</div><div class="line">        if (pos == nums.length) &#123;</div><div class="line">            res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class="line">            if (!used[i]) &#123;</div><div class="line">                list.add(nums[i]);</div><div class="line">                used[i] = true;</div><div class="line">                dfs(list, nums, pos + 1, used);</div><div class="line">                used[i] = false;</div><div class="line">                list.remove(list.size() - 1);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="给定一个数组，给出数组的所有全排列，有重复元素"><a href="#给定一个数组，给出数组的所有全排列，有重复元素" class="headerlink" title="给定一个数组，给出数组的所有全排列，有重复元素"></a>给定一个数组，给出数组的所有全排列，有重复元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import sun.misc.Perf;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.Arrays;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class PermutationsII_47 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; permuteUnique(int[] nums) &#123;</div><div class="line">        if (nums == null || nums.length == 0)</div><div class="line">            return res;</div><div class="line">        boolean[] used = new boolean[nums.length];</div><div class="line">        List&lt;Integer&gt; list = new ArrayList&lt;&gt;();</div><div class="line">        Arrays.sort(nums);</div><div class="line">        dfs(list, nums, used);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void dfs(List&lt;Integer&gt; list, int[] nums, boolean[] used) &#123;</div><div class="line">        if (list.size() == nums.length) &#123;</div><div class="line">            res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class="line">            if (used[i])</div><div class="line">                continue;</div><div class="line">            if (i &gt; 0 &amp;&amp; nums[i-1] == nums[i] &amp;&amp; !used[i-1])</div><div class="line">                continue;</div><div class="line">            used[i] = true;</div><div class="line">            list.add(nums[i]);</div><div class="line">            dfs(list, nums, used);</div><div class="line">            used[i] = false;</div><div class="line">            list.remove(list.size()-1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        int[] nums = &#123;2,2,1,1&#125;;</div><div class="line">        PermutationsII_47 p = new PermutationsII_47();</div><div class="line">        p.permuteUnique(nums);</div><div class="line">        System.out.println(p.res);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="子集问题"><a href="#子集问题" class="headerlink" title="子集问题"></a>子集问题</h1><h2 id="返回一个数组的所有子数组-数组没有重复元素"><a href="#返回一个数组的所有子数组-数组没有重复元素" class="headerlink" title="返回一个数组的所有子数组, 数组没有重复元素"></a>返回一个数组的所有子数组, 数组没有重复元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class SubSets_78 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; subsets(int[] nums) &#123;</div><div class="line">        if (nums == null || nums.length == 0)</div><div class="line">            return res;</div><div class="line">        subsets(nums, 0, new ArrayList&lt;Integer&gt;());</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void subsets(int[] nums, int index, ArrayList&lt;Integer&gt; list) &#123;</div><div class="line">        res.add(new ArrayList&lt;&gt;(list));</div><div class="line">        for (int i = index; i &lt; nums.length; i++) &#123;</div><div class="line">            list.add(nums[i]);</div><div class="line">            subsets(nums, i + 1, list);</div><div class="line">            list.remove(list.size() - 1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        SubSets_78 s = new SubSets_78();</div><div class="line">        int[] num = &#123;1,2,3&#125;;</div><div class="line">        s.subsets(num);</div><div class="line">        System.out.println(s.res);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="返回一个数组的所有子数组-数组有重复元素"><a href="#返回一个数组的所有子数组-数组有重复元素" class="headerlink" title="返回一个数组的所有子数组, 数组有重复元素"></a>返回一个数组的所有子数组, 数组有重复元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.Arrays;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class SubSetsII_90 &#123;</div><div class="line">    private List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; subsetsWithDup(int[] nums) &#123;</div><div class="line">        if (nums == null || nums.length == 0)</div><div class="line">            return res;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        subsets(nums, 0, new ArrayList&lt;Integer&gt;());</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void subsets(int[] nums, int index, ArrayList&lt;Integer&gt; list) &#123;</div><div class="line">        if (nums.length == index) &#123;</div><div class="line">            res.add(new ArrayList&lt;&gt;(list));</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        list.add(nums[index]);</div><div class="line">        subsets(nums, index + 1,list);</div><div class="line">        list.remove(list.size() - 1);</div><div class="line">        while (index + 1 &lt; nums.length &amp;&amp; nums[index + 1] == nums[index])</div><div class="line">            index++;</div><div class="line">        subsets(nums, index + 1, list);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="数独问题"><a href="#数独问题" class="headerlink" title="数独问题"></a>数独问题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/11</div><div class="line"> */</div><div class="line">public class Sudoku_Solver_37 &#123;</div><div class="line">    public void solveSudoku(char[][] board) &#123;</div><div class="line">        doSolve(board, 0, 0);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private boolean doSolve(char[][] board, int row, int col) &#123;</div><div class="line">        for (int i = row; i &lt; 9; i++, col = 0) &#123;</div><div class="line">            for (int j = col; j &lt; 9; j++) &#123;</div><div class="line">                if (board[i][j] != &apos;.&apos;)</div><div class="line">                    continue;</div><div class="line">                for (char c = &apos;1&apos;; c &lt;= &apos;9&apos;; c++) &#123;</div><div class="line">                    if (isValid(board, i, j, c)) &#123;</div><div class="line">                        board[i][j] = c;</div><div class="line">                        if (doSolve(board, i, j + 1))</div><div class="line">                            return true;</div><div class="line">                        board[i][j] = &apos;.&apos;;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                return false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private boolean isValid(char[][] board, int row, int col, char num) &#123;</div><div class="line">        int blkrow = row / 3 * 3, blkcol = col / 3 * 3;</div><div class="line">        for (int i = 0; i &lt; 9; i++) &#123;</div><div class="line">            if (board[i][col] == num || board[row][i] == num || board[blkrow + i / 3][blkcol + i % 3] == num)</div><div class="line">                return false;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="给定一个二维数组，判断能否拼成相应的字符串"><a href="#给定一个二维数组，判断能否拼成相应的字符串" class="headerlink" title="给定一个二维数组，判断能否拼成相应的字符串"></a>给定一个二维数组，判断能否拼成相应的字符串</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class WorldSearch_79 &#123;</div><div class="line">    public boolean exist(char[][] board, String word) &#123;</div><div class="line">        boolean[][] flag = new boolean[board.length][board[0].length];</div><div class="line">        for (int i = 0; i &lt; board.length; i++) &#123;</div><div class="line">            for (int j = 0; j &lt; board[0].length; j++)</div><div class="line">                if (seachWord(board, word, 0, i, j, flag))</div><div class="line">                    return true;</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private boolean seachWord(char[][] board, String word, int index, int x, int y, boolean[][] flag) &#123;</div><div class="line">        if (index == word.length() - 1)</div><div class="line">            return board[x][y] == word.charAt(index);</div><div class="line">        if (board[x][y] == word.charAt(index)) &#123;</div><div class="line">            flag[x][y] = true;</div><div class="line">            if (x - 1 &gt;= 0 &amp;&amp; !flag[x-1][y] &amp;&amp; seachWord(board, word, index+1,x-1, y, flag))</div><div class="line">                return true;</div><div class="line">            if (x + 1 &lt; board.length &amp;&amp; !flag[x+1][y] &amp;&amp; seachWord(board, word, index + 1, x + 1, y, flag))</div><div class="line">                return true;</div><div class="line">            if (y-1 &gt;= 0 &amp;&amp; !flag[x][y-1] &amp;&amp; seachWord(board, word, index + 1, x, y-1, flag))</div><div class="line">                return true;</div><div class="line">            if (y + 1 &lt;board[0].length &amp;&amp; !flag[x][y+1] &amp;&amp; seachWord(board, word, index + 1, x, y+1, flag))</div><div class="line">                return true;</div><div class="line">            flag[x][y] = false;</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="二进制表的问题"><a href="#二进制表的问题" class="headerlink" title="二进制表的问题"></a>二进制表的问题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">package leetcode.backtracking;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/10</div><div class="line"> */</div><div class="line">public class BinaryWatch_401 &#123;</div><div class="line">    public List&lt;String&gt; readBinaryWatch(int num) &#123;</div><div class="line">        List&lt;String&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        int[] nums1 = new int[]&#123;8,4,2,1&#125;;</div><div class="line">        int[] nums2 = new int[]&#123;32,16,8,4,2,1&#125;;</div><div class="line">        for (int i = 0; i &lt;= num; i++) &#123;</div><div class="line">            List&lt;Integer&gt; list1 = generateDigit(nums1, i);</div><div class="line">            List&lt;Integer&gt; list2 = generateDigit(nums2, num - i);</div><div class="line">            for (int num1 : list1) &#123;</div><div class="line">                if (num1 &gt;= 12)</div><div class="line">                    continue;</div><div class="line">                for (int num2 : list2) &#123;</div><div class="line">                    if (num2 &gt;= 60)</div><div class="line">                        continue;</div><div class="line">                    res.add(num1 + &quot;:&quot;+ (num2 &lt; 10 ? &quot;0&quot; + num2 : num2));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return  res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private List&lt;Integer&gt; generateDigit(int[] nums, int count) &#123;</div><div class="line">        List&lt;Integer&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        generateDigit(nums, count, 0, 0, res);</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void generateDigit(int[] nums, int count, int pos, int sum, List&lt;Integer&gt; res) &#123;</div><div class="line">        if (count == 0) &#123;</div><div class="line">            res.add(sum);</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        for (int i = pos; i &lt; nums.length; i++) &#123;</div><div class="line">            generateDigit(nums, count - 1, i + 1, sum + nums[i], res);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/算法之BFS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/算法之BFS/" itemprop="url">算法-BFS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T17:43:57+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/algorithms/" itemprop="url" rel="index">
                    <span itemprop="name">algorithms</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="完美平方数"><a href="#完美平方数" class="headerlink" title="完美平方数"></a>完美平方数</h1><p>DP解法和图论解法，掌握DP的为准，参考图论解法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">package leetcode.BFSGraphic;</div><div class="line"></div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.Queue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class PerfectSquares_279 &#123;</div><div class="line">    public int numSquares(int n) &#123;</div><div class="line">        Queue&lt;Pair&gt; queue = new LinkedList&lt;&gt;();</div><div class="line">        queue.offer(new Pair(n, 0));</div><div class="line">        boolean[] visited = new boolean[n+1];</div><div class="line">        visited[n] = true;</div><div class="line">        while (!queue.isEmpty()) &#123;</div><div class="line">            Pair pair = queue.poll();</div><div class="line">            int num = pair.num;</div><div class="line">            int step = pair.step;</div><div class="line">            if (num == 0)</div><div class="line">                return step;</div><div class="line">            for (int i = 1; num - i * i &gt;= 0; i++) &#123;</div><div class="line">                if (!visited[num-i*i]) &#123;</div><div class="line">                    queue.offer(new Pair(num - i * i, step + 1));</div><div class="line">                    visited[num - i * i] = true;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return n;</div><div class="line">    &#125;</div><div class="line">    /**</div><div class="line">     * num:当前数</div><div class="line">     * step:n到num需要的步数</div><div class="line">     */</div><div class="line">    class Pair &#123;</div><div class="line">        int num;</div><div class="line">        int step;</div><div class="line">        public Pair(int num, int step) &#123;</div><div class="line">            this.num = num;</div><div class="line">            this.step = step;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="WordLadder"><a href="#WordLadder" class="headerlink" title="WordLadder"></a>WordLadder</h1><p>注释很清楚了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package leetcode.BFSGraphic;</div><div class="line"></div><div class="line">import java.util.*;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class WordLadder_127 &#123;</div><div class="line">    /*</div><div class="line">        beginSet开始存放beginword，然后将经过一次变更字母之后可以编程的wordList中的字符串</div><div class="line">        放入beginSet，直到出现变换成最终的字符串。</div><div class="line">     */</div><div class="line">    public int ladderLength(String beginWord, String endWord, List&lt;String&gt; wordList) &#123;</div><div class="line">        Set&lt;String&gt; dict = new HashSet&lt;&gt;(wordList), qs = new HashSet&lt;&gt;(), qe = new HashSet&lt;&gt;(), vis = new HashSet&lt;&gt;();</div><div class="line">        qs.add(beginWord);</div><div class="line">        if (dict.contains(endWord))</div><div class="line">            qe.add(endWord); // all transformed words must be in dict (including endWord)</div><div class="line">        for (int len = 2; !qs.isEmpty(); len++) &#123;</div><div class="line">            Set&lt;String&gt; nq = new HashSet&lt;&gt;();</div><div class="line">            for (String w : qs) &#123;</div><div class="line">                for (int j = 0; j &lt; w.length(); j++) &#123;</div><div class="line">                    char[] ch = w.toCharArray();</div><div class="line">                    for (char c = &apos;a&apos;; c &lt;= &apos;z&apos;; c++) &#123;</div><div class="line">                        if (c == w.charAt(j))</div><div class="line">                            continue; // beginWord and endWord not the same, so bypass itself</div><div class="line">                        ch[j] = c;</div><div class="line">                        String nb = String.valueOf(ch);</div><div class="line">                        if (qe.contains(nb))</div><div class="line">                            return len; // meet from two ends</div><div class="line">                        if (dict.contains(nb) &amp;&amp; vis.add(nb))</div><div class="line">                            nq.add(nb); // not meet yet, vis is safe to use</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            qs = (nq.size() &lt; qe.size()) ? nq : qe; // switch to small one to traverse from other end</div><div class="line">            qe = (qs == nq) ? qe : nq;</div><div class="line">        &#125;</div><div class="line">        return 0;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/算法之队列/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/算法之队列/" itemprop="url">算法-队列</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T17:22:07+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/algorithms/" itemprop="url" rel="index">
                    <span itemprop="name">algorithms</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="树的层序遍历问题"><a href="#树的层序遍历问题" class="headerlink" title="树的层序遍历问题"></a>树的层序遍历问题</h1><h2 id="从上到下"><a href="#从上到下" class="headerlink" title="从上到下"></a>从上到下</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">package leetcode.queue;</div><div class="line"></div><div class="line">import leetcode.stack.TreeNode;</div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Queue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class BinaryTreeLevelOrderTraversal_102 &#123;</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        if (root == null)</div><div class="line">            return res;</div><div class="line">        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();</div><div class="line">        queue.offer(root);</div><div class="line">        while (!queue.isEmpty()) &#123;</div><div class="line">            int size = queue.size();</div><div class="line">            List&lt;Integer&gt; list = new ArrayList&lt;&gt;();</div><div class="line">            for (int i = 0; i &lt; size; i++) &#123;</div><div class="line">                TreeNode node = queue.poll();</div><div class="line">                list.add(node.val);</div><div class="line">                if (node.left != null)</div><div class="line">                    queue.offer(node.left);</div><div class="line">                if (node.right != null)</div><div class="line">                    queue.offer(node.right);</div><div class="line">            &#125;</div><div class="line">            res.add(list);</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="从下到上"><a href="#从下到上" class="headerlink" title="从下到上"></a>从下到上</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">package leetcode.queue;</div><div class="line"></div><div class="line">import leetcode.stack.TreeNode;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Queue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class BinaryTreeLevelOrderTraversalII_107 &#123;</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; levelOrderBottom(TreeNode root) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        if (root == null)</div><div class="line">            return res;</div><div class="line">        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();</div><div class="line">        queue.offer(root);</div><div class="line">        while (!queue.isEmpty()) &#123;</div><div class="line">            int size = queue.size();</div><div class="line">            List&lt;Integer&gt; list = new ArrayList&lt;&gt;();</div><div class="line">            for (int i = 0; i &lt; size; i++) &#123;</div><div class="line">                TreeNode node = queue.poll();</div><div class="line">                list.add(node.val);</div><div class="line">                if (node.left != null)</div><div class="line">                    queue.offer(node.left);</div><div class="line">                if (node.right != null)</div><div class="line">                    queue.offer(node.right);</div><div class="line">            &#125;</div><div class="line">            res.add(0, list);</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="之字形层序遍历"><a href="#之字形层序遍历" class="headerlink" title="之字形层序遍历"></a>之字形层序遍历</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package leetcode.queue;</div><div class="line"></div><div class="line">import leetcode.stack.TreeNode;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Queue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class BinaryTreeZigzagLevelOrderTraversal_103 &#123;</div><div class="line">    public List&lt;List&lt;Integer&gt;&gt; zigzagLevelOrder(TreeNode root) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        if (root == null)</div><div class="line">            return res;</div><div class="line">        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();</div><div class="line">        queue.offer(root);</div><div class="line">        int flag = 1;</div><div class="line">        while (!queue.isEmpty()) &#123;</div><div class="line">            int size = queue.size();</div><div class="line">            List&lt;Integer&gt; list = new ArrayList&lt;&gt;();</div><div class="line">            for (int i = 0; i &lt; size; i++) &#123;</div><div class="line">                TreeNode node = queue.poll();</div><div class="line">                if (flag % 2 == 1)</div><div class="line">                    list.add(node.val);</div><div class="line">                else</div><div class="line">                    list.add(0, node.val);</div><div class="line">                if (node.left != null)</div><div class="line">                    queue.offer(node.left);</div><div class="line">                if (node.right != null)</div><div class="line">                    queue.offer(node.right);</div><div class="line">            &#125;</div><div class="line">            res.add(list);</div><div class="line">            flag++;</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="从一颗树右侧看过去的节点数"><a href="#从一颗树右侧看过去的节点数" class="headerlink" title="从一颗树右侧看过去的节点数"></a>从一颗树右侧看过去的节点数</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">package leetcode.queue;</div><div class="line"></div><div class="line">import leetcode.stack.TreeNode;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.LinkedList;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Queue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class BinaryTreeRightSideView_199 &#123;</div><div class="line">    public List&lt;Integer&gt; rightSideView(TreeNode root) &#123;</div><div class="line">        List&lt;Integer&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        if (root == null)</div><div class="line">            return res;</div><div class="line">        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();</div><div class="line">        queue.offer(root);</div><div class="line">        while (!queue.isEmpty()) &#123;</div><div class="line">            int size = queue.size();</div><div class="line">            for (int i = 0; i &lt; size; i++) &#123;</div><div class="line">                TreeNode node = queue.poll();</div><div class="line">                if (i == size - 1)</div><div class="line">                    res.add(node.val);</div><div class="line">                if (node.left != null)</div><div class="line">                    queue.offer(node.left);</div><div class="line">                if (node.right != null)</div><div class="line">                    queue.offer(node.right);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="合并k个排序链表-用优先队列，重写compare方法"><a href="#合并k个排序链表-用优先队列，重写compare方法" class="headerlink" title="合并k个排序链表, 用优先队列，重写compare方法"></a>合并k个排序链表, 用优先队列，重写compare方法</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">package leetcode.queue;</div><div class="line"></div><div class="line">import leetcode.linkedList.ListNode;</div><div class="line"></div><div class="line">import java.util.Comparator;</div><div class="line">import java.util.List;</div><div class="line">import java.util.PriorityQueue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class MergeKSortedLists_23 &#123;</div><div class="line">    public ListNode mergeKLists(ListNode[] lists) &#123;</div><div class="line">        if (lists == null || lists.length == 0)</div><div class="line">            return null;</div><div class="line">        PriorityQueue&lt;ListNode&gt; queue = new PriorityQueue&lt;&gt;(lists.length, new Comparator&lt;ListNode&gt;() &#123;</div><div class="line">            @Override</div><div class="line">            public int compare(ListNode o1, ListNode o2) &#123;</div><div class="line">                return o1.val - o2.val;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        ListNode p = dummy;</div><div class="line">        for (ListNode node : lists) &#123;</div><div class="line">            if (node != null)</div><div class="line">                queue.add(node);</div><div class="line">        &#125;</div><div class="line">        while (!queue.isEmpty()) &#123;</div><div class="line">            p.next = queue.poll();</div><div class="line">            p = p.next;</div><div class="line">            if (p.next != null)</div><div class="line">                queue.add(p.next);</div><div class="line">        &#125;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="找到数组中出现频率最高的k个数"><a href="#找到数组中出现频率最高的k个数" class="headerlink" title="找到数组中出现频率最高的k个数"></a>找到数组中出现频率最高的k个数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">package leetcode.queue;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.List;</div><div class="line">import java.util.PriorityQueue;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/8</div><div class="line"> */</div><div class="line">public class TopKFrequentElements_347 &#123;</div><div class="line">    public List&lt;Integer&gt; topKFrequent(int[] nums, int k) &#123;</div><div class="line">        List&lt;Integer&gt; res = new ArrayList&lt;&gt;();</div><div class="line">        //统计数组中的元素出现的频率，key-num, value-次数</div><div class="line">        HashMap&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();</div><div class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class="line">            if (map.containsKey(nums[i])) &#123;</div><div class="line">                map.put(nums[i], map.get(nums[i])+1);</div><div class="line">            &#125; else &#123;</div><div class="line">                map.put(nums[i],1);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        //扫描map，维护当前频率最高的k个元素,</div><div class="line">        PriorityQueue&lt;Pair&gt; queue = new PriorityQueue&lt;&gt;(k);</div><div class="line">        for (Integer i : map.keySet()) &#123;</div><div class="line">            if (queue.size() == k) &#123;</div><div class="line">                if (map.get(i) &gt; queue.peek().freq)&#123;</div><div class="line">                    queue.poll();</div><div class="line">                    queue.add(new Pair(map.get(i),i));</div><div class="line">                &#125;</div><div class="line">            &#125; else &#123;</div><div class="line">                queue.add(new Pair(map.get(i), i));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        //遍历优先队列，将num加入到结果集中</div><div class="line">        for (Pair pair : queue) &#123;</div><div class="line">            res.add(0, pair.num);</div><div class="line">        &#125;</div><div class="line">        return res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    class Pair implements Comparable&lt;Pair&gt;&#123;</div><div class="line">        int freq;</div><div class="line">        int num;</div><div class="line">        public Pair(int freq, int num) &#123;</div><div class="line">            this.freq = freq;</div><div class="line">            this.num = num;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public int compareTo(Pair o) &#123;</div><div class="line">            return this.freq - o.freq;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/15/算法之链表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cdx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小黄">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/算法之链表/" itemprop="url">算法-链表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-15T16:12:13+08:00">
                2018-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/algorithms/" itemprop="url" rel="index">
                    <span itemprop="name">algorithms</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="链表和问题"><a href="#链表和问题" class="headerlink" title="链表和问题"></a>链表和问题</h1><h2 id="两个非空链表表示两个数，数字倒叙排列，比如-2-gt-4-gt-3-5-gt-6-gt-4-表示-342-465-807-，-最后输出应该为7-gt-0-gt-8。"><a href="#两个非空链表表示两个数，数字倒叙排列，比如-2-gt-4-gt-3-5-gt-6-gt-4-表示-342-465-807-，-最后输出应该为7-gt-0-gt-8。" class="headerlink" title="两个非空链表表示两个数，数字倒叙排列，比如 (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4) 表示 342 + 465 = 807.， 最后输出应该为7 -&gt; 0 -&gt; 8。"></a>两个非空链表表示两个数，数字倒叙排列，比如 (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4) 表示 342 + 465 = 807.， 最后输出应该为7 -&gt; 0 -&gt; 8。</h2><p>注意进位问题就好了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class AddTwoNumber_2 &#123;</div><div class="line">    public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123;</div><div class="line">        ListNode h1 = l1, h2 = l2;</div><div class="line">        ListNode result = new ListNode(0);</div><div class="line">        ListNode cur;</div><div class="line">        int c = 0;</div><div class="line">        cur = result;</div><div class="line">        while (h1 != null || h2 != null || c == 1) &#123;</div><div class="line">            int tmp;</div><div class="line">            if (h1 == null &amp;&amp; h2 == null) &#123;</div><div class="line">                tmp = c;</div><div class="line">            &#125; else if (h1 == null) &#123;</div><div class="line">                tmp = c + h2.val;</div><div class="line">            &#125; else if (h2 == null) &#123;</div><div class="line">                tmp = c + h1.val;</div><div class="line">            &#125; else &#123;</div><div class="line">                tmp = c + h1.val + h2.val;</div><div class="line">            &#125;</div><div class="line">            cur.next = new ListNode(tmp % 10);</div><div class="line">            c = tmp / 10;</div><div class="line">            cur = cur.next;</div><div class="line">            if (h1 != null)</div><div class="line">                h1 = h1.next;</div><div class="line">            if (h2 != null)</div><div class="line">                h2 = h2.next;</div><div class="line">        &#125;</div><div class="line">        return result.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="和上题类似，只是数字存储为顺序存储，解决方法为引入栈和dummy头节点。"><a href="#和上题类似，只是数字存储为顺序存储，解决方法为引入栈和dummy头节点。" class="headerlink" title="和上题类似，只是数字存储为顺序存储，解决方法为引入栈和dummy头节点。"></a>和上题类似，只是数字存储为顺序存储，解决方法为引入栈和dummy头节点。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">import java.util.Stack;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class AddTwoNumbersII_445 &#123;</div><div class="line">    public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123;</div><div class="line">        Stack&lt;Integer&gt; stack1 = new Stack&lt;&gt;();</div><div class="line">        Stack&lt;Integer&gt; stack2 = new Stack&lt;&gt;();</div><div class="line">        ListNode cur1 = l1, cur2 = l2;</div><div class="line">        while (cur1 != null) &#123;</div><div class="line">            stack1.push(cur1.val);</div><div class="line">            cur1 = cur1.next;</div><div class="line">        &#125;</div><div class="line">        while (cur2 != null) &#123;</div><div class="line">            stack2.push(cur2.val);</div><div class="line">            cur2 = cur2.next;</div><div class="line">        &#125;</div><div class="line">        int c = 0;</div><div class="line">        ListNode result = new ListNode(0);</div><div class="line">        while (!stack1.isEmpty() || !stack2.isEmpty() || c == 1) &#123;</div><div class="line">            int tmp = 0;</div><div class="line">            if (stack1.isEmpty() &amp;&amp; stack2.isEmpty())</div><div class="line">                tmp = c;</div><div class="line">            else if (stack1.isEmpty())</div><div class="line">                tmp = c + stack2.pop();</div><div class="line">            else if (stack2.isEmpty())</div><div class="line">                tmp = c + stack1.pop();</div><div class="line">            else</div><div class="line">                tmp = stack1.pop() + stack2.pop() + c;</div><div class="line">            ListNode node = new ListNode(tmp % 10);</div><div class="line">            c = tmp / 10;</div><div class="line">            node.next = result.next;</div><div class="line">            result.next = node;</div><div class="line">        &#125;</div><div class="line">        return result.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="删除链表中的节点"><a href="#删除链表中的节点" class="headerlink" title="删除链表中的节点"></a>删除链表中的节点</h1><p>由于给出的是要删除的节点，无法获取其上一个节点，因此将其下一个节点的值复制过来，删除其下一个节点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class DeleteNodeInALinkedList_237 &#123;</div><div class="line">    public void deleteNode(ListNode node) &#123;</div><div class="line">        if (node == null)</div><div class="line">            return;</div><div class="line">        if (node.next == null) &#123;</div><div class="line">            node = null;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        node.val = node.next.val;</div><div class="line">        node.next = node.next.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="链表中删除一个节点"><a href="#链表中删除一个节点" class="headerlink" title="链表中删除一个节点"></a>链表中删除一个节点</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class RemoveLinkedListElement_203 &#123;</div><div class="line">    public ListNode removeElements(ListNode head, int val) &#123;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode cur = head, pre = dummy;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            if (cur.val == val) &#123;</div><div class="line">                pre.next = cur.next;</div><div class="line">            &#125; else &#123;</div><div class="line">                pre = pre.next;</div><div class="line">            &#125;</div><div class="line">            cur = cur.next;</div><div class="line">        &#125;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="删除链表中离end第N的节点"><a href="#删除链表中离end第N的节点" class="headerlink" title="删除链表中离end第N的节点"></a>删除链表中离end第N的节点</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class RemoveNthNodeFromEndOfList_19 &#123;</div><div class="line">    public ListNode removeNthFromEnd(ListNode head, int n) &#123;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode l = dummy;</div><div class="line">        ListNode r =dummy;</div><div class="line">        for (int i = 0; i &lt; n + 1; i++) &#123;</div><div class="line">            r = r.next;</div><div class="line">        &#125;</div><div class="line">        while (r != null) &#123;</div><div class="line">            l = l. next;</div><div class="line">            r = r.next;</div><div class="line">        &#125;</div><div class="line">        l.next = l.next.next;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="链表排序问题"><a href="#链表排序问题" class="headerlink" title="链表排序问题"></a>链表排序问题</h1><h2 id="对一个链表进行插入排序"><a href="#对一个链表进行插入排序" class="headerlink" title="对一个链表进行插入排序"></a>对一个链表进行插入排序</h2><p>设置dummy头节点，然后找到当前节点需要插入的位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class InsertionSortList_147 &#123;</div><div class="line">    public ListNode insertionSortList(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode pre = dummy;</div><div class="line">        ListNode cur = head;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            if (cur.next != null &amp;&amp; cur.next.val &lt; cur.val) &#123;</div><div class="line">                while (pre.next.val &lt; cur.next.val)</div><div class="line">                    pre = pre.next;</div><div class="line">                ListNode tmp = cur.next;</div><div class="line">                cur.next = cur.next.next;</div><div class="line">                tmp.next = pre.next;</div><div class="line">                pre.next = tmp;</div><div class="line">                pre = dummy;</div><div class="line">            &#125;  else &#123;</div><div class="line">                cur = cur.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="合并两个有序链表"><a href="#合并两个有序链表" class="headerlink" title="合并两个有序链表"></a>合并两个有序链表</h2><p>百度二面遇到了,这个解法是设置dummy头节点，当时自己选择的是递归方法，比较好想。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class MergeTwoSortedLists_21 &#123;</div><div class="line">    public ListNode mergeTwoLists(ListNode l1, ListNode l2) &#123;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        ListNode node1 = l1;</div><div class="line">        ListNode node2 = l2;</div><div class="line">        ListNode curr = dummy;</div><div class="line">        while (node1 != null || node2 != null) &#123;</div><div class="line">            if (node1 == null) &#123;</div><div class="line">                curr.next = node2;</div><div class="line">                break;</div><div class="line">            &#125; else if (node2 == null) &#123;</div><div class="line">                curr.next = node1;</div><div class="line">                break;</div><div class="line">            &#125; else &#123;</div><div class="line">                if (node1.val &lt;= node2.val) &#123;</div><div class="line">                    curr.next = node1;</div><div class="line">                    node1 = node1.next;</div><div class="line">                &#125; else &#123;</div><div class="line">                    curr.next = node2;</div><div class="line">                    node2 = node2.next;</div><div class="line">                &#125;</div><div class="line">                curr = curr.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h2><p>快慢指针将链表分为两部分，对两部分进行继续拆分，然后返回其合并结果。复杂度为O(NlogN)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class SortList_148 &#123;</div><div class="line">    public ListNode sortList(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode fast = head, slow = head;</div><div class="line">        ListNode prev = null, left, right;</div><div class="line">        while (fast != null &amp;&amp; fast.next != null) &#123;</div><div class="line">            prev = slow;</div><div class="line">            slow = slow.next;</div><div class="line">            fast = fast.next.next;</div><div class="line">        &#125;</div><div class="line">        prev.next = null;</div><div class="line">        left = sortList(head);</div><div class="line">        right = sortList(slow);</div><div class="line">        return mergeTwoList(left, right);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ListNode mergeTwoList(ListNode l1, ListNode l2) &#123;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        ListNode prev = dummy;</div><div class="line">        while (l1 != null &amp;&amp; l2 != null) &#123;</div><div class="line">            if (l1.val &lt;= l2.val) &#123;</div><div class="line">                prev.next = l1;</div><div class="line">                l1 = l1.next;</div><div class="line">            &#125; else &#123;</div><div class="line">                prev.next = l2;</div><div class="line">                l2 = l2.next;</div><div class="line">            &#125;</div><div class="line">            prev = prev.next;</div><div class="line">        &#125;</div><div class="line">        if (l1 != null)</div><div class="line">            prev.next = l1;</div><div class="line">        if (l2 != null)</div><div class="line">            prev.next = l2;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="链表调整问题"><a href="#链表调整问题" class="headerlink" title="链表调整问题"></a>链表调整问题</h1><h2 id="奇数前偶数后的问题"><a href="#奇数前偶数后的问题" class="headerlink" title="奇数前偶数后的问题"></a>奇数前偶数后的问题</h2><p>创建两个dummy节点，最后两个连接起来就可以了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class OddEvenLinkedList_328 &#123;</div><div class="line">    public ListNode oddEvenList(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode odd = new ListNode(0);</div><div class="line">        ListNode even = new ListNode(0);</div><div class="line">        ListNode lastOdd = odd;</div><div class="line">        ListNode lastEven = even;</div><div class="line">        ListNode cur = head;</div><div class="line">        int i = 1;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            if (i % 2 == 0) &#123;</div><div class="line">                lastEven.next = cur;</div><div class="line">                lastEven = lastEven.next;</div><div class="line">            &#125; else &#123;</div><div class="line">                lastOdd.next = cur;</div><div class="line">                lastOdd = lastOdd.next;</div><div class="line">            &#125;</div><div class="line">            cur = cur.next;</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">        lastEven.next = null;</div><div class="line">        lastOdd.next = even.next;</div><div class="line">        return odd.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="partion问题-将链表中小于target值的节点放在前面。解决思路还是两个dummy节点。"><a href="#partion问题-将链表中小于target值的节点放在前面。解决思路还是两个dummy节点。" class="headerlink" title="partion问题,将链表中小于target值的节点放在前面。解决思路还是两个dummy节点。"></a>partion问题,将链表中小于target值的节点放在前面。解决思路还是两个dummy节点。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class PartitionList_86 &#123;</div><div class="line">    public ListNode partition(ListNode head, int x) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode smaller = new ListNode(0);</div><div class="line">        ListNode bigger = new ListNode(0);</div><div class="line">        ListNode lastSmall = smaller;</div><div class="line">        ListNode lastbig = bigger;</div><div class="line">        ListNode cur = head;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            if (cur.val &lt; x)&#123;</div><div class="line">                lastSmall.next = cur;</div><div class="line">                lastSmall = lastSmall.next;</div><div class="line">            &#125;</div><div class="line">            if (cur.val &gt;= x) &#123;</div><div class="line">                lastbig.next = cur;</div><div class="line">                lastbig = lastbig.next;</div><div class="line">            &#125;</div><div class="line">            cur = cur.next;</div><div class="line">        &#125;</div><div class="line">        lastbig.next = null;</div><div class="line">        lastSmall.next = bigger.next;</div><div class="line">        return smaller.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="将链表-L-L0→L1→…→Ln-1→Ln-变为-L0→Ln→L1→Ln-1→L2→Ln-2→…解决思路，快慢指针加上链表反转。"><a href="#将链表-L-L0→L1→…→Ln-1→Ln-变为-L0→Ln→L1→Ln-1→L2→Ln-2→…解决思路，快慢指针加上链表反转。" class="headerlink" title="将链表 L: L0→L1→…→Ln-1→Ln 变为 L0→Ln→L1→Ln-1→L2→Ln-2→…解决思路，快慢指针加上链表反转。"></a>将链表 L: L0→L1→…→Ln-1→Ln 变为 L0→Ln→L1→Ln-1→L2→Ln-2→…解决思路，快慢指针加上链表反转。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class RecordList_143 &#123;</div><div class="line">    public void reorderList(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return;</div><div class="line">        ListNode slow = head, fast = head;</div><div class="line">        while (fast.next != null &amp;&amp; fast.next.next != null) &#123;</div><div class="line">            slow = slow.next;</div><div class="line">            fast = fast.next.next;</div><div class="line">        &#125;</div><div class="line">        slow.next = reverseList(slow.next);</div><div class="line">        fast = slow.next;</div><div class="line">        ListNode node = head;</div><div class="line">        while (node != slow) &#123;</div><div class="line">            slow.next = fast.next;</div><div class="line">            fast.next = node.next;</div><div class="line">            node.next = fast;</div><div class="line">            node = fast.next;</div><div class="line">            fast = slow.next;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private ListNode reverseList(ListNode head) &#123;</div><div class="line">        if (head == null)</div><div class="line">            return head;</div><div class="line">        ListNode p = head.next;</div><div class="line">        head.next = null;</div><div class="line">        while (p != null) &#123;</div><div class="line">            ListNode tmp = p;</div><div class="line">            p = p.next;</div><div class="line">            tmp.next = head;</div><div class="line">            head = tmp;</div><div class="line">        &#125;</div><div class="line">        return head;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="排序链表中删除重复节点，要求保留一个"><a href="#排序链表中删除重复节点，要求保留一个" class="headerlink" title="排序链表中删除重复节点，要求保留一个"></a>排序链表中删除重复节点，要求保留一个</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class RemoveDuplicatesFromSortedList &#123;</div><div class="line">    public ListNode deleteDuplicates(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode pre = head;</div><div class="line">        ListNode cur = head.next;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            if (cur.val == pre.val)</div><div class="line">                pre.next = cur.next;</div><div class="line">            else &#123;</div><div class="line">                pre.next = cur;</div><div class="line">                pre = pre.next;</div><div class="line">            &#125;</div><div class="line">            cur = cur.next;</div><div class="line">        &#125;</div><div class="line">        return head;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="排序链表中删除重复节点，要求删除所有重复的"><a href="#排序链表中删除重复节点，要求删除所有重复的" class="headerlink" title="排序链表中删除重复节点，要求删除所有重复的"></a>排序链表中删除重复节点，要求删除所有重复的</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class RemoveDuplicatesFromSortedListII_82 &#123;</div><div class="line">    public ListNode deleteDuplicates(ListNode head) &#123;</div><div class="line">        if(head == null) return head;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode pre = dummy, cur = head;</div><div class="line"></div><div class="line">        boolean repeat = false;</div><div class="line">        while(cur.next != null)&#123;</div><div class="line">            if(cur.val == cur.next.val)&#123;</div><div class="line">                repeat = true;</div><div class="line">                cur = cur.next;</div><div class="line">            &#125; else &#123;</div><div class="line">                cur = cur.next;</div><div class="line">                if(!repeat)&#123;</div><div class="line">                    pre = pre.next;</div><div class="line">                &#125;</div><div class="line">                pre.next = cur;</div><div class="line">                repeat = false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(repeat) pre.next = null;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="反转一个链表"><a href="#反转一个链表" class="headerlink" title="反转一个链表"></a>反转一个链表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">import java.util.List;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class ReverseLinkedList_206 &#123;</div><div class="line">    public ListNode reverseList(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode pre = null;</div><div class="line">        ListNode cur = head;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            ListNode next = cur.next;</div><div class="line">            cur.next = pre;</div><div class="line">            pre = cur;</div><div class="line">            cur = next;</div><div class="line">        &#125;</div><div class="line">        return pre;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 创建一个链表</div><div class="line">     * @param arr</div><div class="line">     * @param n</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    public static ListNode createLinkedList(int arr[], int n) &#123;</div><div class="line">        if (n == 0)</div><div class="line">            return null;</div><div class="line">        ListNode head = new ListNode(arr[0]);</div><div class="line">        ListNode curNode = head;</div><div class="line">        for (int i = 1; i &lt; n; i++) &#123;</div><div class="line">            curNode.next = new ListNode(arr[i]);</div><div class="line">            curNode = curNode.next;</div><div class="line">        &#125;</div><div class="line">        return head;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void printLinkedList(ListNode head) &#123;</div><div class="line">        ListNode cur = head;</div><div class="line">        while (cur != null) &#123;</div><div class="line">            System.out.print(cur.val + &quot; -&gt; &quot;);</div><div class="line">            cur = cur.next;</div><div class="line">        &#125;</div><div class="line">        System.out.println(&quot;NULL&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        int arr[] = &#123;1, 2, 3, 4, 5&#125;;</div><div class="line">        int n = arr.length;</div><div class="line">        ListNode head = createLinkedList(arr, n);</div><div class="line">        printLinkedList(head);</div><div class="line">        head = new ReverseLinkedList_206().reverseList(head);</div><div class="line">        printLinkedList(head);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="反转指定位置的链表-解决思路，添加dummy节点，找到位置即可。"><a href="#反转指定位置的链表-解决思路，添加dummy节点，找到位置即可。" class="headerlink" title="反转指定位置的链表,解决思路，添加dummy节点，找到位置即可。"></a>反转指定位置的链表,解决思路，添加dummy节点，找到位置即可。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class ReverseLinkedListII_92 &#123;</div><div class="line">    public ListNode reverseBetween(ListNode head, int m, int n) &#123;</div><div class="line">        if (head == null)</div><div class="line">            return null;</div><div class="line">        ListNode newHead = new ListNode(0);</div><div class="line">        newHead.next = head;</div><div class="line">        ListNode pre= newHead;</div><div class="line">        for (int i = 0; i &lt; m-1; i++) &#123;</div><div class="line">            pre = pre.next;</div><div class="line">        &#125;</div><div class="line">        ListNode cur = pre.next;</div><div class="line">        ListNode next = cur.next;</div><div class="line">        for (int j = 0; j &lt; n-m; j++) &#123;</div><div class="line">           cur.next = next.next;</div><div class="line">           next.next = pre.next;</div><div class="line">           pre.next = next;</div><div class="line">           next = cur.next;</div><div class="line">        &#125;</div><div class="line">        return newHead.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="以K个为一组来反转链表-添加dummy节点，K个节点处理一次，不足k个不处理"><a href="#以K个为一组来反转链表-添加dummy节点，K个节点处理一次，不足k个不处理" class="headerlink" title="以K个为一组来反转链表,添加dummy节点，K个节点处理一次，不足k个不处理"></a>以K个为一组来反转链表,添加dummy节点，K个节点处理一次，不足k个不处理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class ReverseNodesInKGroup_25 &#123;</div><div class="line">    public ListNode reverseKGroup(ListNode head, int k) &#123;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        ListNode start = dummy;</div><div class="line">        dummy.next = head;</div><div class="line">        while (true) &#123;</div><div class="line">            ListNode node = start, cur, n = node;</div><div class="line">            start = node.next;</div><div class="line">            for (int i = 0; i &lt; k &amp;&amp; n != null; i++)</div><div class="line">                n = n.next;</div><div class="line">            if (n == null)</div><div class="line">                break;</div><div class="line">            for (int i = 0; i &lt; k - 1; i++) &#123;</div><div class="line">                cur = node.next;</div><div class="line">                node.next = cur.next;</div><div class="line">                cur.next = n.next;</div><div class="line">                n.next = cur;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="链表旋转问题"><a href="#链表旋转问题" class="headerlink" title="链表旋转问题"></a>链表旋转问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class RotateLIst_61 &#123;</div><div class="line">    public ListNode rotateRight(ListNode head, int k) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return head;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode left = dummy, right = dummy, br = dummy;</div><div class="line">        int length = 0;</div><div class="line">        while (right.next != null) &#123;</div><div class="line">            length++;</div><div class="line">            right = right.next;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        for (int j = length - k%length; j&gt; 0; j--)</div><div class="line">            left = left.next;</div><div class="line"></div><div class="line">        right.next = dummy.next;</div><div class="line">        dummy.next = left.next;</div><div class="line">        left.next = null;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="成对交换节点-添加dummy节点，"><a href="#成对交换节点-添加dummy节点，" class="headerlink" title="成对交换节点, 添加dummy节点，"></a>成对交换节点, 添加dummy节点，</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class SwapNodewsInPairs_24 &#123;</div><div class="line">    public ListNode swapPairs(ListNode head) &#123;</div><div class="line">        ListNode dummy = new ListNode(0);</div><div class="line">        dummy.next = head;</div><div class="line">        ListNode pre = dummy;</div><div class="line">        ListNode node1, node2, next;</div><div class="line">        while (pre.next != null &amp;&amp; pre.next.next != null) &#123;</div><div class="line">            node1 = pre.next;</div><div class="line">            node2 = node1.next;</div><div class="line">            next = node2.next;</div><div class="line">            node2.next = node1;</div><div class="line">            node1.next = next;</div><div class="line">            pre.next = node2;</div><div class="line">            //靠后的一对节点</div><div class="line">            pre = node1;</div><div class="line">        &#125;</div><div class="line">        return dummy.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="链表是否为回文链表"><a href="#链表是否为回文链表" class="headerlink" title="链表是否为回文链表"></a>链表是否为回文链表</h1><p>快慢指针定位，反转后半部分，然后逐一对比。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">package leetcode.linkedList;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by cdx0312</div><div class="line"> * 2018/4/7</div><div class="line"> */</div><div class="line">public class PalindromeLinkedList_234 &#123;</div><div class="line">    public boolean isPalindrome(ListNode head) &#123;</div><div class="line">        if (head == null || head.next == null)</div><div class="line">            return true;</div><div class="line">        ListNode slow = head, fast = head;</div><div class="line">        while (fast.next != null &amp;&amp; fast.next.next != null) &#123;</div><div class="line">            slow = slow.next;</div><div class="line">            fast = fast.next.next;</div><div class="line">        &#125;</div><div class="line">        slow.next = reverseList(slow.next);</div><div class="line">        fast = slow.next;</div><div class="line">        ListNode node = head;</div><div class="line">        while (fast != null) &#123;</div><div class="line">            if (node.val != fast.val)</div><div class="line">                return false;</div><div class="line">            node = node.next;</div><div class="line">            fast = fast.next;</div><div class="line">        &#125;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private ListNode reverseList(ListNode head) &#123;</div><div class="line">        if (head == null)</div><div class="line">            return head;</div><div class="line">        ListNode p = head.next;</div><div class="line">        head.next = null;</div><div class="line">        while (p != null) &#123;</div><div class="line">            ListNode tmp = p;</div><div class="line">            p = p.next;</div><div class="line">            tmp.next = head;</div><div class="line">            head = tmp;</div><div class="line">        &#125;</div><div class="line">        return head;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image"
              src="/images/avatar.gif"
              alt="cdx" />
          
            <p class="site-author-name" itemprop="name">cdx</p>
            <p class="site-description motion-element" itemprop="description">Be a better man!</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">58</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cdx0312" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>GitHub</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:cdxu0312@outlook.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cdx</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
